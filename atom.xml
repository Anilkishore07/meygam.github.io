<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[The Story of Experiments with Technology]]></title>
  <link href="http://blog.meygam.com//atom.xml" rel="self"/>
  <link href="http://blog.meygam.com//"/>
  <updated>2014-11-15T19:06:17-06:00</updated>
  <id>http://blog.meygam.com//</id>
  <author>
    <name><![CDATA[Meygam Inc]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Provisioning an Apache Server With Dockers and Vagrant]]></title>
    <link href="http://blog.meygam.com//blog/2014/09/11/provisioning-an-apache-server-with-dockers-and-vagrant/"/>
    <updated>2014-09-11T00:00:00-05:00</updated>
    <id>http://blog.meygam.com//blog/2014/09/11/provisioning-an-apache-server-with-dockers-and-vagrant</id>
    <content type="html"><![CDATA[<p>At the end of this blog we will provision a server with vagrant and run apache in a docker container.</p>

<!-- more -->


<p>To understand dockers, visit <a href="https://docs.docker.com/">https://docs.docker.com/</a></p>

<p>You can download the docker file &amp; vagrant file used in this blog from <a href="https://github.com/meygam/docker-apache-ubuntu.git">https://github.com/meygam/docker-apache-ubuntu.git</a></p>

<h3>Docker File</h3>

<p>To run a docker container, we need an docker image. You could either pull a publicly available images from <a href="https://registry.hub.docker.com/">https://registry.hub.docker.com/</a> or build your own. In our case we will build our own docker image from a ubuntu base image.</p>

<p>Docker file to have apache installed in it looks like below. Will take a look what each line does.</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="lineno">1</span> <span class="no">FROM</span>    <span class="ss">ubuntu</span><span class="p">:</span><span class="mi">14</span><span class="o">.</span><span class="mo">04</span>
<span class="lineno">2</span>   <span class="no">MAINTAINER</span> <span class="no">Saravana</span> <span class="no">Kumar</span> <span class="no">Periyasamy</span> <span class="o">&lt;</span><span class="n">saravanakumar</span><span class="o">.</span><span class="n">periyasamy</span><span class="vi">@gmail</span><span class="o">.</span><span class="n">com</span><span class="o">&gt;</span>
<span class="lineno">3</span> 
<span class="lineno">4</span>   <span class="no">RUN</span>     <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>
<span class="lineno">5</span>   <span class="no">RUN</span>     <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">apache2</span>
<span class="lineno">6</span>   <span class="no">CMD</span>     <span class="n">service</span> <span class="n">apache2</span> <span class="n">start</span> <span class="o">&amp;&amp;</span> <span class="n">tail</span> <span class="o">-</span><span class="n">f</span>   <span class="sr">/var/</span><span class="n">log</span><span class="o">/</span><span class="n">apache2</span><span class="o">/</span><span class="n">error</span><span class="o">.</span><span class="n">log</span></code></pre></div>


<p>Line#1: takes the base image ubuntu, tag 14.04.
Line#2: is the maintainers meta data for this new docker image.
Line#&frac34;: Runs apt-get update and installs apache2.
Line#5: Starts Apache and tails the apache logs. This will be the default command that will run when a new container is created from this docker image. Tailing the log helps to have a foreground process, and it is required if this container has to be run in background.</p>

<h3>Vagrant File</h3>

<p>To build docker image from this file we need a computer with docker installed. To make life easier, we will use Vagrant to build and run this container. If you are new to vagrant, go to this link get started - <a href="http://docs.vagrantup.com/v2/getting-started/index.html">http://docs.vagrantup.com/v2/getting-started/index.html</a></p>

<p>Here is the vagrant file to build an image from docker file, run the docker and forward the port 80 from vm to host on port 18080.</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="lineno"> 1</span> <span class="no">VAGRANTFILE_API_VERSION</span> <span class="o">=</span> <span class="s2">&quot;2&quot;</span>
<span class="lineno"> 2</span> 
<span class="lineno"> 3</span>  <span class="no">Vagrant</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="no">VAGRANTFILE_API_VERSION</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
<span class="lineno"> 4</span>      <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">box</span> <span class="o">=</span> <span class="s2">&quot;hashicorp/precise64&quot;</span>
<span class="lineno"> 5</span> 
<span class="lineno"> 6</span>      <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="s2">&quot;forwarded_port&quot;</span><span class="p">,</span> <span class="ss">guest</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span> <span class="ss">host</span><span class="p">:</span> <span class="mi">18080</span>
<span class="lineno"> 7</span> 
<span class="lineno"> 8</span>      <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provision</span> <span class="s2">&quot;docker&quot;</span> <span class="k">do</span> <span class="o">|</span><span class="n">d</span><span class="o">|</span>
<span class="lineno"> 9</span>       <span class="n">d</span><span class="o">.</span><span class="n">build_image</span> <span class="s2">&quot;/vagrant&quot;</span><span class="p">,</span> <span class="ss">args</span><span class="p">:</span> <span class="s2">&quot;-t speriyasamy/apache2&quot;</span>
<span class="lineno">10</span>       <span class="n">d</span><span class="o">.</span><span class="n">run</span> <span class="s2">&quot;apache2&quot;</span><span class="p">,</span> <span class="ss">image</span><span class="p">:</span> <span class="s2">&quot;speriyasamy/apache2&quot;</span><span class="p">,</span> <span class="ss">args</span><span class="p">:</span> <span class="s2">&quot;-p 80:80&quot;</span>
<span class="lineno">11</span>      <span class="k">end</span>
<span class="lineno">12</span>  <span class="k">end</span></code></pre></div>


<p>Use <code>vagarnt up</code> to bring the vm up. It should install docker, build the docker image and use the same image to run the container.</p>

<p>You can verify this by ssh into the vagrant box, <code>vagarnt ssh</code>, and list the docker container using <code>docker ps</code> and you should see a apache container running.</p>

<p><img src="http://blog.meygam.com//assets/2014/sep/docker.png" alt="Docker Screenshot" /></p>

<p>Now you can access the apache from your host machine using <a href="http://localhost:18080">http://localhost:18080</a></p>

<p><img src="http://blog.meygam.com//assets/2014/sep/apache.png" alt="Apache Screenshot" /></p>

<h3>Manual Steps</h3>

<p>If you prefer not to use Vagrant, install the docker on your host machine and run the below command manually.</p>

<pre><code>docker build &lt;&lt;Dockerfile_Folder&gt;&gt; -t "speriyasamy/apache2"
</code></pre>

<p>And to run a contianer manually from this image, use the below command</p>

<pre><code>docker run -d speriyasamy/apache2
</code></pre>

<h3>Commonly used docker commands</h3>

<pre><code>#list images available on your host machine 
docker images

#list all the docker containers including inactive ones
docker ps -a

#pull a docker image from docker hub
docker pull speriyasamy/docker-openfire-centos

#stop container
docker stop &lt;&lt;cotainer id&gt;&gt;

#start container
docker start &lt;&lt;cotainer id&gt;&gt;

#remove container
docker rm &lt;&lt;cotainer id&gt;&gt;

#remove docker images
docker rmi &lt;&lt;cotainer id&gt;&gt;
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Connecting to Open VPN Server From iOS Device]]></title>
    <link href="http://blog.meygam.com//blog/2014/03/13/connecting-to-open-vpn-server-from-ios-device/"/>
    <updated>2014-03-13T00:00:00-05:00</updated>
    <id>http://blog.meygam.com//blog/2014/03/13/connecting-to-open-vpn-server-from-ios-device</id>
    <content type="html"><![CDATA[<p>To connect iOS device to Open VPN server we need</p>

<ul>
<li>Open VPN app</li>
<li>Open VPN setting file (client.ovpn)</li>
<li>Client Certificate</li>
<li>CA Certificate (if its self signed)</li>
</ul>


<!-- more -->


<h3>Install Open VPN app</h3>

<p>Install Open VPN client from app store (<a href="https://itunes.apple.com/app/openvpn-connect/id590379981">https://itunes.apple.com/app/openvpn-connect/id590379981</a>)</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/20140313_174551000_iOS.jpg" alt="" /></p>

<h3>Import Open VPN settings</h3>

<p>Get the Open VPN settings file, clinet.ovpn, from your VPN admin. Send that file to your iOS device through email, and open it in Open VPN app on the iOS device.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/20140313_175334000_iOS.jpg" alt="" /></p>

<p>Click on the green plus sign to import the profile to iOS device.</p>

<p>{<3>}<img src="http://blog.meygam.com//assets/images/2014/Mar/20140313_180407000_iOS.jpg" alt="" /></p>

<p>Once imported it should like below</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/20140313_180416000_iOS.jpg" alt="" /></p>

<h3>Install Client Certificate</h3>

<p>Get the client certificate in .p12 format from your Open VPN admin. Send that also to your iOS device through email, and install it.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/20140313_180433000_iOS-1.jpg" alt="" /></p>

<pre><code>Note: You need your Client certificate with password protected. iOS doesn't allow to import certificate with blank password.
</code></pre>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/20140313_180452000_iOS.jpg" alt="" /></p>

<p>You should see a successfully installed message</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/20140313_180504000_iOS.jpg" alt="" /></p>

<p>If it say &ldquo;Not Trusted&rdquo; as shown in my certificate above, then you will have to install the CA certificate. Else, when you try to connect Open VPN you will get the below error</p>

<pre><code>2014-03-13 10:59:29 EVENT: CORE_ERROR PolarSSL: ca certificate is undefined [ERR]
</code></pre>

<h3>Install CA Certificate</h3>

<p>Get the CA certificate from VPN admin. it should be in the form of .pem file. Send that to your iOS device through email, and install it.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/20140313_180531000_iOS.jpg" alt="" /></p>

<p>Install the root CA certificate.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/20140313_180534000_iOS.jpg" alt="" /></p>

<p>Once installed you should see that Certificate Authority is &ldquo;Trusted&rdquo;</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/20140313_180547000_iOS.jpg" alt="" /></p>

<h3>Connect to Open VPN server</h3>

<p>Open &ldquo;Open VPN&rdquo; app in your iOS device, select the <code>None Selected</code> list and select your certificate.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/20140313_180601000_iOS.jpg" alt="" /></p>

<p>Now turn on the VPN button and you should get connected to Open VPN server successfully.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/20140313_180641000_iOS.jpg" alt="" /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Automating the Continuous Integration of Android Projects With Gradle Using Jenkins on Windows]]></title>
    <link href="http://blog.meygam.com//blog/2014/03/01/jenkins-android/"/>
    <updated>2014-03-01T08:21:00-06:00</updated>
    <id>http://blog.meygam.com//blog/2014/03/01/jenkins-android</id>
    <content type="html"><![CDATA[<p>This post will show how to automate the deployment process of a Android Application using Jenkins Continuous Integration - to build the project, run the unit tests (if any), archive the built artifacts and run the Android lint reports.</p>

<!-- more -->


<h2>1. Install Jenkins as a Windows Service</h2>

<p>Navigate to jenkins-ci.org website using an Internet browser and download the Windows native package (the link is underlined for easy identification) as shown from the right side pane of the Download Jenkins tab.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-installation.png" title="Jenkins Installation Package" alt="Jenkins Installation package" /></p>

<p>Once the download is complete, uncompress the zip file and click on the jenkins-1.xxx.msi file. Proceed through the configuration steps to install the Jenkins as a Windows service.</p>

<h2>2. Modify Default Jenkins Port</h2>

<p>By default Jenkins runs on the port 8080. In order to avoid conflict with other applications, the default port can be modified by editing the jenkins.xml found under C:\Program Files (x86)\Jenkins location. As shown below, modify the httpPort to 8082.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;service&gt;
</span><span class='line'>  &lt;id&gt;jenkins&lt;/id&gt;
</span><span class='line'>  &lt;name&gt;Jenkins&lt;/name&gt;
</span><span class='line'>  &lt;description&gt;This service runs Jenkins continuous integration system.&lt;/description&gt;
</span><span class='line'>  &lt;env name="JENKINS_HOME" value="%BASE%"/&gt;
</span><span class='line'>  &lt;!--
</span><span class='line'>    if you'd like to run Jenkins with a specific version of Java, specify a full path to java.exe.
</span><span class='line'>    The following value assumes that you have java in your PATH.
</span><span class='line'>  --&gt;
</span><span class='line'>  &lt;executable&gt;%BASE%\jre\bin\java&lt;/executable&gt;
</span><span class='line'>  &lt;arguments&gt;-Xrs -Xmx256m -Dhudson.lifecycle=hudson.lifecycle.WindowsServiceLifecycle -jar "%BASE%\jenkins.war" --httpPort=8082&lt;/arguments&gt;
</span><span class='line'>  &lt;!--
</span><span class='line'>    interactive flag causes the empty black Java window to be displayed.
</span><span class='line'>    I'm still debugging this.
</span><span class='line'>  &lt;interactive /&gt;
</span><span class='line'>  --&gt;
</span><span class='line'>  &lt;logmode&gt;rotate&lt;/logmode&gt;
</span><span class='line'>
</span><span class='line'>  &lt;onfailure action="restart" /&gt;
</span><span class='line'>&lt;/service&gt;</span></code></pre></td></tr></table></div></figure>


<p>Once the modification is saved in jenkins.xml file, restart the Jenkins service from the Windows Task Manager->Services and right clicking on the Jenkins service and choose Stop Service to stop the service as shown below.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-stop.png" title="Jenkins Stop Service" alt="Jenkins Stop Service" /></p>

<p>Once the status of the service changes to stopped, restart the service by right clicking on the Jenkins service and choose Start Service to start the service again.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-restart.png" title="Jenkins Restart Service" alt="Jenkins Restart Service" /></p>

<p>Navigate to localhost:8082 to verify if the Jenkins restart was successful as shown below - Jenkins Dashboard will be displayed. Note that it takes a while before the Jenkins service becomes available.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-dashboard.png" title="Jenkins Dashboard" alt="Jenkins Dashboard" /></p>

<h2>3. Install Plugins</h2>

<p>On the Jenkins Dashboard, navigate to Manage Jenkins -> Manage Plugins as shown in the snapshot below.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-manageplugins.png" title="Jenkins Manage Plugins" alt="Jenkins Manage Plugins" /></p>

<p>Install the following plugins and restart Jenkins for the changes to take effect.</p>

<ul>
<li>Git Plugin (for integrating Git with Jenkins)</li>
<li>Gradle Plugin (for integrating Gradle with Jenkins)</li>
<li>Android Lint Plugin (for integration Lint with Jenkins)</li>
</ul>


<h2>4. Configure System</h2>

<p>On the Jenkins Dashboard, navigate to Manage Jenkins -> Configure System as shown in the snapshot below.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-configuresystem.png" title="Jenkins Configure System" alt="Jenkins Configure System" /></p>

<p>Navigate to the Global Properties section and click on Add to add an Environment Variable ANDROID_HOME as shown in the snapshot below. Enter the name as ANDROID_HOME and enter the path of the location where the Android SDK is stored on windows.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/androidhome.png" title="Jenkins Android Home Configuration" alt="Jenkins Android Home Configuration" /></p>

<p>Navigate to the JDK section and click on &ldquo;Add JDK&rdquo; to add the JDK installation as shown in the snapshot below. Specify a JDK Name, choose the JDK Version to install and follow the on-screen instructions to save the Oracle Login credentials. Save the changes.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-java.png" title="Jenkins Java Installation" alt="Jenkins Java Installation" /></p>

<p>Next, proceed to the Git section and click on &ldquo;Add Git&rdquo; to add the Git installation as shown in the snapshot below. Specify Git Name, specify the path to Git executable and Save the changes.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-gitinstall.png" title="Jenkins Git Installation" alt="Jenkins Git Installation" /></p>

<p>Next, proceed to the Gradle section and click on &ldquo;Add Gradle&rdquo; to add the Gradle installation as shown in the snapshot below. Specify Gradle Name, choose the appropriate version (at the time of writing, I used Gradle 1.10) and Save the changes.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/gradleinstall.png" title="Jenkins Gradle Installation" alt="Jenkins Gradle Installation" /></p>

<p>Next, proceed to the Email Notification section and enter the SMTP Server details as shown below. Click on the Advanced button to add the further details required and Save the changes. Click on &ldquo;Test configuration by sending test e-mail&rdquo;, enter the test e-mail recipient and click on &ldquo;Test configuration&rdquo; to see if the email is successfully sent.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-email.png" title="Jenkins Email Notification" alt="Jenkins Email Notification" /></p>

<h2>5. Create a New Jenkins Job</h2>

<p>From the Jenkins Dashboard, click on &ldquo;New Job&rdquo; to create a new job. Enter a name for the job and choose &ldquo;Build a free-style software project&rdquo; as option and click on OK as shown below.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/android-newjob.png" title="Jenkins Android New Job" alt="Jenkins Android New Job" /></p>

<p>From the New Job Configuration screen, proceed to the Source Code Management section. Save the Git credentials by clicking on &ldquo;Add&rdquo; as shown below and entering the details in the following dialog. Save the changes by clicking on &ldquo;Add&rdquo; as shown below.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/android-add-credentials.png" title="Jenkins Android Add Credentials" alt="Jenkins Android Add Credentials" /></p>

<p>Specify the Git Repository URL for the project, choose the saved credentials from the drop-down list as shown in the snapshot below. Save the changes.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/android-sourcecodemgmt.png" title="Jenkins Source Code Management" alt="Jenkins Source Code Management" /></p>

<p>Next, from the Build Triggers section, select the options desired as shown below and Save the changes.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/android-build-triggers.png" title="Android Build Triggers" alt="Android Build Triggers" /></p>

<p>Proceed to the Build section, choose &ldquo;Invoke Gradle script&rdquo; from the drop-down list of choices for &ldquo;Add build step&rdquo;. Choose the appropriate Gradle version which is configured, enter the tasks to be built and select the options as desired. Save the changes.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/android-build.png" title="Android Build" alt="Android Build" /></p>

<p>Proceed to the Post-build Actions section, click on &ldquo;Publish Android Lint results&rdquo; from the drop-down list of choices for &ldquo;Add post-build action&rdquo; and specify the location where the Lint results should be stored in the Jenkins workspace for the job.</p>

<p>Similarly, click on &ldquo;Archive the artifacts&rdquo; from the drop-down list of choices for &ldquo;Add post-build action&rdquo; and the specify the format of APK files to be archived after every build. Additionally, options from Advanced section such as &ldquo;Discard all but the last successful/stable artifact to save disk space&rdquo; could be enabled for saving disk space.</p>

<p>Click on &ldquo;E-mail Notification&rdquo; from the drop-down list of choices for &ldquo;Add post-build action&rdquo; and enter the values for the email recipients as shown below. Save the changes.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/android-post-build.png" title="Android Post Build" alt="Android Post Build" /></p>

<h2>6. Build Now</h2>

<p>Once the above configuration steps are complete, click on &ldquo;Build Now&rdquo; under the Jenkins -> Build Android Application (or the respective Job name) to build the project based on the configuration.</p>

<p>The console output has the detailed logs of what steps were initiated by the configuration and the outcome of the entire build. Clicking on any successful build outcome shows the artifacts that were archived as part of the build, the change that started the build and the lint results as shown below.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/android-build-outcome.png" title="Android Build Outcome" alt="Android Build Outcome" /></p>

<p>Thus the entire process of building the project an Android application project whenever a SCM change is triggered or under another condition, running lint reports, archiving the artifacts built, publishing lint reports and triggering emails to the recipients can be automated with a click of a button through Jenkins.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Automating the Release of Java Artifacts Using Jenkins on Windows]]></title>
    <link href="http://blog.meygam.com//blog/2014/02/05/jenkins-release-upload/"/>
    <updated>2014-02-05T08:21:00-06:00</updated>
    <id>http://blog.meygam.com//blog/2014/02/05/jenkins-release-upload</id>
    <content type="html"><![CDATA[<p>This post will show how to automate the release process of a Java Web Application (Student Enrollment Application developed using MYSQL DB with Hibernate ORM in a REST based Jersey2 Spring environment) using Jenkins Continuous Integration - upload the release artifacts to release repository. The job configured using this post must be run only after uploading the snapshot artifacts into the snapshot repository as explained in the earlier post <a href="http://meygam.github.io/blog/2014/01/13/jenkins-snapshot-upload/">Automating the Deployment and Upload of Snapshot Java Artifacts using Jenkins on Windows</a>. The details of the actual application are explained in the earlier post given by the link <a href="http://meygam.github.io/blog/2013/12/13/student-enrollment-using-jersey-rest-with-spring/">Building Java Web Application Using Jersey REST With Spring</a>.</p>

<!-- more -->


<h2>1. Generate SSH Keys for Github (without passphrase)</h2>

<p>Jenkins does not support passphrases for SSH Keys and so generate the SSH Key for Gihub account without passphrase. Follow the directions given under <a href="https://help.github.com/articles/generating-ssh-keys">Generating SSH Keys</a>, generate a SSH Key without passphrase and upload to Github account.</p>

<h2>2. Force Jenkins to run as user with SSH Key</h2>

<p>On Windows, Jenkins uses the SSH Key of the user it is running as, which is located under C:\Users\<username>.ssh. Hence, Jenkins must be run as the user with &lsquo;username&rsquo;.</p>

<p>Type &lsquo;services.msc&rsquo; in a command prompt to open up Services Management. Right click on the Jenkins service and select Properties.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-services-properties.png" title="Jenkins Services Management" alt="Jenkins Services Management" /></p>

<p>From the Jenkins Properties windows, navigate to Log on tab. Choose Log on as &lsquo;This account&rsquo;, enter the details of the account (use the Browse option to choose/check the name of the account) and click Ok. The account credentials will generally match the log in account for the Windows as shown in the snapshot below</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-logon.png" title="Jenkins Logon" alt="Jenkins Logon" /></p>

<p>Once the changes are saved, restart the Jenkins service from the Services Management by Right clicking on Jenkins service and choose Restart as shown below</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-services-restart.png" title="Jenkins Restart" alt="Jenkins Restart" /></p>

<h2>3. Install Plugins</h2>

<p>On the Jenkins Dashboard, navigate to Manage Jenkins -> Manage Plugins as shown in the snapshot below.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-manageplugins.png" title="Jenkins Manage Plugins" alt="Jenkins Manage Plugins" /></p>

<p>Install the following plugins and restart Jenkins for the changes to take effect.</p>

<ul>
<li>Jenkins Release Plugin (for Maven release)</li>
</ul>


<h2>4. Configure System</h2>

<p>On the Jenkins Dashboard, navigate to Manage Jenkins -> Configure System as shown in the snapshot below.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-configuresystem.png" title="Jenkins Configure System" alt="Jenkins Configure System" /></p>

<p>Proceed to the Maven Release Plug-in section. Enable Nexus-Pro support, enter the Nexus URL, Nexus User Credentials and Save the changes.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-nexus-pro.png" title="Jenkins Nexus-Pro" alt="Jenkins Nexus-Pro" /></p>

<h2>5. Create a New Jenkins Job</h2>

<p>From the Jenkins Dashboard, click on &ldquo;New Job&rdquo; to create a new job. Enter a name for the job and choose &ldquo;Build a maven2/3 project&rdquo; as option and click on OK as shown below.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-newjob.png" title="Jenkins New Job" alt="Jenkins New Job" /></p>

<p>From the New Job Configuration screen, proceed to the Source Code Management section and specify the Git Repository URL for the project as shown below. From the additional behaviors section, click on &ldquo;Add&rdquo; and select Check out to specific local branch. Enter the branch name as master and Save the changes.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-sourcecodemgmt-release.png" title="Jenkins Source Code Management for Release" alt="Jenkins Source Code Management for Release" /></p>

<p>Proceed to the Build Environment section, enable Maven Release Build option and enter the release goals.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-maven-releasebuild.png" title="Jenkins Maven Release Build" alt="Jenkins Maven Release Build" /></p>

<p>Proceed to the Build section, enter the maven goals for building a snapshot as shown below and Save the changes.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-build.png" title="Jenkins Build" alt="Jenkins Build" /></p>

<p>Proceed to the Build Settings section. Select the option for Email Notification and enter the values for the email recipients as shown below. Save the changes.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-emailnotifications.png" title="Jenkins Email Notifications" alt="Jenkins Email Notifications" /></p>

<h2>6. Configure settings.xml</h2>

<p>In order to upload the built Maven artifacts to the artifactory server, configure the Jenkins settings.xml found in C:\Program Files (x86)\Jenkins\tools\hudson.tasks.Maven_MavenInstallation\Maven_3.1\conf folder with the same parameters as found in the default settings.xml (usually found under C:\Program Files\Apache Software Foundation\apache-maven-3.1.0\conf for a Windows machine) of the Maven installation on the system.</p>

<p>Typically, the server section for staging repository needs to be configured with httpHeaders in the settings.xml for the Maven Release.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;servers&gt;
</span><span class='line'>    &lt;server&gt;
</span><span class='line'>      &lt;id&gt;sonatype-nexus-staging&lt;/id&gt;
</span><span class='line'>      &lt;username&gt;username&lt;/username&gt;
</span><span class='line'>      &lt;password&gt;password&lt;/password&gt;
</span><span class='line'>    &lt;configuration&gt;
</span><span class='line'>      &lt;httpHeaders&gt;
</span><span class='line'>        &lt;property&gt;
</span><span class='line'>          &lt;name&gt;User-Agent&lt;/name&gt;
</span><span class='line'>          &lt;value&gt;Maven m2Release (java:${java.vm.version} ${env.BUILD_TAG }&lt;/value&gt;
</span><span class='line'>        &lt;/property&gt;
</span><span class='line'>      &lt;/httpHeaders&gt;
</span><span class='line'>      &lt;/configuration&gt;
</span><span class='line'>    &lt;/server&gt;
</span><span class='line'>&lt;/servers&gt;</span></code></pre></td></tr></table></div></figure>


<p>Also, a profile section needs to be configured for the PGP Signature, the details of how to Generate PGP Signatures with Maven can be found from the section Generate a Key Pair at <a href="https://docs.sonatype.org/display/Repository/How+To+Generate+PGP+Signatures+With+Maven">How to Generate PGP Signatures With Maven</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;profiles&gt;
</span><span class='line'>    &lt;profile&gt;
</span><span class='line'>      &lt;id&gt;gpg-release&lt;/id&gt;
</span><span class='line'>      &lt;properties&gt;
</span><span class='line'>          &lt;gpg.passphrase&gt;passphrase&lt;/gpg.passphrase&gt;
</span><span class='line'>          &lt;gpg.useagent&gt;true&lt;/gpg.useagent&gt;
</span><span class='line'>          &lt;gpg.defaultKeyring&gt;false&lt;/gpg.defaultKeyring&gt;
</span><span class='line'>          &lt;gpg.homedir&gt;C:/Users/Sara/AppData/Roaming/gnupg&lt;/gpg.homedir&gt;
</span><span class='line'>          &lt;gpg.publicKeyring&gt;C:/Users/Sara/AppData/Roaming/gnupg/pubring.gpg&lt;/gpg.publicKeyring&gt;
</span><span class='line'>          &lt;gpg.secretKeyring&gt;C:/Users/Sara/AppData/Roaming/gnupg/secring.gpg&lt;/gpg.secretKeyring&gt;
</span><span class='line'>      &lt;/properties&gt; 
</span><span class='line'>    &lt;/profile&gt;
</span><span class='line'>&lt;/profiles&gt;</span></code></pre></td></tr></table></div></figure>


<h2>6. Update pom.xml</h2>

<p>The pom.xml file for the project needs to be configured with the following plugins under the build section.</p>

<ul>
<li>maven-enforcer-plugin</li>
<li>maven-release-plugin</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;build&gt;
</span><span class='line'>    &lt;plugins&gt;
</span><span class='line'>      &lt;plugin&gt;
</span><span class='line'>          &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
</span><span class='line'>          &lt;artifactId&gt;maven-enforcer-plugin&lt;/artifactId&gt;
</span><span class='line'>          &lt;version&gt;1.2&lt;/version&gt;
</span><span class='line'>          &lt;executions&gt;
</span><span class='line'>              &lt;execution&gt;
</span><span class='line'>                  &lt;id&gt;enforce-maven&lt;/id&gt;
</span><span class='line'>                  &lt;goals&gt;
</span><span class='line'>                      &lt;goal&gt;enforce&lt;/goal&gt;
</span><span class='line'>                  &lt;/goals&gt;
</span><span class='line'>                  &lt;configuration&gt;
</span><span class='line'>                      &lt;rules&gt;
</span><span class='line'>                          &lt;requireMavenVersion&gt;
</span><span class='line'>                              &lt;version&gt;(,2.1.0),(2.1.0,2.2.0),(2.2.0,)&lt;/version&gt;
</span><span class='line'>                              &lt;message&gt;Maven 2.1.0 and 2.2.0 produce incorrect GPG signatures
</span><span class='line'>                                  and checksums respectively.&lt;/message&gt;
</span><span class='line'>                          &lt;/requireMavenVersion&gt;
</span><span class='line'>                      &lt;/rules&gt;
</span><span class='line'>                  &lt;/configuration&gt;
</span><span class='line'>              &lt;/execution&gt;
</span><span class='line'>          &lt;/executions&gt;
</span><span class='line'>      &lt;/plugin&gt;
</span><span class='line'>  &lt;/plugins&gt;
</span><span class='line'>
</span><span class='line'>  &lt;pluginManagement&gt;
</span><span class='line'>      &lt;plugins&gt;
</span><span class='line'>          &lt;plugin&gt;
</span><span class='line'>              &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
</span><span class='line'>              &lt;artifactId&gt;maven-release-plugin&lt;/artifactId&gt;
</span><span class='line'>              &lt;version&gt;2.4.2&lt;/version&gt;
</span><span class='line'>              &lt;configuration&gt;
</span><span class='line'>                  &lt;tagBase&gt;https://github.com/elizabetht/StudentEnrollmentWithREST/tags&lt;/tagBase&gt;
</span><span class='line'>                  &lt;mavenExecutorId&gt;forked-path&lt;/mavenExecutorId&gt;
</span><span class='line'>                  &lt;useReleaseProfile&gt;false&lt;/useReleaseProfile&gt;
</span><span class='line'>                  &lt;arguments&gt;-Psonatype-oss-release&lt;/arguments&gt;
</span><span class='line'>              &lt;/configuration&gt;
</span><span class='line'>          &lt;/plugin&gt;
</span><span class='line'>      &lt;/plugins&gt;
</span><span class='line'>  &lt;/pluginManagement&gt;
</span><span class='line'>&lt;/build&gt;</span></code></pre></td></tr></table></div></figure>


<p>Update the pom.xml with a profile section for the maven-gpg-plugin</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;profiles&gt;
</span><span class='line'>  &lt;profile&gt;
</span><span class='line'>      &lt;id&gt;sign&lt;/id&gt;
</span><span class='line'>      &lt;build&gt;
</span><span class='line'>          &lt;plugins&gt;
</span><span class='line'>              &lt;plugin&gt;
</span><span class='line'>                  &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
</span><span class='line'>                  &lt;artifactId&gt;maven-gpg-plugin&lt;/artifactId&gt;
</span><span class='line'>                  &lt;executions&gt;
</span><span class='line'>                      &lt;execution&gt;
</span><span class='line'>                          &lt;id&gt;sign-artifacts&lt;/id&gt;
</span><span class='line'>                          &lt;phase&gt;verify&lt;/phase&gt;
</span><span class='line'>                          &lt;goals&gt;
</span><span class='line'>                              &lt;goal&gt;sign&lt;/goal&gt;
</span><span class='line'>                          &lt;/goals&gt;
</span><span class='line'>                      &lt;/execution&gt;
</span><span class='line'>                  &lt;/executions&gt;
</span><span class='line'>              &lt;/plugin&gt;
</span><span class='line'>          &lt;/plugins&gt;
</span><span class='line'>      &lt;/build&gt;
</span><span class='line'>  &lt;/profile&gt;
</span><span class='line'>&lt;/profiles&gt;</span></code></pre></td></tr></table></div></figure>


<p>Add a distribution management section to pom.xml to specify the snapshot and staging repository URLs.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;distributionManagement&gt;
</span><span class='line'>  &lt;repository&gt;
</span><span class='line'>      &lt;id&gt;sonatype-nexus-staging&lt;/id&gt;
</span><span class='line'>      &lt;url&gt;https://oss.sonatype.org/service/local/staging/deploy/maven2&lt;/url&gt;
</span><span class='line'>  &lt;/repository&gt;
</span><span class='line'>  &lt;snapshotRepository&gt;
</span><span class='line'>      &lt;id&gt;sonatype-nexus-snapshots&lt;/id&gt;
</span><span class='line'>      &lt;url&gt;https://oss.sonatype.org/content/repositories/snapshots&lt;/url&gt;
</span><span class='line'>  &lt;/snapshotRepository&gt;
</span><span class='line'>&lt;/distributionManagement&gt;</span></code></pre></td></tr></table></div></figure>


<h2>8. Build Now</h2>

<p>Once the above configuration steps are complete, click on &ldquo;Build Now&rdquo; under the Jenkins -> Upload REST Release Artifacts (or the respective Job name) to build the project based on the configuration.</p>

<p>The console output has the detailed logs of what steps were initiated by the configuration and the outcome of the entire build. Verify that the build succeeds.</p>

<h2>9. Perform Maven Release</h2>

<p>Once the build succeeds and snapshots are uploaded to the snapshot repository, click on &ldquo;Perform Maven Release&rdquo; under Jenkins -> Upload REST Release Artifacts (or the respective Job name) to start the Maven Release process.</p>

<p>Verify that the Release version and the next Development Version are correct. Enable &lsquo;Specify custom SCM comment prefix&rsquo; to enter a custom SCM Comment. Enable &lsquo;Specify custom SCM tag&rsquo; to enter a custom SCM tag. Click on Schedule Maven Release Build.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-perform-maven-release.png" title="Jenkins Perform Maven Release" alt="Jenkins Perform Maven Release" /></p>

<p>Once the release process succeeds, the staging repository will be uploaded with the release artifacts.</p>

<p>Thus the entire process of performing the maven release of artifacts to the staging repository and triggering emails to the recipients can be automated with a click of a button through Jenkins. The staging repository can be taken then through the steps of Close (if its still open) and Release to complete the promotion of the artifacts.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[WordPress on AWS]]></title>
    <link href="http://blog.meygam.com//blog/2014/01/17/wordpress-on-aws/"/>
    <updated>2014-01-17T00:00:00-06:00</updated>
    <id>http://blog.meygam.com//blog/2014/01/17/wordpress-on-aws</id>
    <content type="html"><![CDATA[<p>In this blog I am going to cover the step by step instructions to host your own WordPress blog in AWS. Hosting your own blog has some advantages, you can install any plugins/themes you want and publish any content you like. Having said that it’s not for everyone. If you are a basic user better you create account in wordpress.com. I wanted to run my own blog engine, primarily because I am a techie.</p>

<!-- more -->


<h3>Architecture for WordPress on AWS</h3>

<p>At a minimum WordPress needs a web server, to serve your blog and a database instance, to store your blog contents. You can install both web server and the database instance in just one server. But for high availability and better backup mechanism I choose to keep the web server and database instance separate. Below is the architecture that we are going to follow. I will talk about each components in following sections.</p>

<iframe src="http://www.slideshare.net/slideshow/embed_code/30109797" width="427" height="356" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px 1px 0; margin-bottom:5px; max-width: 100%;" allowfullscreen> </iframe>




<table>
<tr>
    <th>Service</th>
    <th>Unit Rate</th>
    <th>Quantity (Per Year)</th>
    <th width="80px">Cost per Year</th>
</tr>
<tr>
  <td>EC2 – Linux (t1.micro)</td>
  <td>$0.02 per hour</td>
  <td>365 days * 24 hours = 8760 hours</td>
  <td>$175.20</td>
</tr>
<tr>
  <td>EC2 – Data Transfer OUT From Amazon EC2 To Amazon Elastic Load Balancing</td>
  <td>$0.01 per GB</td>
  <td>1 GB per month * 12 month = 12 GB</td>
  <td>$0.12</td>
</tr>
<tr>
  <td>EC2 – Data Transfer IN To Amazon EC2 From Amazon RDS  Using a private IP address    </td>
  <td>$0.00 per GB</td> 
  <td>1 GB per month * 12 month = 12 GB</td>
  <td>$0.00</td>
</tr>
<tr>
  <td>EBS - Standard volumes</td>
  <td>$0.10 per GB-month</td>
  <td>8 GB * 12 month
= 96 GB-month</td>
  <td>$9.60</td>
</tr>
<tr>
  <td>EBS - Standard volumes</td>
  <td>$0.10 per 1 million I/O requests</td>
  <td>1 million request per month * 12 month</td>
  <td>$1.20</td>
</tr>
<tr>
  <td>RDS – MySQL -
Standard Deployment (db.t1.micro)</td>
  <td>$0.025 per hour</td>
  <td>365 days * 24 hours
= 8760 hours</td>
  <td>$219.00</td>
</tr>
<tr>
  <td>RDS – MySQL - Standard Deployment Database Storage</td>
  <td>$0.125 per GB-month</td>
  <td>20 GB * 12 month
= 240 GB-month</td>
  <td>$30.00</td>
</tr>
<tr>
  <td>ELB</td>
  <td>$0.025 per hour</td>
  <td>365 days * 24 hours
= 8760 hours</td>
  <td>$219.00</td>
</tr>
<tr>
  <td>ELB – Data Transfer</td>
  <td>$0.008 per GB of data processed by ELB</td>
  <td>1 GB per month * 12 month = 12 GB</td>
  <td>$0.10
</td>
</tr>
<tr>
<td>Route 53 - Hosted Zones</td>
<td>$0.50 per hosted zone / month for the first 25 hosted zones
$0.10 per hosted zone / month for additional hosted zones</td>
<td>1 hosted zone * 12 month = 12 hosted zone month</td>
<td>$6.00</td>
</tr>
<tr>
<td>Route 53 -
Standard Queries</td>
<td>$0.500 per million queries – first 1 Billion queries / month
$0.250 per million queries – over 1 Billion queries / month</td>
<td>under 1 million queries per month
* 12 month = 12 million quries</td>
<td>$6.00</td>
</tr>
<tr>
<td></td>
<td></td>
<td><strong>Total Cost Per Year (approx.)</strong></td>
<td align="right"><strong>$666.22</strong></td>
</tr>
<tr>
<td><strong> </strong></td>
<td><strong> </strong></td>
<td><strong>Total Cost Per Month <strong>(approx.)</strong></strong></td>
<td><strong>$55.52</strong></td>
</tr>
</table>


<p>My blog do not get lot of visits for now, so I went with less powerful machines and DB, to save cost. I can scale my blog when required, that’s the advantage of AWS. The current architecture allows scaling. I will cover more about scaling in next part.</p>

<h3>Setup infrastructure in AWS</h3>

<ul>
<li>Create a VPC with the CIDR 10.0.0.0/16.
<img src="http://farm4.staticflickr.com/3831/11989981795_b8780b74a8_b_d.jpg" alt="" /></li>
<li>Create a private subnets under the new VPC. We need two subnets in different availability zones to setup RDS in a VPC.
<img src="http://farm6.staticflickr.com/5547/12023870814_0df096e40a_b_d.jpg" alt="" /></li>
<li>Create an internet gateway and attach it to the VPC.
<img src="http://farm4.staticflickr.com/3732/12023835684_beebf39e90_b_d.jpg" alt="" /></li>
<li>Add internet gateway to the route table and attach it to the subnet.
<img src="http://farm8.staticflickr.com/7452/12023771363_854f9efc68_b_d.jpg" alt="" /></li>
<li>Create a DB Subnet group with minimum two subnets each in different availability zones.
<img src="http://farm6.staticflickr.com/5472/12023771423_9b337e66b5_b_d.jpg" alt="" /></li>
<li>Create an MySQL RDS instance inside the VPC, so that only the instances in the same network can connect to it.
<img src="http://farm6.staticflickr.com/5535/12023836124_690f1f14d6_b_d.jpg" alt="" /></li>
<li>Create an Ubuntu EC2 instance inside the VPC without any public IP, and attach it to the elastic IP, so that I can ssh into the machine.
<img src="http://farm4.staticflickr.com/3720/12024318096_9fdcc9f651_b_d.jpg" alt="" /></li>
</ul>


<h3>Install php5</h3>

<p>Now that EC2 is up and running, ssh into the machine using the private key using the command</p>

<pre><code>ssh -i &lt;&lt;private-key.pem&gt;&gt; ubuntu@&lt;&lt;elastic ip&gt;&gt;
</code></pre>

<p>once you are in the machine, run</p>

<pre><code>sudo apt-get update
</code></pre>

<p>to update the package list. Then install the php5, php5 fpm and php5 mysql packages using the below command</p>

<pre><code>sudo apt-get install php5
sudo apt-get insatll php-fpm
sudo apt-get install php5-mysql
</code></pre>

<h3>Install WordPress</h3>

<p>Download and extract the WordPress using the below commands.</p>

<pre><code>mkdir -p /var/www/blog.meygam.com/htdocs/ /var/www/blog.meygam.com/logs/
cd /var/www/blog.meygam.com/htdocs/
wget http://wordpress.org/latest.tar.gz
tar –strip-components=1 -xvf latest.tar.gz
rm latest.tar.gz
chown -R www-data:www-data /var/www/blog.meygam.com/
</code></pre>

<h3>Install &amp; configure nginx</h3>

<p>By default Ubuntu comes with Apache2. I like to use nginx, as its more modern than Apache2. So first we need to uninstall the Apache2 &amp; all of its dependencies using the below command.</p>

<pre><code>sudo apt-get remove apache2*
</code></pre>

<p>Install nginx using the below command.</p>

<pre><code>sudo apt-get install nginx
</code></pre>

<p>Create the website configuration</p>

<pre><code>vi /etc/nginx/sites-available/blog.meygam.com
</code></pre>

<p>and add the below configuration in the file. Replace blog.meygam.com to your site name.</p>

<pre><code>server {

server_name blog.meygam.com;

access_log /var/log/nginx/blog.meygam.com.access.log;
error_log /var/log/nginx/blog.meygam.com.error.log;

root /var/www/blog.meygam.com/htdocs;
index index.php;

location / {

try_files $uri $uri/ /index.php?$args;

}

location ~ \.php$ {

try_files $uri =404;
include fastcgi_params;
fastcgi_pass unix:/var/run/php5-fpm.sock;

}

}
</code></pre>

<p>Restart the nginx to load the configuration</p>

<pre><code>sudo service nginx restart
</code></pre>

<h3>Configure Load Balancer</h3>

<p>Configure Elastic load balancer (ELB) attach the EC2 instance that we created to it. Using ELB will let you scale the application later point.</p>

<p><img src="http://farm4.staticflickr.com/3685/12024782696_02458889fc_b_d.jpg" alt="" /></p>

<p><img src="http://farm8.staticflickr.com/7349/12024303824_703f47f09a_b_d.jpg" alt="" /></p>

<p><img src="http://farm8.staticflickr.com/7438/12024782816_f152481a0c_b_d.jpg" alt="" /></p>

<p><img src="http://farm4.staticflickr.com/3686/12024236493_d63f2c8e01_b_d.jpg" alt="" /></p>

<h3>Configure Route 53</h3>

<p>Route 53 helps to map your domain name to the elastic load balancer. Create a hosted zone for your domain, and add the Route 53 name servers to your domain register.</p>

<p><img src="http://farm4.staticflickr.com/3806/12024318566_f502004ed4_b_d.jpg" alt="" /></p>

<p>Add a CNAME record to point to your ELB.
<img src="http://farm3.staticflickr.com/2823/12023772813_a2a59d99fa_b_d.jpg" alt="" /></p>

<h3>Configure WordPress</h3>

<p>Now access your website in the browser, and you should see the WordPress configuration page. Follow the instructions and point it to the database that we created.</p>

<p><img src="http://farm6.staticflickr.com/5511/12024553674_1d1230de93_b_d.jpg" alt="" /></p>

<p><img src="http://farm8.staticflickr.com/7415/12024196015_b966e2ee75_b_d.jpg" alt="" /></p>

<p><img src="http://farm4.staticflickr.com/3769/12024553914_8e8b023647_b_d.jpg" alt="" /></p>

<p><img src="http://farm6.staticflickr.com/5540/12025035976_f9738840b3_b_d.jpg" alt="" /></p>

<p><img src="http://farm6.staticflickr.com/5534/12024554344_e2b70a17af_b_d.jpg" alt="" /></p>

<p>And that’s it, your blog is fully up &amp; running on AWS now! Happy Blogging!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Installing Oracle Java 7 and Tomcat 7 on Ubuntu 13]]></title>
    <link href="http://blog.meygam.com//blog/2014/01/17/installing-oracle-java-7-and-tomcat-7-on-ubuntu-13/"/>
    <updated>2014-01-17T00:00:00-06:00</updated>
    <id>http://blog.meygam.com//blog/2014/01/17/installing-oracle-java-7-and-tomcat-7-on-ubuntu-13</id>
    <content type="html"><![CDATA[<p>Setting up a new Ubuntu server with Java 7 &amp; Tomcat 7 seems to be trivial, but often I had to do it at my workplace and everytime I had to google it to do this. So I thought I will list down the steps in my blog.</p>

<!-- more -->


<h3>Install Oracle Java 7</h3>

<p>Run the below commands to install Oracle Java 7 - steps followed from <a href="http://www.webupd8.org/2012/01/install-oracle-java-jdk-7-in-ubuntu-via.html" target="_blank">INSTALL ORACLE JAVA 7 IN UBUNTU VIA PPA REPOSITORY</a></p>

<pre><code>sudo add-apt-repository ppa:webupd8team/java
sudo apt-get update
sudo apt-get install oracle-java7-installer
</code></pre>

<p>Check if the right version of java is installed</p>

<pre><code>java -version

java version "1.7.0_45"
Java(TM) SE Runtime Environment (build 1.7.0_45-b06)
Java HotSpot(TM) 64-Bit Server VM (build 20.45-b01, mixed mode)
</code></pre>

<p>Run the below command to set the Java environment variables</p>

<pre><code>sudo apt-get install oracle-java7-set-default
</code></pre>

<h3>Install Unzip</h3>

<p>Run the below command to install unzip, we need this to unzip the tomcat binaries.</p>

<pre><code>sudo apt-get install unzip
</code></pre>

<h3>Install Tomcat 7</h3>

<p>Download the latest tomcat from tomcat website &amp; unzip it. And give execute access to all .sh files. Start the tomcat manually.</p>

<pre><code>cd /opt
sudo wget http://www.webhostingjams.com/mirror/apache/tomcat/tomcat-7/v7.0.52/bin/apache-tomcat-7.0.52.zip
sudo unzip apache-tomcat-7.0.52.zip
sudo chmod +x /opt/apache-tomcat-7.0.52/bin/*.sh
sudo /opt/apache-tomcat-7.0.52/bin/startup.sh
</code></pre>

<p>Check if the tomcat is running. The below command should return the tomcat default page.</p>

<pre><code>curl http://localhost:8080
</code></pre>

<p> Note: I don&rsquo;t use tomcat7 from ubuntu repository as it some times screws up my Oracle Java installation and installs Open JDK.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Automating the Deployment and Upload of Snapshot Java Artifacts Using Jenkins on Windows]]></title>
    <link href="http://blog.meygam.com//blog/2014/01/13/jenkins-snapshot-upload/"/>
    <updated>2014-01-13T16:50:30-06:00</updated>
    <id>http://blog.meygam.com//blog/2014/01/13/jenkins-snapshot-upload</id>
    <content type="html"><![CDATA[<p>This post will show how to automate the deployment process of a Java Web Application (Student Enrollment Application developed using MYSQL DB with Hibernate ORM in a REST based Jersey2 Spring environment) using Jenkins Continuous Integration - to build the project, run the unit tests, upload the built artifacts to a Sonatype Snapshot repository, run the Cobertura Code Coverage reports and deploy the application to the Amazon EC2. The details of the actual application are explained in the earlier post given by the link <a href="http://meygam.github.io/blog/2013/12/13/student-enrollment-using-jersey-rest-with-spring/">Building Java Web Application Using Jersey REST With Spring</a>.</p>

<!-- more -->


<h2>1. Install Jenkins as a Windows Service</h2>

<p>Navigate to jenkins-ci.org website using an Internet browser and download the Windows native package (the link is underlined for easy identification) as shown from the right side pane of the Download Jenkins tab.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-installation.png" title="Jenkins Installation Package" alt="Jenkins Installation package" /></p>

<p>Once the download is complete, uncompress the zip file and click on the jenkins-1.xxx.msi file. Proceed through the configuration steps to install the Jenkins as a Windows service.</p>

<h2>2. Modify Default Jenkins Port</h2>

<p>By default Jenkins runs on the port 8080. In order to avoid conflict with other applications, the default port can be modified by editing the jenkins.xml found under C:\Program Files (x86)\Jenkins location. As shown below, modify the httpPort to 8082.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;service&gt;
</span><span class='line'>  &lt;id&gt;jenkins&lt;/id&gt;
</span><span class='line'>  &lt;name&gt;Jenkins&lt;/name&gt;
</span><span class='line'>  &lt;description&gt;This service runs Jenkins continuous integration system.&lt;/description&gt;
</span><span class='line'>  &lt;env name="JENKINS_HOME" value="%BASE%"/&gt;
</span><span class='line'>  &lt;!--
</span><span class='line'>    if you'd like to run Jenkins with a specific version of Java, specify a full path to java.exe.
</span><span class='line'>    The following value assumes that you have java in your PATH.
</span><span class='line'>  --&gt;
</span><span class='line'>  &lt;executable&gt;%BASE%\jre\bin\java&lt;/executable&gt;
</span><span class='line'>  &lt;arguments&gt;-Xrs -Xmx256m -Dhudson.lifecycle=hudson.lifecycle.WindowsServiceLifecycle -jar "%BASE%\jenkins.war" --httpPort=8082&lt;/arguments&gt;
</span><span class='line'>  &lt;!--
</span><span class='line'>    interactive flag causes the empty black Java window to be displayed.
</span><span class='line'>    I'm still debugging this.
</span><span class='line'>  &lt;interactive /&gt;
</span><span class='line'>  --&gt;
</span><span class='line'>  &lt;logmode&gt;rotate&lt;/logmode&gt;
</span><span class='line'>
</span><span class='line'>  &lt;onfailure action="restart" /&gt;
</span><span class='line'>&lt;/service&gt;</span></code></pre></td></tr></table></div></figure>


<p>Once the modification is saved in jenkins.xml file, restart the Jenkins service from the Windows Task Manager->Services and right clicking on the Jenkins service and choose Stop Service to stop the service as shown below.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-stop.png" title="Jenkins Stop Service" alt="Jenkins Stop Service" /></p>

<p>Once the status of the service changes to stopped, restart the service by right clicking on the Jenkins service and choose Start Service to start the service again.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-restart.png" title="Jenkins Restart Service" alt="Jenkins Restart Service" /></p>

<p>Navigate to localhost:8082 to verify if the Jenkins restart was successful as shown below - Jenkins Dashboard will be displayed. Note that it takes a while before the Jenkins service becomes available.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-dashboard.png" title="Jenkins Dashboard" alt="Jenkins Dashboard" /></p>

<h2>3. Install Plugins</h2>

<p>On the Jenkins Dashboard, navigate to Manage Jenkins -> Manage Plugins as shown in the snapshot below.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-manageplugins.png" title="Jenkins Manage Plugins" alt="Jenkins Manage Plugins" /></p>

<p>Install the following plugins and restart Jenkins for the changes to take effect.</p>

<ul>
<li>GitHub Plugin (for integrating Github with Jenkins)</li>
<li>Jenkins Cobertura Plugin (for Cobertura support)</li>
<li>Deploy to Container Plugin (for deploying the WAR to the Tomcat Container on EC2 instance)</li>
<li>Jenkins Artifactory Plugin (for deploying the built Maven artifacts to the Snapshot repository)</li>
</ul>


<h2>4. Configure System</h2>

<p>On the Jenkins Dashboard, navigate to Manage Jenkins -> Configure System as shown in the snapshot below.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-configuresystem.png" title="Jenkins Configure System" alt="Jenkins Configure System" /></p>

<p>Navigate to the JDK section and click on &ldquo;Add JDK&rdquo; to add the JDK installation as shown in the snapshot below. Specify a JDK Name, choose the JDK Version to install and follow the on-screen instructions to save the Oracle Login credentials. Save the changes.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-java.png" title="Jenkins Java Installation" alt="Jenkins Java Installation" /></p>

<p>Next, proceed to the Git section and click on &ldquo;Add Git&rdquo; to add the Git installation as shown in the snapshot below. Specify Git Name, specify the path to Git executable and Save the changes.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-gitinstall.png" title="Jenkins Git Installation" alt="Jenkins Git Installation" /></p>

<p>Next, proceed to the Maven section and click on &ldquo;Add Maven&rdquo; to add the Maven installation as shown in the snapshot below. Specify Maven Name, choose the Maven Version to install and Save the changes.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-maven.png" title="Jenkins Maven Installation" alt="Jenkins Maven Installation" /></p>

<p>Proceed to the Git plugin section and enter the values for Github Username and Email Address as credentials as shown below. Save the changes.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-git.png" title="Jenkins Gitplugin Credentials" alt="Jenkins Gitplugin Credentials" /></p>

<p>Proceed to the Artifactory section and click on &ldquo;Add&rdquo; to add the information about the artifactory servers. Specify the URL for the snapshot repository and provide the deployer credentials created from the Artifactory server website as shown below. Click on &ldquo;Test Connection&rdquo; to test if the connection parameters are good to save and Save the changes.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-artifactory.png" title="Jenkins Artifactory Servers Configuration" alt="Jenkins Artifactory Servers Configuration" /></p>

<p>Next, proceed to the Email Notification section and enter the SMTP Server details as shown below. Click on the Advanced button to add the further details required and Save the changes. Click on &ldquo;Test configuration by sending test e-mail&rdquo;, enter the test e-mail recipient and click on &ldquo;Test configuration&rdquo; to see if the email is successfully sent.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-email.png" title="Jenkins Email Notification" alt="Jenkins Email Notification" /></p>

<h2>5. Create a New Jenkins Job</h2>

<p>From the Jenkins Dashboard, click on &ldquo;New Job&rdquo; to create a new job. Enter a name for the job and choose &ldquo;Build a maven2/3 project&rdquo; as option and click on OK as shown below.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-newjob.png" title="Jenkins New Job" alt="Jenkins New Job" /></p>

<p>From the New Job Configuration screen, proceed to the Source Code Management section and specify the Git Repository URL for the project as shown below. Save the changes.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-sourcecodemgmt.png" title="Jenkins Source Code Management" alt="Jenkins Source Code Management" /></p>

<p>Next, from the Build Triggers section, select the options desired as shown below and Save the changes.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-buildtriggers.png" title="Jenkins Build Triggers" alt="Jenkins Build Triggers" /></p>

<p>Proceed to the Build section, enter the maven goals for building a snapshot as shown below and Save the changes.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-build.png" title="Jenkins Build" alt="Jenkins Build" /></p>

<p>Proceed to the Build Settings section. Select the option for Email Notification and enter the values for the email recipients as shown below. Save the changes.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-emailnotifications.png" title="Jenkins Email Notifications" alt="Jenkins Email Notifications" /></p>

<p>Under the Post-build Actions, click on &ldquo;Add post-build action&rdquo; button and select &ldquo;Deploy war/ear to a container&rdquo;. In the Amazon EC2, a Tomcat Manager (manager as username) instance has to be configured with roles manager-gui and manager-script to allow the remote deployment of the WAR/EAR to the Tomcat Container. The configuration steps can be found in the link <a href="https://help.ubuntu.com/13.04/serverguide/tomcat.html">https://help.ubuntu.com/13.04/serverguide/tomcat.html</a> under the section of &ldquo;Tomcat administration webapps&rdquo;</p>

<p>Once the Tomcat Manager webapp configuration is complete in the Amazon EC2 instance, enter the details necessary for the deployment as shown below. Save the changes.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-deploy.png" title="Jenkins Deployment" alt="Jenkins Deployment" /></p>

<p>Similarly, from the Post-build Actions, click on &ldquo;Add post-build action&rdquo; button and select &ldquo;Publish Cobertura Coverage Report&rdquo;. Enter the Cobertura XML Report Pattern as shown below and save the changes.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jenkins-cobertura.png" title="Jenkins Cobertura Coverage Report" alt="Jenkins Cobertura Coverage Report" /></p>

<h2>6. Configure settings.xml</h2>

<p>In order to upload the built Maven artifacts to the artifactory server, configure the Jenkins settings.xml found in C:\Program Files (x86)\Jenkins\tools\hudson.tasks.Maven_MavenInstallation\Maven_3.1\conf folder with the same parameters as found in the default settings.xml (usually found under C:\Program Files\Apache Software Foundation\apache-maven-3.1.0\conf for a Windows machine) of the Maven installation on the system.</p>

<p>Typically, the server section needs to be configured in the settings.xml for Jenkins matching with the details of the Artifactory server.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;servers&gt;
</span><span class='line'>    &lt;server&gt;
</span><span class='line'>      &lt;id&gt;sonatype-nexus-snapshots&lt;/id&gt;
</span><span class='line'>      &lt;username&gt;username&lt;/username&gt;
</span><span class='line'>      &lt;password&gt;password&lt;/password&gt;
</span><span class='line'>    &lt;/server&gt;
</span><span class='line'>    &lt;server&gt;
</span><span class='line'>      &lt;id&gt;sonatype-nexus-staging&lt;/id&gt;
</span><span class='line'>      &lt;username&gt;username&lt;/username&gt;
</span><span class='line'>      &lt;password&gt;password&lt;/password&gt;
</span><span class='line'>  &lt;/server&gt;
</span><span class='line'>&lt;/servers&gt;</span></code></pre></td></tr></table></div></figure>


<h2>7. Update pom.xml</h2>

<p>The pom.xml file for the project needs to be configured with the following plugins under the build section for the deployment to snapshot repository and for running the Cobertura Coverage report.</p>

<ul>
<li>maven-compiler-plugin</li>
<li>maven-deploy-plugin</li>
<li>cobertura-maven-plugin</li>
</ul>


<p>Also add parent, scm and developer section to comply with the requirements put forth by the Artifactory server management as shown below.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;parent&gt;
</span><span class='line'>  &lt;groupId&gt;org.sonatype.oss&lt;/groupId&gt;
</span><span class='line'>  &lt;artifactId&gt;oss-parent&lt;/artifactId&gt;
</span><span class='line'>  &lt;version&gt;7&lt;/version&gt;
</span><span class='line'>&lt;/parent&gt;
</span><span class='line'>
</span><span class='line'>&lt;scm&gt;
</span><span class='line'>  &lt;connection&gt;scm:git:git@github.com:elizabetht/StudentEnrollmentWithREST.git&lt;/connection&gt;
</span><span class='line'>  &lt;developerConnection&gt;scm:git:git@github.com:elizabetht/StudentEnrollmentWithREST.git&lt;/developerConnection&gt;
</span><span class='line'>  &lt;url&gt;git@github.com:elizabetht/StudentEnrollmentWithREST.git&lt;/url&gt;
</span><span class='line'>  &lt;tag&gt;StudentEnrollmentWithREST-1.3&lt;/tag&gt;
</span><span class='line'>&lt;/scm&gt;
</span><span class='line'>&lt;developers&gt;
</span><span class='line'>  &lt;developer&gt;
</span><span class='line'>      &lt;id&gt;elizabetht&lt;/id&gt;
</span><span class='line'>      &lt;name&gt;Elizabeth Thomas&lt;/name&gt;
</span><span class='line'>      &lt;email&gt;email2eliza@gmail.com&lt;/email&gt;
</span><span class='line'>  &lt;/developer&gt;
</span><span class='line'>&lt;/developers&gt;
</span><span class='line'>
</span><span class='line'>&lt;build&gt;
</span><span class='line'>  &lt;finalName&gt;StudentEnrollmentWithREST&lt;/finalName&gt;
</span><span class='line'>  &lt;plugins&gt;
</span><span class='line'>      &lt;plugin&gt;
</span><span class='line'>          &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
</span><span class='line'>          &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
</span><span class='line'>          &lt;version&gt;2.5.1&lt;/version&gt;
</span><span class='line'>          &lt;inherited&gt;true&lt;/inherited&gt;
</span><span class='line'>          &lt;configuration&gt;
</span><span class='line'>              &lt;source&gt;1.6&lt;/source&gt;
</span><span class='line'>              &lt;target&gt;1.6&lt;/target&gt;
</span><span class='line'>          &lt;/configuration&gt;
</span><span class='line'>      &lt;/plugin&gt;
</span><span class='line'>
</span><span class='line'>      &lt;plugin&gt;
</span><span class='line'>          &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
</span><span class='line'>          &lt;artifactId&gt;maven-deploy-plugin&lt;/artifactId&gt;
</span><span class='line'>          &lt;version&gt;2.8.1&lt;/version&gt;
</span><span class='line'>          &lt;executions&gt;
</span><span class='line'>              &lt;execution&gt;
</span><span class='line'>                  &lt;id&gt;default-deploy&lt;/id&gt;
</span><span class='line'>                  &lt;phase&gt;deploy&lt;/phase&gt;
</span><span class='line'>                  &lt;goals&gt;
</span><span class='line'>                      &lt;goal&gt;deploy&lt;/goal&gt;
</span><span class='line'>                  &lt;/goals&gt;
</span><span class='line'>              &lt;/execution&gt;
</span><span class='line'>          &lt;/executions&gt;
</span><span class='line'>      &lt;/plugin&gt;                 
</span><span class='line'>
</span><span class='line'>      &lt;plugin&gt;
</span><span class='line'>          &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
</span><span class='line'>          &lt;artifactId&gt;cobertura-maven-plugin&lt;/artifactId&gt;
</span><span class='line'>          &lt;version&gt;2.6&lt;/version&gt;
</span><span class='line'>          &lt;configuration&gt;
</span><span class='line'>              &lt;formats&gt;
</span><span class='line'>                  &lt;format&gt;html&lt;/format&gt;
</span><span class='line'>                  &lt;format&gt;xml&lt;/format&gt;
</span><span class='line'>              &lt;/formats&gt;
</span><span class='line'>          &lt;/configuration&gt;
</span><span class='line'>          &lt;executions&gt;
</span><span class='line'>              &lt;execution&gt;
</span><span class='line'>                  &lt;phase&gt;package&lt;/phase&gt;
</span><span class='line'>                  &lt;goals&gt;
</span><span class='line'>                      &lt;goal&gt;cobertura&lt;/goal&gt;
</span><span class='line'>                  &lt;/goals&gt;
</span><span class='line'>              &lt;/execution&gt;
</span><span class='line'>          &lt;/executions&gt;
</span><span class='line'>      &lt;/plugin&gt;
</span><span class='line'>  &lt;/plugins&gt;
</span><span class='line'>&lt;/build&gt;</span></code></pre></td></tr></table></div></figure>


<h2>8. Build Now</h2>

<p>Once the above configuration steps are complete, click on &ldquo;Build Now&rdquo; under the Jenkins -> Upload REST Snapshot Artifacts (or the respective Job name) to build the project based on the configuration.</p>

<p>The console output has the detailed logs of what steps were initiated by the configuration and the outcome of the entire build.</p>

<p>The timestamp of the WAR deployed to Amazon EC2 instance can be checked to see if the deployment is successful. In the same way, the snapshot repository can be checked to see if the upload of the artifacts is successful.</p>

<p>Thus the entire process of building the project along with unit tests whenever a SCM change is triggered or under another condition, running code coverage reports, uploading the artifacts built to the snapshot artifactory repository, deploying the WAR to the remote server container and triggering emails to the recipients can be automated with a click of a button through Jenkins.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Building Jersey2 REST Client Using Spring With JUnit and JMock]]></title>
    <link href="http://blog.meygam.com//blog/2013/12/23/jersey2-rest-client-with-junit-and-jmock/"/>
    <updated>2013-12-23T12:10:30-06:00</updated>
    <id>http://blog.meygam.com//blog/2013/12/23/jersey2-rest-client-with-junit-and-jmock</id>
    <content type="html"><![CDATA[<p>This post will show how to create a Jersey2 REST Client in a Spring environment and test the same using JUnit and JMock frameworks. The details of the actual application are explained in the earlier post given by the link <a href="http://meygam.github.io/blog/2013/12/13/student-enrollment-using-jersey-rest-with-spring/">Building Java Web Application Using Jersey REST With Spring</a>.</p>

<!-- more -->


<h2>1. Update pom.xml</h2>

<p>To make the Maven Java Web Application project (<a href="http://meygam.github.io/blog/2013/12/13/student-enrollment-using-jersey-rest-with-spring/">Building Java Web Application Using Jersey REST With Spring</a>) support the JUnit testing framework, add the following dependency to the existing pom.xml</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;dependency&gt;
</span><span class='line'>  &lt;groupId&gt;org.jmock&lt;/groupId&gt;
</span><span class='line'>  &lt;artifactId&gt;jmock-junit4&lt;/artifactId&gt;
</span><span class='line'>  &lt;version&gt;2.6.0&lt;/version&gt;
</span><span class='line'>&lt;/dependency&gt;</span></code></pre></td></tr></table></div></figure>


<h2>2. Create packages for Client tier classes</h2>

<p>Create package for the Jersey Client classes under the src/main/java folder.</p>

<p>A sample snapshot of the project after the package creation is as shown below:</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jersey-client-package.png" title="Jersey REST Client Package Layout" alt="Jersey REST Client Package Layout" /></p>

<h2>3. Create classes for Client tier</h2>

<p>Create an interface class named StudentClientInterface.java inside the package com.github.elizabetht.client to support the client operations.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public interface StudentClientInterface {
</span><span class='line'>
</span><span class='line'>  public Response getSignup();
</span><span class='line'>
</span><span class='line'>  public Response postSignup(String userName, String password,
</span><span class='line'>          String firstName, String lastName, String dateOfBirth,
</span><span class='line'>          String emailAddress) throws Exception;
</span><span class='line'>
</span><span class='line'>  public Response getLogin();
</span><span class='line'>
</span><span class='line'>  public Response postLogin(String userName, String password);
</span><span class='line'>
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Create a client tier implementation class (a POJO indeed) named StudentClient.java inside the package com.github.elizabetht.client. This is where the client logic goes - either to access the GET/POST methods in the StudentResource.java class.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public class StudentClient implements StudentClientInterface {
</span><span class='line'>  private WebTarget target;
</span><span class='line'>
</span><span class='line'>  public StudentClient(WebTarget target) {
</span><span class='line'>      this.target = target;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public Response getSignup() {       
</span><span class='line'>      Response response = target.path("signup").request().get(Response.class);
</span><span class='line'>      return response;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public Response postSignup(String userName, String password,
</span><span class='line'>          String firstName, String lastName, String dateOfBirth,
</span><span class='line'>          String emailAddress) throws Exception {
</span><span class='line'>      
</span><span class='line'>      Form form = new Form().param("userName", userName)
</span><span class='line'>              .param("password", password).param("firstName", firstName)
</span><span class='line'>              .param("lastName", lastName).param("dateOfBirth", dateOfBirth)
</span><span class='line'>              .param("emailAddress", emailAddress);
</span><span class='line'>      Response response = target.path("signup").request()
</span><span class='line'>              .post(Entity.form(form));
</span><span class='line'>
</span><span class='line'>      if (response.getStatus() == Status.INTERNAL_SERVER_ERROR
</span><span class='line'>              .getStatusCode()) {
</span><span class='line'>          throw new Exception();
</span><span class='line'>      }
</span><span class='line'>
</span><span class='line'>      if (response.getStatus() != Status.OK.getStatusCode()) {
</span><span class='line'>          throw new RuntimeException();
</span><span class='line'>      }
</span><span class='line'>
</span><span class='line'>      return response;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public Response getLogin() {
</span><span class='line'>      Response response = target.path("login").request().get(Response.class);
</span><span class='line'>
</span><span class='line'>      return response;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public Response postLogin(String userName, String password) {
</span><span class='line'>      Form form = new Form().param("userName", userName).param("password",
</span><span class='line'>              password);
</span><span class='line'>
</span><span class='line'>      Response response = target.path("login").request()
</span><span class='line'>              .post(Entity.form(form));
</span><span class='line'>
</span><span class='line'>      if (response.getStatus() != Status.OK.getStatusCode()) {
</span><span class='line'>          throw new RuntimeException();
</span><span class='line'>      }
</span><span class='line'>
</span><span class='line'>      return response;
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>4. Create packages for Client Test tier classes</h2>

<p>Create package for the Client Test classes by right-clicking on the StudentClient.java class and choosing &ldquo;New->JUnit Test Case&rdquo; option. Specify the source folder as StudentEnrollmentWithREST/src/test/java folder (create the src/test/java folder if the folder does not exist) and specify the name for the test class.</p>

<p>A sample snapshot of the project after the package creation is as shown below:</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jersey-client-test-package.png" title="Jersey REST Client Test Package Layout" alt="Jersey REST Client Test Package Layout" /></p>

<h2>5. Extract Interfaces for Model and Resource tier classes</h2>

<p>In order to support the use of JMock mocking framework alongside JUnit test cases, extract the interfaces out of the Model(Student.java) and Resource (StudentResource.java) tier classes. This is necessary in order to mock the objects.</p>

<p>Extracting interfaces can be done by right-clicking on the class file and choosing &ldquo;Refactor->Extract Interface&rdquo; option.</p>

<p>The StudentInterface.java (in src/main/java/com.github.elizabetht.model package) after the extraction looks as below.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public interface StudentInterface {
</span><span class='line'>
</span><span class='line'>  public Long getId();
</span><span class='line'>
</span><span class='line'>  public void setId(Long id);
</span><span class='line'>
</span><span class='line'>  public String getUserName();
</span><span class='line'>
</span><span class='line'>  public void setUserName(String userName);
</span><span class='line'>
</span><span class='line'>  public String getFirstName();
</span><span class='line'>
</span><span class='line'>  public void setFirstName(String firstName);
</span><span class='line'>
</span><span class='line'>  public String getLastName();
</span><span class='line'>
</span><span class='line'>  public void setLastName(String lastName);
</span><span class='line'>
</span><span class='line'>  public String getPassword();
</span><span class='line'>
</span><span class='line'>  public void setPassword(String password);
</span><span class='line'>
</span><span class='line'>  public String getEmailAddress();
</span><span class='line'>
</span><span class='line'>  public void setEmailAddress(String emailAddress);
</span><span class='line'>
</span><span class='line'>  public Date getDateOfBirth();
</span><span class='line'>
</span><span class='line'>  public void setDateOfBirth(Date dateOfBirth);
</span><span class='line'>
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Similarly, the StudentResourceInterface.java (in src/main/java/com.github.elizabetht.resource package) looks as below.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public interface StudentResourceInterface {
</span><span class='line'>
</span><span class='line'>  public Response signup();
</span><span class='line'>
</span><span class='line'>  public Response signup(String userName, String password, String firstName,
</span><span class='line'>          String lastName, String dateOfBirth, String emailAddress)
</span><span class='line'>          throws ParseException;
</span><span class='line'>
</span><span class='line'>  public Response login();
</span><span class='line'>
</span><span class='line'>  public Response login(String userName, String password);
</span><span class='line'>
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>6. Create Unit Test cases for StudentClient class</h2>

<p>As a part of unit testing, each of the unit must be testable individually. While in reality, each unit would depend on other modules. This is where JMock comes into picture - to help to test a unit individually by mocking the dependencies.</p>

<p>@Before annotation helps to define the environment that needs to be setup before running each test case. In this example, the context and mock objects are setup using the @Before annotation.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
<span class='line-number'>196</span>
<span class='line-number'>197</span>
<span class='line-number'>198</span>
<span class='line-number'>199</span>
<span class='line-number'>200</span>
<span class='line-number'>201</span>
<span class='line-number'>202</span>
<span class='line-number'>203</span>
<span class='line-number'>204</span>
<span class='line-number'>205</span>
<span class='line-number'>206</span>
<span class='line-number'>207</span>
<span class='line-number'>208</span>
<span class='line-number'>209</span>
<span class='line-number'>210</span>
<span class='line-number'>211</span>
<span class='line-number'>212</span>
<span class='line-number'>213</span>
<span class='line-number'>214</span>
<span class='line-number'>215</span>
<span class='line-number'>216</span>
<span class='line-number'>217</span>
<span class='line-number'>218</span>
<span class='line-number'>219</span>
<span class='line-number'>220</span>
<span class='line-number'>221</span>
<span class='line-number'>222</span>
<span class='line-number'>223</span>
<span class='line-number'>224</span>
<span class='line-number'>225</span>
<span class='line-number'>226</span>
<span class='line-number'>227</span>
<span class='line-number'>228</span>
<span class='line-number'>229</span>
<span class='line-number'>230</span>
<span class='line-number'>231</span>
<span class='line-number'>232</span>
<span class='line-number'>233</span>
<span class='line-number'>234</span>
<span class='line-number'>235</span>
<span class='line-number'>236</span>
<span class='line-number'>237</span>
<span class='line-number'>238</span>
<span class='line-number'>239</span>
<span class='line-number'>240</span>
<span class='line-number'>241</span>
<span class='line-number'>242</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public class StudentClientUnitTest {
</span><span class='line'>  private Mockery context;
</span><span class='line'>  private StudentClient studentClient;
</span><span class='line'>  private WebTarget target;
</span><span class='line'>  private Builder builder;
</span><span class='line'>
</span><span class='line'>  @Before
</span><span class='line'>  public void beforeEachTest() {
</span><span class='line'>      context = new Mockery();
</span><span class='line'>      studentClient = new StudentClient(
</span><span class='line'>              ClientBuilder
</span><span class='line'>                      .newClient()
</span><span class='line'>                      .target("http://localhost:8080/StudentEnrollmentWithREST/webapi/studentResource/"));
</span><span class='line'>      target = context.mock(WebTarget.class);
</span><span class='line'>      builder = context.mock(Builder.class);
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @Test
</span><span class='line'>  public void getSignupTest() {
</span><span class='line'>      studentClient = new StudentClient(target);
</span><span class='line'>
</span><span class='line'>      final Response response = Response.ok(new Viewable("/signup")).build();
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(target).path(with(any(String.class)));
</span><span class='line'>              will(returnValue(target));
</span><span class='line'>              oneOf(target).request();
</span><span class='line'>              will(returnValue(builder));
</span><span class='line'>              oneOf(builder).get(Response.class);
</span><span class='line'>              will(returnValue(response));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentClient.getSignup();
</span><span class='line'>      assertEquals(response.getStatus(), Status.OK.getStatusCode());
</span><span class='line'>
</span><span class='line'>      context.assertIsSatisfied();
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @Test
</span><span class='line'>  public void postSignupTest() throws Exception {
</span><span class='line'>      String userName = "jersey";
</span><span class='line'>      String password = "jersey";
</span><span class='line'>      String firstName = "jersey";
</span><span class='line'>      String lastName = "jersey";
</span><span class='line'>      String dateOfBirth = "12-21-2013";
</span><span class='line'>      String emailAddress = "jersey@gmail.com";
</span><span class='line'>      studentClient = new StudentClient(target);
</span><span class='line'>
</span><span class='line'>      final Response response = Response.ok(new Viewable("/success")).build();
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(target).path(with(any(String.class)));
</span><span class='line'>              will(returnValue(target));
</span><span class='line'>              oneOf(target).request();
</span><span class='line'>              will(returnValue(builder));
</span><span class='line'>              oneOf(builder).post(with(any(Entity.class)));
</span><span class='line'>              will(returnValue(response));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentClient.postSignup(userName, password, firstName, lastName,
</span><span class='line'>              dateOfBirth, emailAddress);
</span><span class='line'>      assertEquals(response.getStatus(), Status.OK.getStatusCode());
</span><span class='line'>
</span><span class='line'>      context.assertIsSatisfied();
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @Test(expected = Exception.class)
</span><span class='line'>  public void postSignupInvalidDateFormatTest() throws Exception {
</span><span class='line'>      String userName = "jersey";
</span><span class='line'>      String password = "jersey";
</span><span class='line'>      String firstName = "jersey";
</span><span class='line'>      String lastName = "jersey";
</span><span class='line'>      String dateOfBirth = "12/21/2013";
</span><span class='line'>      String emailAddress = "jersey@gmail.com";
</span><span class='line'>      studentClient = new StudentClient(target);
</span><span class='line'>
</span><span class='line'>      final Response response = Response.status(Status.PRECONDITION_FAILED)
</span><span class='line'>              .build();
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(target).path(with(any(String.class)));
</span><span class='line'>              will(returnValue(target));
</span><span class='line'>              oneOf(target).request();
</span><span class='line'>              will(returnValue(builder));
</span><span class='line'>              oneOf(builder).post(with(any(Entity.class)));
</span><span class='line'>              will(returnValue(response));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentClient.postSignup(userName, password, firstName, lastName,
</span><span class='line'>              dateOfBirth, emailAddress);
</span><span class='line'>      assertEquals(response.getStatus(), Status.PRECONDITION_FAILED.getStatusCode());
</span><span class='line'>
</span><span class='line'>      context.assertIsSatisfied();
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @Test(expected = Exception.class)
</span><span class='line'>  public void postSignupBadRequestTest() throws Exception {
</span><span class='line'>      String userName = null;
</span><span class='line'>      String password = null;
</span><span class='line'>      String firstName = null;
</span><span class='line'>      String lastName = null;
</span><span class='line'>      String dateOfBirth = null;
</span><span class='line'>      String emailAddress = null;
</span><span class='line'>      studentClient = new StudentClient(target);
</span><span class='line'>
</span><span class='line'>      final Response response = Response.status(Status.PRECONDITION_FAILED)
</span><span class='line'>              .build();
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(target).path(with(any(String.class)));
</span><span class='line'>              will(returnValue(target));
</span><span class='line'>              oneOf(target).request();
</span><span class='line'>              will(returnValue(builder));
</span><span class='line'>              oneOf(builder).post(with(any(Entity.class)));
</span><span class='line'>              will(returnValue(response));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentClient.postSignup(userName, password, firstName, lastName,
</span><span class='line'>              dateOfBirth, emailAddress);
</span><span class='line'>      assertEquals(response.getStatus(), Status.PRECONDITION_FAILED.getStatusCode());
</span><span class='line'>
</span><span class='line'>      context.assertIsSatisfied();
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @Test(expected = RuntimeException.class)
</span><span class='line'>  public void postSignupExistingUserTest() throws Exception {
</span><span class='line'>      String userName = "jersey";
</span><span class='line'>      String password = "jersey";
</span><span class='line'>      String firstName = "jersey";
</span><span class='line'>      String lastName = "jersey";
</span><span class='line'>      String dateOfBirth = "12/21/2013";
</span><span class='line'>      String emailAddress = "jersey@gmail.com";
</span><span class='line'>      studentClient = new StudentClient(target);
</span><span class='line'>
</span><span class='line'>      final Response response = Response.status(Status.BAD_REQUEST).build();
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(target).path(with(any(String.class)));
</span><span class='line'>              will(returnValue(target));
</span><span class='line'>              oneOf(target).request();
</span><span class='line'>              will(returnValue(builder));
</span><span class='line'>              oneOf(builder).post(with(any(Entity.class)));
</span><span class='line'>              will(returnValue(response));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentClient.postSignup(userName, password, firstName, lastName,
</span><span class='line'>              dateOfBirth, emailAddress);
</span><span class='line'>      assertEquals(response.getStatus(), Status.BAD_REQUEST.getStatusCode());
</span><span class='line'>
</span><span class='line'>      context.assertIsSatisfied();
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @Test
</span><span class='line'>  public void getLoginTest() {
</span><span class='line'>      studentClient = new StudentClient(target);
</span><span class='line'>
</span><span class='line'>      final Response response = Response.ok(new Viewable("/login")).build();
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(target).path(with(any(String.class)));
</span><span class='line'>              will(returnValue(target));
</span><span class='line'>              oneOf(target).request();
</span><span class='line'>              will(returnValue(builder));
</span><span class='line'>              oneOf(builder).get(Response.class);
</span><span class='line'>              will(returnValue(response));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentClient.getLogin();
</span><span class='line'>      assertEquals(response.getStatus(), Status.OK.getStatusCode());
</span><span class='line'>
</span><span class='line'>      context.assertIsSatisfied();
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @Test
</span><span class='line'>  public void postLoginTest() {
</span><span class='line'>      String userName = "jersey";
</span><span class='line'>      String password = "jersey";
</span><span class='line'>      studentClient = new StudentClient(target);
</span><span class='line'>
</span><span class='line'>      final Response response = Response.ok(new Viewable("/success")).build();
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(target).path(with(any(String.class)));
</span><span class='line'>              will(returnValue(target));
</span><span class='line'>              oneOf(target).request();
</span><span class='line'>              will(returnValue(builder));
</span><span class='line'>              oneOf(builder).post(with(any(Entity.class)));
</span><span class='line'>              will(returnValue(response));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentClient.postLogin(userName, password);
</span><span class='line'>      assertEquals(response.getStatus(), Status.OK.getStatusCode());
</span><span class='line'>
</span><span class='line'>      context.assertIsSatisfied();
</span><span class='line'>  }
</span><span class='line'>  
</span><span class='line'>  @Test(expected=RuntimeException.class)
</span><span class='line'>  public void postLoginInvalidTest() {
</span><span class='line'>      String userName = "jersey";
</span><span class='line'>      String password = "jersey123";
</span><span class='line'>      studentClient = new StudentClient(target);
</span><span class='line'>
</span><span class='line'>      final Response response = Response.status(Status.BAD_REQUEST).build();
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(target).path(with(any(String.class)));
</span><span class='line'>              will(returnValue(target));
</span><span class='line'>              oneOf(target).request();
</span><span class='line'>              will(returnValue(builder));
</span><span class='line'>              oneOf(builder).post(with(any(Entity.class)));
</span><span class='line'>              will(returnValue(response));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentClient.postLogin(userName, password);
</span><span class='line'>      assertEquals(response.getStatus(), Status.BAD_REQUEST.getStatusCode());
</span><span class='line'>
</span><span class='line'>      context.assertIsSatisfied();
</span><span class='line'>  }
</span><span class='line'>  
</span><span class='line'>  @Test(expected=RuntimeException.class)
</span><span class='line'>  public void postLoginBadRequestTest() {
</span><span class='line'>      String userName = null;
</span><span class='line'>      String password = null;
</span><span class='line'>      studentClient = new StudentClient(target);
</span><span class='line'>
</span><span class='line'>      final Response response = Response.status(Status.PRECONDITION_FAILED).build();
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(target).path(with(any(String.class)));
</span><span class='line'>              will(returnValue(target));
</span><span class='line'>              oneOf(target).request();
</span><span class='line'>              will(returnValue(builder));
</span><span class='line'>              oneOf(builder).post(with(any(Entity.class)));
</span><span class='line'>              will(returnValue(response));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentClient.postLogin(userName, password);
</span><span class='line'>      assertEquals(response.getStatus(), Status.PRECONDITION_FAILED.getStatusCode());
</span><span class='line'>
</span><span class='line'>      context.assertIsSatisfied();
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>7. Create Unit Test cases for StudentResource class</h2>

<p>In similar lines, create unit test cases for StudentResource class by mocking the external dependencies which the class depends on for its operation.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
<span class='line-number'>196</span>
<span class='line-number'>197</span>
<span class='line-number'>198</span>
<span class='line-number'>199</span>
<span class='line-number'>200</span>
<span class='line-number'>201</span>
<span class='line-number'>202</span>
<span class='line-number'>203</span>
<span class='line-number'>204</span>
<span class='line-number'>205</span>
<span class='line-number'>206</span>
<span class='line-number'>207</span>
<span class='line-number'>208</span>
<span class='line-number'>209</span>
<span class='line-number'>210</span>
<span class='line-number'>211</span>
<span class='line-number'>212</span>
<span class='line-number'>213</span>
<span class='line-number'>214</span>
<span class='line-number'>215</span>
<span class='line-number'>216</span>
<span class='line-number'>217</span>
<span class='line-number'>218</span>
<span class='line-number'>219</span>
<span class='line-number'>220</span>
<span class='line-number'>221</span>
<span class='line-number'>222</span>
<span class='line-number'>223</span>
<span class='line-number'>224</span>
<span class='line-number'>225</span>
<span class='line-number'>226</span>
<span class='line-number'>227</span>
<span class='line-number'>228</span>
<span class='line-number'>229</span>
<span class='line-number'>230</span>
<span class='line-number'>231</span>
<span class='line-number'>232</span>
<span class='line-number'>233</span>
<span class='line-number'>234</span>
<span class='line-number'>235</span>
<span class='line-number'>236</span>
<span class='line-number'>237</span>
<span class='line-number'>238</span>
<span class='line-number'>239</span>
<span class='line-number'>240</span>
<span class='line-number'>241</span>
<span class='line-number'>242</span>
<span class='line-number'>243</span>
<span class='line-number'>244</span>
<span class='line-number'>245</span>
<span class='line-number'>246</span>
<span class='line-number'>247</span>
<span class='line-number'>248</span>
<span class='line-number'>249</span>
<span class='line-number'>250</span>
<span class='line-number'>251</span>
<span class='line-number'>252</span>
<span class='line-number'>253</span>
<span class='line-number'>254</span>
<span class='line-number'>255</span>
<span class='line-number'>256</span>
<span class='line-number'>257</span>
<span class='line-number'>258</span>
<span class='line-number'>259</span>
<span class='line-number'>260</span>
<span class='line-number'>261</span>
<span class='line-number'>262</span>
<span class='line-number'>263</span>
<span class='line-number'>264</span>
<span class='line-number'>265</span>
<span class='line-number'>266</span>
<span class='line-number'>267</span>
<span class='line-number'>268</span>
<span class='line-number'>269</span>
<span class='line-number'>270</span>
<span class='line-number'>271</span>
<span class='line-number'>272</span>
<span class='line-number'>273</span>
<span class='line-number'>274</span>
<span class='line-number'>275</span>
<span class='line-number'>276</span>
<span class='line-number'>277</span>
<span class='line-number'>278</span>
<span class='line-number'>279</span>
<span class='line-number'>280</span>
<span class='line-number'>281</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public class StudentResourceUnitTest {
</span><span class='line'>  private Mockery context;
</span><span class='line'>  private StudentService studentService;
</span><span class='line'>  private StudentResourceInterface studentResourceInterface;
</span><span class='line'>
</span><span class='line'>  @Before
</span><span class='line'>  public void beforeEachTest() throws Exception {
</span><span class='line'>      context = new Mockery();
</span><span class='line'>      studentService = context.mock(StudentService.class);
</span><span class='line'>      studentResourceInterface = new StudentResource();
</span><span class='line'>
</span><span class='line'>      Field field = studentResourceInterface.getClass().getDeclaredField(
</span><span class='line'>              "studentService");
</span><span class='line'>      field.setAccessible(true);
</span><span class='line'>      field.set(studentResourceInterface, studentService);
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @Test
</span><span class='line'>  public void postSignupResourceTest() throws ParseException {
</span><span class='line'>      final String userName = "jersey";
</span><span class='line'>      String password = "jersey";
</span><span class='line'>      String firstName = "jersey";
</span><span class='line'>      String lastName = "jersey";
</span><span class='line'>      String dateOfBirth = "12/21/2013";
</span><span class='line'>      String emailAddress = "jersey@gmail.com";
</span><span class='line'>      final StudentInterface student = context.mock(StudentInterface.class);
</span><span class='line'>
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentService).findByUserName(userName);
</span><span class='line'>              will(returnValue(false));
</span><span class='line'>              oneOf(studentService).save(with(any(StudentInterface.class)));
</span><span class='line'>              will(returnValue(student));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentResourceInterface.signup(userName, password, firstName,
</span><span class='line'>              lastName, dateOfBirth, emailAddress);
</span><span class='line'>
</span><span class='line'>      context.assertIsSatisfied();
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @Test
</span><span class='line'>  public void postSignupResourceForExistingUserTest() throws ParseException {
</span><span class='line'>      final String userName = "jersey";
</span><span class='line'>      String password = "jersey";
</span><span class='line'>      String firstName = "jersey";
</span><span class='line'>      String lastName = "jersey";
</span><span class='line'>      String dateOfBirth = "12/21/2013";
</span><span class='line'>      String emailAddress = "jersey@gmail.com";
</span><span class='line'>
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentService).findByUserName(userName);
</span><span class='line'>              will(returnValue(true));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentResourceInterface.signup(userName, password, firstName,
</span><span class='line'>              lastName, dateOfBirth, emailAddress);
</span><span class='line'>
</span><span class='line'>      context.assertIsSatisfied();
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @Test
</span><span class='line'>  public void postSignupResourceForBadRequestTest() throws ParseException {
</span><span class='line'>      String userName = null;
</span><span class='line'>      String password = null;
</span><span class='line'>      String firstName = null;
</span><span class='line'>      String lastName = null;
</span><span class='line'>      String dateOfBirth = null;
</span><span class='line'>      String emailAddress = null;
</span><span class='line'>      final StudentResourceInterface studentResourceInterface = context
</span><span class='line'>              .mock(StudentResourceInterface.class);
</span><span class='line'>      final Response response = Response.status(Status.PRECONDITION_FAILED)
</span><span class='line'>              .build();
</span><span class='line'>      final Response response1 = Response.ok().entity(new Viewable("/login"))
</span><span class='line'>              .build();
</span><span class='line'>
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentResourceInterface).signup(
</span><span class='line'>                      with(aNull(String.class)), with(aNull(String.class)),
</span><span class='line'>                      with(aNull(String.class)), with(aNull(String.class)),
</span><span class='line'>                      with(aNull(String.class)), with(aNull(String.class)));
</span><span class='line'>              will(returnValue(response));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentResourceInterface.signup(userName, password, firstName,
</span><span class='line'>              lastName, dateOfBirth, emailAddress);
</span><span class='line'>      assertEquals(response.getStatus(),
</span><span class='line'>              Status.PRECONDITION_FAILED.getStatusCode());
</span><span class='line'>
</span><span class='line'>      userName = "jersey";
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentResourceInterface).signup(
</span><span class='line'>                      with(aNonNull(String.class)),
</span><span class='line'>                      with(aNull(String.class)), with(aNull(String.class)),
</span><span class='line'>                      with(aNull(String.class)), with(aNull(String.class)),
</span><span class='line'>                      with(aNull(String.class)));
</span><span class='line'>              will(returnValue(response));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentResourceInterface.signup(userName, password, firstName,
</span><span class='line'>              lastName, dateOfBirth, emailAddress);
</span><span class='line'>      assertEquals(response.getStatus(),
</span><span class='line'>              Status.PRECONDITION_FAILED.getStatusCode());
</span><span class='line'>
</span><span class='line'>      password = "jersey";
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentResourceInterface).signup(
</span><span class='line'>                      with(aNonNull(String.class)),
</span><span class='line'>                      with(aNonNull(String.class)),
</span><span class='line'>                      with(aNull(String.class)), with(aNull(String.class)),
</span><span class='line'>                      with(aNull(String.class)), with(aNull(String.class)));
</span><span class='line'>              will(returnValue(response));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentResourceInterface.signup(userName, password, firstName,
</span><span class='line'>              lastName, dateOfBirth, emailAddress);
</span><span class='line'>      assertEquals(response.getStatus(),
</span><span class='line'>              Status.PRECONDITION_FAILED.getStatusCode());
</span><span class='line'>
</span><span class='line'>      firstName = "jersey";
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentResourceInterface).signup(
</span><span class='line'>                      with(aNonNull(String.class)),
</span><span class='line'>                      with(aNonNull(String.class)),
</span><span class='line'>                      with(aNonNull(String.class)),
</span><span class='line'>                      with(aNull(String.class)), with(aNull(String.class)),
</span><span class='line'>                      with(aNull(String.class)));
</span><span class='line'>              will(returnValue(response));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentResourceInterface.signup(userName, password, firstName,
</span><span class='line'>              lastName, dateOfBirth, emailAddress);
</span><span class='line'>
</span><span class='line'>      lastName = "jersey";
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentResourceInterface).signup(
</span><span class='line'>                      with(aNonNull(String.class)),
</span><span class='line'>                      with(aNonNull(String.class)),
</span><span class='line'>                      with(aNonNull(String.class)),
</span><span class='line'>                      with(aNonNull(String.class)),
</span><span class='line'>                      with(aNull(String.class)), with(aNull(String.class)));
</span><span class='line'>              will(returnValue(response));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentResourceInterface.signup(userName, password, firstName,
</span><span class='line'>              lastName, dateOfBirth, emailAddress);
</span><span class='line'>      assertEquals(response.getStatus(),
</span><span class='line'>              Status.PRECONDITION_FAILED.getStatusCode());
</span><span class='line'>
</span><span class='line'>      dateOfBirth = "12/20/2013";
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentResourceInterface)
</span><span class='line'>                      .signup(with(aNonNull(String.class)),
</span><span class='line'>                              with(aNonNull(String.class)),
</span><span class='line'>                              with(aNonNull(String.class)),
</span><span class='line'>                              with(aNonNull(String.class)),
</span><span class='line'>                              with(aNonNull(String.class)),
</span><span class='line'>                              with(aNull(String.class)));
</span><span class='line'>              will(returnValue(response));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentResourceInterface.signup(userName, password, firstName,
</span><span class='line'>              lastName, dateOfBirth, emailAddress);
</span><span class='line'>      assertEquals(response.getStatus(),
</span><span class='line'>              Status.PRECONDITION_FAILED.getStatusCode());
</span><span class='line'>
</span><span class='line'>      emailAddress = "jersey@gmail.com";
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentResourceInterface).signup(
</span><span class='line'>                      with(aNonNull(String.class)),
</span><span class='line'>                      with(aNonNull(String.class)),
</span><span class='line'>                      with(aNonNull(String.class)),
</span><span class='line'>                      with(aNonNull(String.class)),
</span><span class='line'>                      with(aNonNull(String.class)),
</span><span class='line'>                      with(aNonNull(String.class)));
</span><span class='line'>              will(returnValue(response1));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentResourceInterface.signup(userName, password, firstName,
</span><span class='line'>              lastName, dateOfBirth, emailAddress);
</span><span class='line'>      assertEquals(response1.getStatus(), Status.OK.getStatusCode());
</span><span class='line'>
</span><span class='line'>      context.assertIsSatisfied();
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @Test
</span><span class='line'>  public void postLoginResourceTest() throws ParseException {
</span><span class='line'>      final String userName = "jersey";
</span><span class='line'>      final String password = "jersey";
</span><span class='line'>
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentService).findByLogin(userName, password);
</span><span class='line'>              will(returnValue(true));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentResourceInterface.login(userName, password);
</span><span class='line'>
</span><span class='line'>      final String password1 = "jersey123";
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentService).findByLogin(userName, password1);
</span><span class='line'>              will(returnValue(false));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentResourceInterface.login(userName, password1);
</span><span class='line'>
</span><span class='line'>      context.assertIsSatisfied();
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @Test
</span><span class='line'>  public void postLoginResourceForBadRequestTest() throws ParseException {
</span><span class='line'>      final String userName = null;
</span><span class='line'>      final String password = null;
</span><span class='line'>      final StudentResourceInterface studentResourceInterface = context
</span><span class='line'>              .mock(StudentResourceInterface.class);
</span><span class='line'>      final Response response = Response.status(Status.PRECONDITION_FAILED)
</span><span class='line'>              .build();
</span><span class='line'>      final Response response1 = Response.ok().entity(new Viewable("/login"))
</span><span class='line'>              .build();
</span><span class='line'>
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentResourceInterface).login(
</span><span class='line'>                      with(aNull(String.class)), with(aNull(String.class)));
</span><span class='line'>              will(returnValue(response));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentResourceInterface.login(userName, password);
</span><span class='line'>      assertEquals(response.getStatus(),
</span><span class='line'>              Status.PRECONDITION_FAILED.getStatusCode());
</span><span class='line'>
</span><span class='line'>      final String userName1 = "jersey";
</span><span class='line'>
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentResourceInterface)
</span><span class='line'>                      .login(with(aNonNull(String.class)),
</span><span class='line'>                              with(aNull(String.class)));
</span><span class='line'>              will(returnValue(response));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentResourceInterface.login(userName1, password);
</span><span class='line'>      assertEquals(response.getStatus(),
</span><span class='line'>              Status.PRECONDITION_FAILED.getStatusCode());
</span><span class='line'>
</span><span class='line'>      final String password1 = "jersey";
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentResourceInterface)
</span><span class='line'>                      .login(with(aNull(String.class)),
</span><span class='line'>                              with(aNonNull(String.class)));
</span><span class='line'>              will(returnValue(response));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentResourceInterface.login(userName, password1);
</span><span class='line'>      assertEquals(response.getStatus(),
</span><span class='line'>              Status.PRECONDITION_FAILED.getStatusCode());
</span><span class='line'>
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentResourceInterface).login(
</span><span class='line'>                      with(aNonNull(String.class)),
</span><span class='line'>                      with(aNonNull(String.class)));
</span><span class='line'>              will(returnValue(response1));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentResourceInterface.login(userName1, password1);
</span><span class='line'>      assertEquals(response1.getStatus(), Status.OK.getStatusCode());
</span><span class='line'>
</span><span class='line'>      context.assertIsSatisfied();
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>8. Create Unit Test cases for StudentService class</h2>

<p>Create unit test cases for StudentService class by mocking the external dependencies which the class depends on for its operation.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public class StudentServiceUnitTest {
</span><span class='line'>  private Mockery context;
</span><span class='line'>  private StudentRepository studentRepository;
</span><span class='line'>  private StudentService studentService;
</span><span class='line'>
</span><span class='line'>  @Before
</span><span class='line'>  public void beforeEachTest() throws Exception {
</span><span class='line'>      context = new Mockery();
</span><span class='line'>      studentRepository = context.mock(StudentRepository.class);
</span><span class='line'>      studentService = new StudentServiceImpl();
</span><span class='line'>
</span><span class='line'>      Field field = studentService.getClass().getDeclaredField(
</span><span class='line'>              "studentRepository");
</span><span class='line'>      field.setAccessible(true);
</span><span class='line'>      field.set(studentService, studentRepository);
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @Test
</span><span class='line'>  public void findByLoginTest() {
</span><span class='line'>      final String userName = "j2eee";
</span><span class='line'>      final String password = "j2ee";
</span><span class='line'>      final StudentInterface studentInterface = null;
</span><span class='line'>
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentRepository).findByUserName(userName);
</span><span class='line'>              will(returnValue(studentInterface));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentService.findByLogin(userName, password);
</span><span class='line'>      assertNull(studentInterface);
</span><span class='line'>
</span><span class='line'>      final String userName1 = "j2ee";
</span><span class='line'>      final StudentInterface studentInterface1 = context
</span><span class='line'>              .mock(StudentInterface.class);
</span><span class='line'>
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentRepository).findByUserName(userName1);
</span><span class='line'>              will(returnValue(studentInterface1));
</span><span class='line'>              oneOf(studentInterface1).getPassword();
</span><span class='line'>              will(returnValue(password));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentService.findByLogin(userName1, password);
</span><span class='line'>      assertNotNull(studentInterface1);
</span><span class='line'>      assertEquals("j2ee", password);
</span><span class='line'>
</span><span class='line'>      final String password1 = "j2eee";
</span><span class='line'>
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentRepository).findByUserName(userName1);
</span><span class='line'>              will(returnValue(studentInterface1));
</span><span class='line'>              oneOf(studentInterface1).getPassword();
</span><span class='line'>              will(returnValue(password1));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentService.findByLogin(userName1, password1);
</span><span class='line'>      assertNotNull(studentInterface1);
</span><span class='line'>      assertNotEquals("j2ee", password1);
</span><span class='line'>
</span><span class='line'>      context.assertIsSatisfied();
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @Test
</span><span class='line'>  public void findByLoginWithNullParametersTest() {
</span><span class='line'>      final String userName = null;
</span><span class='line'>      final String password = null;
</span><span class='line'>      studentService = context.mock(StudentService.class);
</span><span class='line'>
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentService).findByLogin(with(aNull(String.class)),
</span><span class='line'>                      with(aNull(String.class)));
</span><span class='line'>              will(returnValue(false));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentService.findByLogin(userName, password);
</span><span class='line'>
</span><span class='line'>      final String userName1 = "j2ee";
</span><span class='line'>
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentService).findByLogin(with(aNonNull(String.class)),
</span><span class='line'>                      with(aNull(String.class)));
</span><span class='line'>              will(returnValue(false));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentService.findByLogin(userName1, password);
</span><span class='line'>
</span><span class='line'>      final String password1 = "j2eee";
</span><span class='line'>
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentService).findByLogin(with(aNull(String.class)),
</span><span class='line'>                      with(aNonNull(String.class)));
</span><span class='line'>              will(returnValue(false));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentService.findByLogin(userName, password1);
</span><span class='line'>
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentService).findByLogin(with(aNonNull(String.class)),
</span><span class='line'>                      with(aNonNull(String.class)));
</span><span class='line'>              will(returnValue(false));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentService.findByLogin(userName1, password1);
</span><span class='line'>
</span><span class='line'>      context.assertIsSatisfied();
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @Test
</span><span class='line'>  public void findByEmptyLoginTest() {
</span><span class='line'>      final String userName = "";
</span><span class='line'>      final String password = "";
</span><span class='line'>      final StudentInterface studentInterface = null;
</span><span class='line'>
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentRepository).findByUserName(userName);
</span><span class='line'>              will(returnValue(studentInterface));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentService.findByLogin(userName, password);
</span><span class='line'>      assertNull(studentInterface);
</span><span class='line'>
</span><span class='line'>      context.assertIsSatisfied();
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @Test
</span><span class='line'>  public void findByUserNameTest() {
</span><span class='line'>      final String userName = "j2ee";
</span><span class='line'>
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentRepository)
</span><span class='line'>                      .findByUserName(with(any(String.class)));
</span><span class='line'>              will(returnValue(with(any(StudentInterface.class))));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentService.findByUserName(userName);
</span><span class='line'>
</span><span class='line'>      context.assertIsSatisfied();
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @Test
</span><span class='line'>  public void findByBadUserNameTest() {
</span><span class='line'>      final String userName = "j2eee";
</span><span class='line'>      final StudentInterface studentInterface = null;
</span><span class='line'>
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentRepository)
</span><span class='line'>                      .findByUserName(with(any(String.class)));
</span><span class='line'>              will(returnValue(studentInterface));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentService.findByUserName(userName);
</span><span class='line'>      assertNull(studentInterface);
</span><span class='line'>
</span><span class='line'>      final String userName1 = "j2ee";
</span><span class='line'>      final StudentInterface studentInterface1 = context
</span><span class='line'>              .mock(StudentInterface.class);
</span><span class='line'>
</span><span class='line'>      context.checking(new Expectations() {
</span><span class='line'>          {
</span><span class='line'>              oneOf(studentRepository).findByUserName(userName1);
</span><span class='line'>              will(returnValue(studentInterface1));
</span><span class='line'>          }
</span><span class='line'>      });
</span><span class='line'>      studentService.findByUserName(userName1);
</span><span class='line'>      assertNotNull(studentInterface1);
</span><span class='line'>
</span><span class='line'>      context.assertIsSatisfied();
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>9. Running Test cases</h2>

<p>Any of the test case or test class can be run by right clicking on the name of the test case or test class and choosing &ldquo;Run As->JUnit test case&rdquo;. Each of the test case developed should be tested to give a success output (indicated by the green bar in the JUnit output)</p>

<h2>10. Code Coverage</h2>

<p>Using tools like EclEmma, code coverage for the project can be measured. To install EclEmma, choose &ldquo;Help->Eclipse Marketplace&rdquo; and search for EclEmma in the search toolbar. Install the tool using the steps on-screen.</p>

<p>Once the tool is installed, the code coverage for the project can be measured by choosing &ldquo;Coverage As->JUnit test case&rdquo; from the right click options on the project.</p>

<p>Achieving a code coverage of about or above 80% is normally preferred according to industrial standards. Not only writing unit test cases for existing code, but developing test scenarios for which code is not in place is an important step in Test Driven Development (TDD). By iteratively following the TDD approach, the stability of the code could be significantly improved.</p>

<h2>11. Clone or Download code</h2>

<p>If using git, clone a copy of this project here: <a href="https://github.com/elizabetht/StudentEnrollmentWithREST.git">https://github.com/elizabetht/StudentEnrollmentWithREST.git</a></p>

<p>In case of not using git, download the project as ZIP or tar.gz file here: <a href="https://github.com/elizabetht/StudentEnrollmentWithREST/releases/tag/1.2">https://github.com/elizabetht/StudentEnrollmentWithREST/releases/tag/1.2</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Building Java Web Application Using Jersey2 REST With Spring]]></title>
    <link href="http://blog.meygam.com//blog/2013/12/13/student-enrollment-using-jersey-rest-with-spring/"/>
    <updated>2013-12-13T10:45:30-06:00</updated>
    <id>http://blog.meygam.com//blog/2013/12/13/student-enrollment-using-jersey-rest-with-spring</id>
    <content type="html"><![CDATA[<p>This post will show how to create a Student Enrollment Application using MYSQL DB with Hibernate ORM in a REST based Jersey2 Spring environment. This is a simple application that aims to collect the input details from the user during signup, save the details in the MYSQL DB and authenticate the same during login.</p>

<!-- more -->


<h2>1. Create Java Web Application Project using Maven Template</h2>

<p>To begin with, from the command line, create a Java Maven project with the template of jersey-quickstart-webapp by providing appropriate values for GroupId, Artifact Id, Version and Package for the project.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mvn archetype:generate -DarchetypeGroupId=org.glassfish.jersey.archetypes -DarchetypeArtifactId=jersey-quickstart-webapp -DarchetypeVersion=2.4.1</span></code></pre></td></tr></table></div></figure>


<p>Import the project into the IDE using File->Import->Existing Maven Projects, select Root Directory where the Project is created (ideally the name of the Project or ArtifactId) and click on Finish. The sample web application directory structure is shown below with a standard deployment descriptor web.xml and Maven pom.xml</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jersey-layout.png" title="Jersey REST Spring Maven Project Layout" alt="Jersey REST Spring Maven Project Layout" /></p>

<h2>2. Update pom.xml</h2>

<p>To make the above Maven Java Web Application project support the Hibernate ORM and Jersey Container in Spring framework, add the following dependencies to the existing pom.xml</p>

<ul>
<li>jstl and servlet-api (for Javax Servlet Support)</li>
<li>jersey-container-servlet, jersey-media-moxy, jersey-spring3, jersey-server and jersey-mvc-jsp (for Jersey Support)</li>
<li>spring-core, spring-context, spring-web and spring-webmvc(for Spring Support)</li>
<li>junit (for JUnit Support)</li>
<li>commons-lang3 (for standard Java library support)</li>
<li>mysql-connector-java (for MYSQL support)</li>
<li>spring-jdbc (for data access with JDBC Spring)</li>
<li>spring-orm (for ORM data access with Spring)</li>
<li>spring-data-jpa (for JPA support)</li>
<li>hibernate-validator and hibernate-entitymanager (for Hibernate Support)</li>
<li>jta (for transaction support)</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;dependencies&gt;
</span><span class='line'>  &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;2.5&lt;/version&gt;
</span><span class='line'>      &lt;scope&gt;provided&lt;/scope&gt;
</span><span class='line'>  &lt;/dependency&gt;
</span><span class='line'>  &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;jstl&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;1.2&lt;/version&gt;
</span><span class='line'>  &lt;/dependency&gt;
</span><span class='line'>
</span><span class='line'>  &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.glassfish.jersey.containers&lt;/groupId&gt;
</span><span class='line'>      &lt;!-- &lt;artifactId&gt;jersey-container-servlet-core&lt;/artifactId&gt; --&gt;
</span><span class='line'>      &lt;!-- use the above artifactId if you need servlet 2.x compatibility --&gt;
</span><span class='line'>      &lt;artifactId&gt;jersey-container-servlet&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;${jersey.version}&lt;/version&gt;
</span><span class='line'>  &lt;/dependency&gt;
</span><span class='line'>  &lt;!-- uncomment this to get JSON support --&gt;
</span><span class='line'>  &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.glassfish.jersey.media&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;jersey-media-moxy&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;${jersey.version}&lt;/version&gt;
</span><span class='line'>  &lt;/dependency&gt;
</span><span class='line'>  &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.glassfish.jersey.ext&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;jersey-spring3&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;${jersey.version}&lt;/version&gt;
</span><span class='line'>  &lt;/dependency&gt;
</span><span class='line'>  &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.glassfish.jersey.core&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;jersey-server&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;${jersey.version}&lt;/version&gt;
</span><span class='line'>  &lt;/dependency&gt;
</span><span class='line'>  &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.glassfish.jersey.ext&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;jersey-mvc-jsp&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;${jersey.version}&lt;/version&gt;
</span><span class='line'>  &lt;/dependency&gt;
</span><span class='line'>
</span><span class='line'>  &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;spring-core&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;${spring.version}&lt;/version&gt;
</span><span class='line'>  &lt;/dependency&gt;
</span><span class='line'>  &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;${spring.version}&lt;/version&gt;
</span><span class='line'>  &lt;/dependency&gt;
</span><span class='line'>  &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;spring-web&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;${spring.version}&lt;/version&gt;
</span><span class='line'>  &lt;/dependency&gt;
</span><span class='line'>  &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;${spring.version}&lt;/version&gt;
</span><span class='line'>  &lt;/dependency&gt;
</span><span class='line'>  &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;${spring.version}&lt;/version&gt;
</span><span class='line'>  &lt;/dependency&gt;
</span><span class='line'>  &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;spring-orm&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;${spring.version}&lt;/version&gt;
</span><span class='line'>  &lt;/dependency&gt;
</span><span class='line'>
</span><span class='line'>  &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;junit&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;junit&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;4.11&lt;/version&gt;
</span><span class='line'>      &lt;scope&gt;test&lt;/scope&gt;
</span><span class='line'>  &lt;/dependency&gt;
</span><span class='line'>
</span><span class='line'>  &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;3.1&lt;/version&gt;
</span><span class='line'>  &lt;/dependency&gt;
</span><span class='line'>
</span><span class='line'>  &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;mysql&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;5.1.21&lt;/version&gt;
</span><span class='line'>  &lt;/dependency&gt;
</span><span class='line'>
</span><span class='line'>  &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.hibernate&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;4.2.0.Final&lt;/version&gt;
</span><span class='line'>  &lt;/dependency&gt;
</span><span class='line'>  &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.hibernate&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;hibernate-entitymanager&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;4.1.9.Final&lt;/version&gt;
</span><span class='line'>  &lt;/dependency&gt;
</span><span class='line'>  &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;javax.transaction&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;jta&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;1.1&lt;/version&gt;
</span><span class='line'>  &lt;/dependency&gt;
</span><span class='line'>
</span><span class='line'>  &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.springframework.data&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;spring-data-jpa&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;1.3.0.RELEASE&lt;/version&gt;
</span><span class='line'>      &lt;exclusions&gt;
</span><span class='line'>          &lt;exclusion&gt;
</span><span class='line'>              &lt;groupId&gt;org.springframework&lt;/groupId&gt;
</span><span class='line'>              &lt;artifactId&gt;spring-aop&lt;/artifactId&gt;
</span><span class='line'>          &lt;/exclusion&gt;
</span><span class='line'>      &lt;/exclusions&gt;
</span><span class='line'>  &lt;/dependency&gt;
</span><span class='line'>
</span><span class='line'>&lt;/dependencies&gt;
</span><span class='line'>&lt;properties&gt;
</span><span class='line'>  &lt;jersey.version&gt;2.4.1&lt;/jersey.version&gt;
</span><span class='line'>  &lt;spring.version&gt;3.2.4.RELEASE&lt;/spring.version&gt;
</span><span class='line'>  &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
</span><span class='line'>&lt;/properties&gt;</span></code></pre></td></tr></table></div></figure>


<h2>3. Modify web.xml</h2>

<p>Modify the contents of the web.xml to include the following:</p>

<ul>
<li>A Welcome file.</li>
<li>The Context Config Location.</li>
<li>A ContextLoaderLister and RequestContextListener to integrate spring with the web application.</li>
<li>A Spring Jersey Web Servlet. Specify the location of the provider packages, enable the JSON POJO Mapping Feature, provide the path where the JSP files for the project are stored to the JSP TemplateBasePath and enable the JSP MVC Feature. In this sample, a configuration file named applicationConfig.xml is created under src/main/resources folder  and the JSP files are placed under WEB-INF/jsp folder in the project layout.</li>
<li>A servlet-mapping to map the servlet created in the above step that should be invoked when the client specifies the url matching the url pattern.</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
</span><span class='line'>&lt;!-- This web.xml file is not required when using Servlet 3.0 container,
</span><span class='line'>     see implementation details http://jersey.java.net/nonav/documentation/latest/jax-rs.html --&gt;
</span><span class='line'>&lt;web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"&gt;
</span><span class='line'>
</span><span class='line'>  &lt;welcome-file-list&gt;
</span><span class='line'>      &lt;welcome-file&gt;index.jsp&lt;/welcome-file&gt;
</span><span class='line'>  &lt;/welcome-file-list&gt;
</span><span class='line'>  
</span><span class='line'>  &lt;context-param&gt;
</span><span class='line'>          &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
</span><span class='line'>      &lt;param-value&gt;classpath:applicationContext.xml&lt;/param-value&gt;
</span><span class='line'>      &lt;/context-param&gt;
</span><span class='line'>      &lt;listener&gt;
</span><span class='line'>      &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;
</span><span class='line'>      &lt;/listener&gt;
</span><span class='line'>      &lt;listener&gt;
</span><span class='line'>      &lt;listener-class&gt;org.springframework.web.context.request.RequestContextListener&lt;/listener-class&gt;
</span><span class='line'>      &lt;/listener&gt;
</span><span class='line'>  
</span><span class='line'>    &lt;servlet&gt;
</span><span class='line'>        &lt;servlet-name&gt;Spring Jersey Web Servlet&lt;/servlet-name&gt;
</span><span class='line'>        &lt;servlet-class&gt;org.glassfish.jersey.servlet.ServletContainer&lt;/servlet-class&gt;
</span><span class='line'>        &lt;init-param&gt;
</span><span class='line'>            &lt;param-name&gt;jersey.config.server.provider.packages&lt;/param-name&gt;
</span><span class='line'>            &lt;param-value&gt;com.github.elizabetht&lt;/param-value&gt;
</span><span class='line'>        &lt;/init-param&gt;
</span><span class='line'>        &lt;init-param&gt;
</span><span class='line'>              &lt;param-name&gt;com.sun.jersey.api.json.POJOMappingFeature&lt;/param-name&gt;
</span><span class='line'>              &lt;param-value&gt;true&lt;/param-value&gt;
</span><span class='line'>      &lt;/init-param&gt;
</span><span class='line'>      &lt;init-param&gt;
</span><span class='line'>          &lt;param-name&gt;jersey.config.server.mvc.templateBasePath.jsp&lt;/param-name&gt;
</span><span class='line'>          &lt;param-value&gt;/WEB-INF/jsp&lt;/param-value&gt;
</span><span class='line'>      &lt;/init-param&gt;
</span><span class='line'>      &lt;init-param&gt;
</span><span class='line'>          &lt;param-name&gt;jersey.config.server.provider.classnames&lt;/param-name&gt;
</span><span class='line'>          &lt;param-value&gt;org.glassfish.jersey.server.mvc.jsp.JspMvcFeature&lt;/param-value&gt;
</span><span class='line'>      &lt;/init-param&gt;
</span><span class='line'>        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
</span><span class='line'>    &lt;/servlet&gt;
</span><span class='line'>    &lt;servlet-mapping&gt;
</span><span class='line'>        &lt;servlet-name&gt;Spring Jersey Web Servlet&lt;/servlet-name&gt;
</span><span class='line'>        &lt;url-pattern&gt;/webapi/*&lt;/url-pattern&gt;
</span><span class='line'>    &lt;/servlet-mapping&gt;
</span><span class='line'>&lt;/web-app&gt;</span></code></pre></td></tr></table></div></figure>


<h2>4. Create persistence.xml</h2>

<p>Create a file named persistence.xml under the folder src/main/resources/META-INF folder in the project to define the persistence unit required by JPA. Add the following to the persistence.xml to define a persistence unit named punit.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;persistence xmlns="http://java.sun.com/xml/ns/persistence"
</span><span class='line'>  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
</span><span class='line'>  xsi:schemaLocation="{http://java.sun.com/xml/ns/persistence} {http://java.sun.com/xml/ns/persistence_2_0.xsd}"
</span><span class='line'>  version="2.0"&gt;
</span><span class='line'>  
</span><span class='line'>  &lt;persistence-unit name="punit"&gt;
</span><span class='line'>  &lt;/persistence-unit&gt;
</span><span class='line'>  
</span><span class='line'>&lt;/persistence&gt;</span></code></pre></td></tr></table></div></figure>


<h2>5. Create the Spring Configuration File</h2>

<p>As defined in the web.xml, create a file named applicationContext.xml under the folder src/main/resources folder in the project to define JPA and Hibernate related configurations. Note that any file created under src/main/resources folder in a maven project will be automagically added by Maven to the classpath. If STS(Spring Tool Suite) is the IDE, go ahead and enable the context, jpa, mvc and tx namespaces. The applicationContext.xml will be as shown below</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
</span><span class='line'>&lt;beans xmlns="http://www.springframework.org/schema/beans"
</span><span class='line'>  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
</span><span class='line'>  xmlns:jpa="http://www.springframework.org/schema/data/jpa"
</span><span class='line'>  xmlns:tx="http://www.springframework.org/schema/tx"
</span><span class='line'>  xmlns:context="http://www.springframework.org/schema/context"
</span><span class='line'>  xmlns:mvc="http://www.springframework.org/schema/mvc"
</span><span class='line'>  xsi:schemaLocation="http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.2.xsd
</span><span class='line'>      http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
</span><span class='line'>      http://www.springframework.org/schema/data/jpa http://www.springframework.org/schema/data/jpa/spring-jpa-1.3.xsd
</span><span class='line'>      http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.2.xsd
</span><span class='line'>      http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.2.xsd"&gt;
</span><span class='line'>      
</span><span class='line'>&lt;/beans&gt;</span></code></pre></td></tr></table></div></figure>


<p>After enabling the required namespaces, include the following (in between the &lt;beans&gt; and &lt;/beans&gt; tags) to indicate that the application is annotation driven, base package for context component scan and base package for the jpa repositories scan.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;mvc:annotation-driven /&gt;
</span><span class='line'>          
</span><span class='line'>&lt;context:annotation-config /&gt;
</span><span class='line'>&lt;context:component-scan base-package="com.github.elizabetht" /&gt;
</span><span class='line'>  
</span><span class='line'>&lt;jpa:repositories base-package="com.github.elizabetht.repository" /&gt;
</span></code></pre></td></tr></table></div></figure>


<p>Next, include the bean PersistenceAnnotationBeanPostProcessor. This is necessary to process the Persistence Unit, Persistence Context annotations and for injecting JPA related resources.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;bean class="org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor" /&gt;</span></code></pre></td></tr></table></div></figure>


<p>Include the bean for EntityManagerFactory which lists the various JPA related properties/resources.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean"&gt;
</span><span class='line'>      &lt;property name="persistenceUnitName" value="punit" /&gt;
</span><span class='line'>      &lt;property name="dataSource" ref="dataSource" /&gt;
</span><span class='line'>      &lt;property name="jpaVendorAdapter"&gt;
</span><span class='line'>          &lt;bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter"&gt;
</span><span class='line'>              &lt;property name="showSql" value="true" /&gt;
</span><span class='line'>          &lt;/bean&gt;
</span><span class='line'>      &lt;/property&gt;
</span><span class='line'>      &lt;property name="jpaPropertyMap"&gt;
</span><span class='line'>          &lt;map&gt;
</span><span class='line'>              &lt;entry key="hibernate.dialect" value="org.hibernate.dialect.MySQL5InnoDBDialect" /&gt;
</span><span class='line'>              &lt;entry key="hibernate.hbm2ddl.auto" value="validate" /&gt;
</span><span class='line'>              &lt;entry key="hibernate.format_sql" value="true" /&gt;
</span><span class='line'>          &lt;/map&gt;
</span><span class='line'>      &lt;/property&gt;
</span><span class='line'>  &lt;/bean&gt;</span></code></pre></td></tr></table></div></figure>


<p>Include the bean for data source, where the properties of the MYSQL DB like url, username and password can be specified. Replace &lt;include connection url&gt; with the actual connection url for connecting to the MYSQL DB. Likewise, replace &lt;include username&gt; and &lt;include password&gt; with the actual username and password values.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource"&gt;
</span><span class='line'>      &lt;property name="driverClassName" value="com.mysql.jdbc.Driver" /&gt;
</span><span class='line'>      &lt;property name="url" value="jdbc:mysql//&lt;include connection url&gt;:3306/studentEnrollment?autoReconnect=true&amp;createDatabaseIfNotExist=true&amp;" /&gt;
</span><span class='line'>      &lt;property name="username" value="&lt;include username&gt;" /&gt;
</span><span class='line'>      &lt;property name="password" value="&lt;include password&gt;" /&gt;
</span><span class='line'>&lt;/bean&gt;</span></code></pre></td></tr></table></div></figure>


<p>Include the bean for transaction manager for scoping/controlling the transactions.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager"&gt;
</span><span class='line'>      &lt;property name="entityManagerFactory" ref="entityManagerFactory" /&gt;
</span><span class='line'>&lt;/bean&gt;
</span><span class='line'>  
</span><span class='line'>&lt;tx:annotation-driven transaction-manager="transactionManager" /&gt;</span></code></pre></td></tr></table></div></figure>


<p>Thus ends the long configuration in applicationContext.xml</p>

<h2>6. Create JSP Files for Student Signup/Login</h2>

<p>Create a folder named &ldquo;jsp&rdquo; under WEB-INF (This is where the jsp files will be created as indicated in the web.xml for the JSP TemplateBasePath).</p>

<p>Create a file signup.jsp to include a form to get the input details like UserName, Password, FirstName, LastName, DateOfBirth and EmailAddress of the student. A snapshot of the signup page is as follows:</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/signup.png" title="Jersey REST Spring Hibernate Signup Layout" alt="Jersey REST Spring Hibernate Signup Layout" /></p>

<p>Next, create a file login.jsp to include a form with UserName and Password. A snapshot of the login page is as follows:</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/login.png" title="Jersey REST Spring Hibernate Login Layout" alt="Jersey REST Spring Hibernate Login Layout" /></p>

<p>Also create success.jsp to indicate the login success and failure.jsp to indicate login failure (These are just pages used to display the contents - no processing logic involved).</p>

<p>This application uses twitter bootstrap <a href="http://getbootstrap.com/">http://getbootstrap.com/</a> and <a href="http://bootswatch.com/united/">http://bootswatch.com/united/</a> as style sheets. It also uses a datepicker stylesheet as well to pop up a calendar for the DateOfBirth field in the Student Signup page (<a href="http://www.eyecon.ro/bootstrap-datepicker/">http://www.eyecon.ro/bootstrap-datepicker/</a>).</p>

<p>A reference link to the files under webapp folder of this application can be found at <a href="https://github.com/elizabetht/StudentEnrollmentWithREST/tree/master/src/main/webapp">https://github.com/elizabetht/StudentEnrollmentWithREST/tree/master/src/main/webapp</a></p>

<h2>7. Create packages for Resource, Service, Repository and Model tier classes</h2>

<p>Create packages each for the Jersey Resource, Service, Repository and Model classes under the src/main/java folder.</p>

<p>A sample snapshot of the project after the package creation is as shown below:</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jersey-package.png" title="Jersey REST Spring Package Layout" alt="Jersey REST Spring Package Layout" /></p>

<h2>8. Create classes for Model Tier</h2>

<p>Create a POJO class named Student.java inside the package com.github.elizabetht.model to include the details of the Student model entity during signup. Create another POJO class named StudentLogin.java inside the same package com.github.elizabetht.model to include the Student Login details.</p>

<p>Annotate the classes with @Component to be picked by the Context-Component Scan of the Jersey-Spring framework. Also annotate the classes with @XmlRootElement to indicate the XML Element.</p>

<p>A reference link to the files for the Model classes can be found at <a href="https://github.com/elizabetht/StudentEnrollmentWithREST/tree/master/src/main/java/com/github/elizabetht/model">https://github.com/elizabetht/StudentEnrollmentWithREST/tree/master/src/main/java/com/github/elizabetht/model</a></p>

<h2>9. Create class for Repository Tier</h2>

<p>Create an interface class named StudentRepository.java inside the package com.github.elizabetht.repository to support the repository tier database operations.</p>

<p>There are two interface methods needed for the application&rsquo;s purpose.</p>

<ul>
<li>To Insert the Student Signup details into the Database</li>
<li>To Verify the Student Login details from the Database</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>@Repository("studentRepository")
</span><span class='line'>public interface StudentRepository extends JpaRepository&lt;Student, Long&gt; {
</span><span class='line'>  
</span><span class='line'>  @Query("select s from Student s where s.userName = :userName")
</span><span class='line'>  Student findByUserName(@Param("userName") String userName);
</span><span class='line'>  
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>The save() method is supported by the Hibernate implementation and hence no separate SQL statements are required for the data insert.</p>

<h2>10. Create classes for Service Tier</h2>

<p>Create an interface class named StudentService.java inside the package com.github.elizabetht.service to support the service tier operations.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public interface StudentService {
</span><span class='line'>  Student save(Student student);
</span><span class='line'>  boolean findByLogin(String userName, String password);
</span><span class='line'>  boolean findByUserName(String userName);
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Create a service tier implementation class (a POJO indeed) named StudentServiceImpl.java inside the package com.github.elizabetht.service. This is where the application logic goes - either to save the student details into the database or to verify the student (already saved) details from the database.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>@Service("studentService")
</span><span class='line'>public class StudentServiceImpl implements StudentService {
</span><span class='line'>
</span><span class='line'>  @Autowired
</span><span class='line'>  private StudentRepository studentRepository;
</span><span class='line'>  
</span><span class='line'>  @Transactional
</span><span class='line'>  public Student save(Student student) {
</span><span class='line'>      return studentRepository.save(student);
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public boolean findByLogin(String userName, String password) {  
</span><span class='line'>      Student stud = studentRepository.findByUserName(userName);
</span><span class='line'>      
</span><span class='line'>      if(stud != null && stud.getPassword().equals(password)) {
</span><span class='line'>          return true;
</span><span class='line'>      } 
</span><span class='line'>      
</span><span class='line'>      return false;       
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public boolean findByUserName(String userName) {
</span><span class='line'>      Student stud = studentRepository.findByUserName(userName);
</span><span class='line'>      
</span><span class='line'>      if(stud != null) {
</span><span class='line'>          return true;
</span><span class='line'>      }
</span><span class='line'>      
</span><span class='line'>      return false;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>11. Create class for Resource Tier</h2>

<p>Create a Resource tier POJO class named StudentResource.java inside the package com.github.elizabetht.resource. This is where a REST API is implemented for each of the operation performed from the front end.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>@Component
</span><span class='line'>@Path("studentResource")
</span><span class='line'>@XmlRootElement
</span><span class='line'>public class StudentResource {
</span><span class='line'>
</span><span class='line'>  @Autowired
</span><span class='line'>  private StudentService studentService;
</span><span class='line'>
</span><span class='line'>  @GET
</span><span class='line'>  @Path("signup")
</span><span class='line'>  @Produces(MediaType.TEXT_HTML)
</span><span class='line'>  public Response signup() {
</span><span class='line'>      return Response.ok(new Viewable("/signup")).build();
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @POST
</span><span class='line'>  @Path("signup")
</span><span class='line'>  @Consumes(MediaType.APPLICATION_FORM_URLENCODED)
</span><span class='line'>  @Produces(MediaType.TEXT_HTML)
</span><span class='line'>  public Response signup(@FormParam("userName") String userName,
</span><span class='line'>          @FormParam("password") String password,
</span><span class='line'>          @FormParam("firstName") String firstName,
</span><span class='line'>          @FormParam("lastName") String lastName,
</span><span class='line'>          @FormParam("dateOfBirth") String dateOfBirth,
</span><span class='line'>          @FormParam("emailAddress") String emailAddress)
</span><span class='line'>          throws ParseException {
</span><span class='line'>
</span><span class='line'>      if (userName == null || password == null || firstName == null
</span><span class='line'>              || lastName == null || dateOfBirth == null
</span><span class='line'>              || emailAddress == null) {
</span><span class='line'>          return Response.status(Status.PRECONDITION_FAILED).build();
</span><span class='line'>      }
</span><span class='line'>
</span><span class='line'>      Student student = new Student();
</span><span class='line'>      student.setUserName(userName);
</span><span class='line'>      student.setPassword(password);
</span><span class='line'>      student.setFirstName(firstName);
</span><span class='line'>      student.setLastName(lastName);
</span><span class='line'>
</span><span class='line'>      student.setDateOfBirth(new java.sql.Date(new SimpleDateFormat(
</span><span class='line'>              "MM/dd/yyyy").parse(dateOfBirth.substring(0, 10)).getTime()));
</span><span class='line'>
</span><span class='line'>      student.setEmailAddress(emailAddress);
</span><span class='line'>
</span><span class='line'>      if (studentService.findByUserName(userName)) {
</span><span class='line'>          Map&lt;String, Object&gt; map = new HashMap&lt;String, Object&gt;();
</span><span class='line'>          map.put("message", "User Name exists. Try another user name");
</span><span class='line'>          map.put("student", student);
</span><span class='line'>          return Response.status(Status.BAD_REQUEST)
</span><span class='line'>                  .entity(new Viewable("/signup", map)).build();
</span><span class='line'>      } else {
</span><span class='line'>          studentService.save(student);
</span><span class='line'>          return Response.ok().entity(new Viewable("/login")).build();
</span><span class='line'>      }
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @GET
</span><span class='line'>  @Path("login")
</span><span class='line'>  @Produces(MediaType.TEXT_HTML)
</span><span class='line'>  public Response login() {
</span><span class='line'>      return Response.ok(new Viewable("/login")).build();
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @POST
</span><span class='line'>  @Path("login")
</span><span class='line'>  @Consumes(MediaType.APPLICATION_FORM_URLENCODED)
</span><span class='line'>  @Produces(MediaType.TEXT_HTML)
</span><span class='line'>  public Response login(@FormParam("userName") String userName,
</span><span class='line'>          @FormParam("password") String password) {
</span><span class='line'>
</span><span class='line'>      if (userName == null || password == null) {
</span><span class='line'>          return Response.status(Status.PRECONDITION_FAILED).build();
</span><span class='line'>      }
</span><span class='line'>
</span><span class='line'>      boolean found = studentService.findByLogin(userName, password);
</span><span class='line'>      if (found) {
</span><span class='line'>          return Response.ok().entity(new Viewable("/success")).build();
</span><span class='line'>      } else {
</span><span class='line'>          return Response.status(Status.BAD_REQUEST)
</span><span class='line'>                  .entity(new Viewable("/failure")).build();
</span><span class='line'>      }
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>12. Create the DB Schema in a MYSQL DB</h2>

<p>Connect to the MySQL DB which is to be used for this application and create a new DB Schema named studentEnrollment using the MySQL Workbench.
This is necessary as the DB Schema name of studentEnrollment is specified in the dataSource bean in applicationContext.xml</p>

<p>Once the studentEnrollment DB Schema is created, create a table named student inside the DB Schema using the CREATE TABLE statement as follows:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>CREATE TABLE `student` (
</span><span class='line'>  `id` bigint(20) NOT NULL AUTO_INCREMENT,
</span><span class='line'>  `dateOfBirth` datetime NOT NULL,
</span><span class='line'>  `emailAddress` varchar(255) NOT NULL,
</span><span class='line'>  `firstName` varchar(255) NOT NULL,
</span><span class='line'>  `lastName` varchar(255) NOT NULL,
</span><span class='line'>  `password` varchar(8) NOT NULL,
</span><span class='line'>  `userName` varchar(20) NOT NULL,
</span><span class='line'>  PRIMARY KEY (`id`)
</span><span class='line'>) ENGINE=InnoDB AUTO_INCREMENT=43 DEFAULT CHARSET=latin1;</span></code></pre></td></tr></table></div></figure>


<h2>13. Deploying the Application on Tomcat Server</h2>

<p>Once the above steps are complete and the project is successfully built, the Java web application is ready to deployed on the Tomcat Server 7.</p>

<p>The Java web application can be deployed locally by right clicking on the project and choosing the &ldquo;Run As->Run on Server&rdquo; option.</p>

<p>The same can be deployed remotely on any native server that supports Tomcat by copying the WAR file (Right click on the project and choose Export as WAR File option) to /var/lib/tomcat7 folder (or appropriate tomcat directory) and restarting the tomcat server.</p>

<h2>14. Clone or Download code</h2>

<p>If using git, clone a copy of this project here: <a href="https://github.com/elizabetht/StudentEnrollmentWithREST.git">https://github.com/elizabetht/StudentEnrollmentWithREST.git</a></p>

<p>In case of not using git, download the project as ZIP or tar.gz file here: <a href="https://github.com/elizabetht/StudentEnrollmentWithREST/releases/tag/1.1">https://github.com/elizabetht/StudentEnrollmentWithREST/releases/tag/1.1</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Building Java Web Application Using JDBC]]></title>
    <link href="http://blog.meygam.com//blog/2013/11/21/student-enrollment-using-jdbc/"/>
    <updated>2013-11-21T09:41:55-06:00</updated>
    <id>http://blog.meygam.com//blog/2013/11/21/student-enrollment-using-jdbc</id>
    <content type="html"><![CDATA[<p>This post will show how to create a Student Enrollment Application using MYSQL DB with JDBC. This is a simple application that aims to collect the input details from the user during signup, save the details in the MYSQL DB and authenticate the same during login.</p>

<!-- more -->


<h2>1. Create Java Web Application Project</h2>

<p>To begin with, in the IDE, create a Java Dynamic Web project for the application. While creating the dynamic web project, enable the checkbox to generate web.xml deployment descriptor.</p>

<p>The sample web application directory structure is shown below with a standard deployment descriptor web.xml</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jdbclayout.png" title="JDBC Dynamic Web Project Layout" alt="JDBC Dynamic Web Project Layout" /></p>

<h2>2. Modify web.xml</h2>

<p>Modify the contents of the web.xml to include the following:</p>

<ul>
<li>A servlet and the corresponding class in the source folder that would handle the HTTP requests.</li>
<li>A servlet-mapping to map the servlet created in the above step that should be invoked when the client specifies the url matching the url pattern.</li>
<li>A welcome file list, which can be used optionally to include the welcome file for the application.</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
</span><span class='line'>&lt;web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" id="WebApp_ID" version="3.0"&gt;
</span><span class='line'>  &lt;display-name&gt;StudentEnrollmentWithJDBC&lt;/display-name&gt;
</span><span class='line'>  
</span><span class='line'>  &lt;welcome-file-list&gt;
</span><span class='line'>    &lt;welcome-file&gt;index.jsp&lt;/welcome-file&gt;
</span><span class='line'>  &lt;/welcome-file-list&gt;
</span><span class='line'>  
</span><span class='line'>  &lt;servlet&gt;
</span><span class='line'>      &lt;servlet-name&gt;studentJDBCServlet&lt;/servlet-name&gt;
</span><span class='line'>      &lt;servlet-class&gt;com.github.elizabetht.controller.StudentController&lt;/servlet-class&gt;
</span><span class='line'>  &lt;/servlet&gt;
</span><span class='line'>  
</span><span class='line'>  &lt;servlet-mapping&gt;
</span><span class='line'>      &lt;servlet-name&gt;studentJDBCServlet&lt;/servlet-name&gt;
</span><span class='line'>      &lt;url-pattern&gt;/StudentController&lt;/url-pattern&gt;
</span><span class='line'>  &lt;/servlet-mapping&gt;
</span><span class='line'>&lt;/web-app&gt;</span></code></pre></td></tr></table></div></figure>


<h2>3. Add JARs to the project</h2>

<p>Add the following JARs from the web (or their latest equivalent) to the WEB-INF/lib folder under WebContent directory in the project.</p>

<ul>
<li>mysql-connector-java-5.1.26-bin.jar (for MYSQL data access support)</li>
<li>jstl.jar and standard.jar (for JSTL Expression language support)</li>
<li>ojdbc5.jar (for Oracle JDBC Driver support)</li>
</ul>


<p>The sample lib folder structure is shown below with the necessary JARs added for the project.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jdbcliblayout.png" title="JDBC Library Layout" alt="JDBC Library Layout" /></p>

<h2>4. Create JSP Files for Student Signup/Login</h2>

<p>Create a folder named &ldquo;content&rdquo; under WebContent (This is where the jsp files will be created).</p>

<p>Create a file signup.jsp to include a form to get the input details like UserName, Password, FirstName, LastName, DateOfBirth and EmailAddress of the student. A snapshot of the signup page is as follows:</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/signup.png" title="JDBC Signup Layout" alt="JDBC Signup Layout" /></p>

<p>Next, create a file login.jsp to include a form with UserName and Password. A snapshot of the login page is as follows:</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/login.png" title="JDBC Login Layout" alt="JDBC Login Layout" /></p>

<p>The main actions for this application are as follows:</p>

<ul>
<li>Signup (To Insert the Student Signup details into the Database)</li>
<li>Login (To Verify the Student Login details from the Database)</li>
</ul>


<p>In order to display a success (result) page after the login action is complete, create a success.jsp page to indicate the login success. Similarly, to indicate a login failure (result), create a page failure.jsp. These are just pages used to display the contents - no processing logic involved.</p>

<p>This application uses twitter bootstrap <a href="http://getbootstrap.com/">http://getbootstrap.com/</a> and <a href="http://bootswatch.com/united/">http://bootswatch.com/united/</a> as style sheets. It also uses a datepicker stylesheet as well to pop up a calendar for the DateOfBirth field in the Student Signup page (<a href="http://www.eyecon.ro/bootstrap-datepicker/">http://www.eyecon.ro/bootstrap-datepicker/</a>).</p>

<p>A reference link to the files under WebContent folder of this application can be found at <a href="https://github.com/elizabetht/StudentEnrollmentWithJDBC/tree/master/WebContent">https://github.com/elizabetht/StudentEnrollmentWithJDBC/tree/master/WebContent</a></p>

<h2>5. Create packages</h2>

<p>Create packages each for the Controller, Repository and Model tiers under the src folder.
Also create package for the utilities class under the src folder.</p>

<p>A sample snapshot of the project after the package creation is as shown below:</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/jdbc-package.png" title="JDBC Package Layout" alt="JDBC Package Layout" /></p>

<h2>6. Create class for Model Tier</h2>

<p>Create a POJO class named Student.java inside the package com.github.elizabetht.model to include the details of the Student model entity.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public class Student {
</span><span class='line'>  private String userName;
</span><span class='line'>  private String firstName;
</span><span class='line'>  private String lastName;
</span><span class='line'>  private String password;
</span><span class='line'>  private String emailAddress;
</span><span class='line'>  private Date dateOfBirth;
</span><span class='line'>
</span><span class='line'>  public String getUserName() {
</span><span class='line'>      return userName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public void setUserName(String userName) {
</span><span class='line'>      this.userName = userName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public String getFirstName() {
</span><span class='line'>      return firstName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public void setFirstName(String firstName) {
</span><span class='line'>      this.firstName = firstName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public String getLastName() {
</span><span class='line'>      return lastName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public void setLastName(String lastName) {
</span><span class='line'>      this.lastName = lastName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public String getPassword() {
</span><span class='line'>      return password;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public void setPassword(String password) {
</span><span class='line'>      this.password = password;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public String getEmailAddress() {
</span><span class='line'>      return emailAddress;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public void setEmailAddress(String emailAddress) {
</span><span class='line'>      this.emailAddress = emailAddress;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public Date getDateOfBirth() {
</span><span class='line'>      return dateOfBirth;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public void setDateOfBirth(Date dateOfBirth) {
</span><span class='line'>      this.dateOfBirth = dateOfBirth;
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>7. Create db.properties file</h2>

<p>Create a file named db.properties under the src folder, where the properties of the MYSQL DB like url, username and password can be specified. Replace &lt;include connection url&gt; with the actual connection url for connecting to the MYSQL DB. Likewise, replace &lt;include username&gt; and &lt;include password&gt; with the actual username and password values.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>dbDriver=com.mysql.jdbc.Driver
</span><span class='line'>connectionUrl=jdbc:mysql://&lt;include connection url&gt;:3306/studentEnrollment
</span><span class='line'>userName=&lt;include username&gt;
</span><span class='line'>password=&lt;include password&gt;</span></code></pre></td></tr></table></div></figure>


<h2>8. Create utility class </h2>

<p>Create a POJO class named DbUtil.java under the package com.github.elizabetht.util to include a helper class functionality that would load the db.properties file and get the database connection.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public class DbUtil {
</span><span class='line'>  private static Connection dbConnection = null;
</span><span class='line'>
</span><span class='line'>  public static Connection getConnection() {
</span><span class='line'>      if (dbConnection != null) {
</span><span class='line'>          return dbConnection;
</span><span class='line'>      } else {
</span><span class='line'>          try {
</span><span class='line'>              InputStream inputStream = DbUtil.class.getClassLoader()
</span><span class='line'>                      .getResourceAsStream("db.properties");
</span><span class='line'>              Properties properties = new Properties();
</span><span class='line'>              if (properties != null) {
</span><span class='line'>                  properties.load(inputStream);
</span><span class='line'>
</span><span class='line'>                  String dbDriver = properties.getProperty("dbDriver");
</span><span class='line'>                  String connectionUrl = properties
</span><span class='line'>                          .getProperty("connectionUrl");
</span><span class='line'>                  String userName = properties.getProperty("userName");
</span><span class='line'>                  String password = properties.getProperty("password");
</span><span class='line'>
</span><span class='line'>                  Class.forName(dbDriver).newInstance();
</span><span class='line'>                  dbConnection = DriverManager.getConnection(connectionUrl,
</span><span class='line'>                          userName, password);
</span><span class='line'>              }
</span><span class='line'>          } catch (Exception e) {
</span><span class='line'>              e.printStackTrace();
</span><span class='line'>          }
</span><span class='line'>          return dbConnection;
</span><span class='line'>      }
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>9. Create class for Repository tier</h2>

<p>Create a Repository tier POJO class named StudentRepository.java under the package com.github.elizabetht.repository to support the database operations of saving the student details, verifying the student login details and checking if the username exists when a save is attempted.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public class StudentRepository {
</span><span class='line'>  private Connection dbConnection;
</span><span class='line'>  
</span><span class='line'>  public StudentRepository() {
</span><span class='line'>      dbConnection = DbUtil.getConnection();
</span><span class='line'>  }
</span><span class='line'>  
</span><span class='line'>  public void save(String userName, String password, String firstName, String lastName, String dateOfBirth, String emailAddress) {
</span><span class='line'>      try {
</span><span class='line'>          PreparedStatement prepStatement = dbConnection.prepareStatement("insert into student(userName, password, firstName, lastName, dateOfBirth, emailAddress) values (?, ?, ?, ?, ?, ?)");
</span><span class='line'>          prepStatement.setString(1, userName);
</span><span class='line'>          prepStatement.setString(2, password);
</span><span class='line'>          prepStatement.setString(3, firstName);
</span><span class='line'>          prepStatement.setString(4, lastName);
</span><span class='line'>          prepStatement.setDate(5, new java.sql.Date(new SimpleDateFormat("MM/dd/yyyy")
</span><span class='line'>          .parse(dateOfBirth.substring(0, 10)).getTime()));
</span><span class='line'>          prepStatement.setString(6, emailAddress);
</span><span class='line'>          
</span><span class='line'>          prepStatement.executeUpdate();
</span><span class='line'>      } catch (SQLException e) {
</span><span class='line'>          e.printStackTrace();
</span><span class='line'>      } catch (ParseException e) {            
</span><span class='line'>          e.printStackTrace();
</span><span class='line'>      }
</span><span class='line'>  }
</span><span class='line'>  
</span><span class='line'>  public boolean findByUserName(String userName) {
</span><span class='line'>      try {
</span><span class='line'>          PreparedStatement prepStatement = dbConnection.prepareStatement("select count(*) from student where userName = ?");
</span><span class='line'>          prepStatement.setString(1, userName);   
</span><span class='line'>                      
</span><span class='line'>          ResultSet result = prepStatement.executeQuery();
</span><span class='line'>          if (result != null) {   
</span><span class='line'>              while (result.next()) {
</span><span class='line'>                  if (result.getInt(1) == 1) {
</span><span class='line'>                      return true;
</span><span class='line'>                  }               
</span><span class='line'>              }
</span><span class='line'>          }
</span><span class='line'>      } catch (Exception e) {
</span><span class='line'>          e.printStackTrace();
</span><span class='line'>      }
</span><span class='line'>      return false;
</span><span class='line'>  }
</span><span class='line'>  
</span><span class='line'>  public boolean findByLogin(String userName, String password) {
</span><span class='line'>      try {
</span><span class='line'>          PreparedStatement prepStatement = dbConnection.prepareStatement("select password from student where userName = ?");
</span><span class='line'>          prepStatement.setString(1, userName);           
</span><span class='line'>          
</span><span class='line'>          ResultSet result = prepStatement.executeQuery();
</span><span class='line'>          if (result != null) {
</span><span class='line'>              while (result.next()) {
</span><span class='line'>                  if (result.getString(1).equals(password)) {
</span><span class='line'>                      return true;
</span><span class='line'>                  }
</span><span class='line'>              }               
</span><span class='line'>          }           
</span><span class='line'>      } catch (Exception e) {
</span><span class='line'>          e.printStackTrace();
</span><span class='line'>      }
</span><span class='line'>      return false;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>10. Create class for Controller Tier</h2>

<p>Create a Controller tier POJO class named StudentController.java inside the package com.github.elizabetht.controller. This is where the servicing logic of the application goes - whether a signup or login action is called.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>@SuppressWarnings("serial")
</span><span class='line'>public class StudentController extends HttpServlet {
</span><span class='line'>  private StudentRepository studentRepository;
</span><span class='line'>
</span><span class='line'>  private static String STUDENT_SIGNUP = "content/signup.jsp";
</span><span class='line'>  private static String STUDENT_LOGIN = "content/login.jsp";
</span><span class='line'>  private static String LOGIN_SUCCESS = "content/success.jsp";
</span><span class='line'>  private static String LOGIN_FAILURE = "content/failure.jsp";
</span><span class='line'>
</span><span class='line'>  /**
</span><span class='line'>   * @see HttpServlet#HttpServlet()
</span><span class='line'>   */
</span><span class='line'>  public StudentController() {
</span><span class='line'>      super();
</span><span class='line'>      studentRepository = new StudentRepository();
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  /**
</span><span class='line'>   * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse
</span><span class='line'>   *      response)
</span><span class='line'>   */
</span><span class='line'>  protected void doGet(HttpServletRequest request,
</span><span class='line'>          HttpServletResponse response) throws ServletException, IOException {    
</span><span class='line'>      String forward = STUDENT_SIGNUP;
</span><span class='line'>      RequestDispatcher view = request.getRequestDispatcher(forward);
</span><span class='line'>      view.forward(request, response);
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  /**
</span><span class='line'>   * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse
</span><span class='line'>   *      response)
</span><span class='line'>   */
</span><span class='line'>  protected void doPost(HttpServletRequest request,
</span><span class='line'>          HttpServletResponse response) throws ServletException, IOException {
</span><span class='line'>      String pageName = request.getParameter("pageName");
</span><span class='line'>      String forward = "";        
</span><span class='line'>      
</span><span class='line'>      if (studentRepository != null) {
</span><span class='line'>          if (pageName.equals("signup")) {
</span><span class='line'>              if (studentRepository.findByUserName(request
</span><span class='line'>                      .getParameter("userName"))) {
</span><span class='line'>                  request.setAttribute("message", "User Name exists. Try another user name");
</span><span class='line'>                  forward = STUDENT_SIGNUP;
</span><span class='line'>                  RequestDispatcher view = request
</span><span class='line'>                          .getRequestDispatcher(forward);
</span><span class='line'>                  view.forward(request, response);
</span><span class='line'>                  return;
</span><span class='line'>              }
</span><span class='line'>
</span><span class='line'>              studentRepository.save(request.getParameter("userName"),
</span><span class='line'>                      request.getParameter("password"),
</span><span class='line'>                      request.getParameter("firstName"),
</span><span class='line'>                      request.getParameter("lastName"),
</span><span class='line'>                      request.getParameter("dateOfBirth"),
</span><span class='line'>                      request.getParameter("emailAddress"));
</span><span class='line'>              forward = STUDENT_LOGIN;
</span><span class='line'>          } else if (pageName.equals("login")) {
</span><span class='line'>              boolean result = studentRepository.findByLogin(
</span><span class='line'>                      request.getParameter("userName"),
</span><span class='line'>                      request.getParameter("password"));
</span><span class='line'>              if (result == true) {
</span><span class='line'>                  forward = LOGIN_SUCCESS;
</span><span class='line'>              } else {
</span><span class='line'>                  forward = LOGIN_FAILURE;
</span><span class='line'>              }
</span><span class='line'>          }
</span><span class='line'>      }
</span><span class='line'>      RequestDispatcher view = request.getRequestDispatcher(forward);
</span><span class='line'>      view.forward(request, response);
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>11. Create the DB Schema in a MYSQL DB</h2>

<p>Connect to the MySQL DB which is to be used for this application and create a new DB Schema named studentEnrollment using the MySQL Workbench.
This is necessary as the DB Schema name of studentEnrollment is specified in the db.properties file.</p>

<p>Once the studentEnrollment DB Schema is created, create a table named student inside the DB Schema using the CREATE TABLE statement as follows:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>CREATE TABLE `student` (
</span><span class='line'>  `id` bigint(20) NOT NULL AUTO_INCREMENT,
</span><span class='line'>  `dateOfBirth` datetime NOT NULL,
</span><span class='line'>  `emailAddress` varchar(255) NOT NULL,
</span><span class='line'>  `firstName` varchar(255) NOT NULL,
</span><span class='line'>  `lastName` varchar(255) NOT NULL,
</span><span class='line'>  `password` varchar(8) NOT NULL,
</span><span class='line'>  `userName` varchar(20) NOT NULL,
</span><span class='line'>  PRIMARY KEY (`id`)
</span><span class='line'>) ENGINE=InnoDB AUTO_INCREMENT=43 DEFAULT CHARSET=latin1;</span></code></pre></td></tr></table></div></figure>


<h2>12. Deploying the Application on Tomcat Server</h2>

<p>Once the above steps are complete and the project is successfully built, the Java web application is ready to deployed on the Tomcat Server 7.</p>

<p>The Java web application can be deployed locally by right clicking on the project and choosing the &ldquo;Run As->Run on Server&rdquo; option.</p>

<p>The same can be deployed remotely on any native server that supports Tomcat by copying the WAR file (Right click on the project and choose Export as WAR File option) to /var/lib/tomcat7 folder (or appropriate tomcat directory) and restarting the tomcat server.</p>

<h2>13. Clone or Download code</h2>

<p>If using git, clone a copy of this project here: <a href="https://github.com/elizabetht/StudentEnrollmentWithJDBC.git">https://github.com/elizabetht/StudentEnrollmentWithJDBC.git</a></p>

<p>In case of not using git, download the project as ZIP or tar.gz file here: <a href="https://github.com/elizabetht/StudentEnrollmentWithJDBC/releases/tag/1.2">https://github.com/elizabetht/StudentEnrollmentWithJDBC/releases/tag/1.2</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Building Java Web Application Using Struts 2]]></title>
    <link href="http://blog.meygam.com//blog/2013/11/21/student-enrollment-using-struts-2/"/>
    <updated>2013-11-21T09:41:45-06:00</updated>
    <id>http://blog.meygam.com//blog/2013/11/21/student-enrollment-using-struts-2</id>
    <content type="html"><![CDATA[<p>This post will show how to create a Student Enrollment Application using MYSQL DB with Struts 2 framework. This is a simple application that aims to collect the input details from the user during signup, save the details in the MYSQL DB and authenticate the same during login.</p>

<!-- more -->


<h2>1. Create Java Web Application Project</h2>

<p>To begin with, in the IDE, create a Java Dynamic Web project for the application. While creating the dynamic web project, enable the checkbox to generate web.xml deployment descriptor.</p>

<p>The sample web application directory structure is shown below with a standard deployment descriptor web.xml</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/strutslayout.png" title="Struts Dynamic Web Project Layout" alt="Struts Dynamic Web Project Layout" /></p>

<h2>2. Modify web.xml</h2>

<p>Modify the contents of the web.xml to include the following:</p>

<ul>
<li>A Struts Dispatcher named Struts Prepare and Execute Filter to handle both the preparation and execution phases of Struts dispatching process.</li>
<li>A Filter mapping to map the dispatcher created in the above step that should be invoked when the client specifies the url matching the url pattern.</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
</span><span class='line'>&lt;web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" id="WebApp_ID" version="3.0"&gt;
</span><span class='line'>  &lt;display-name&gt;StudentEnrollmentWithStruts&lt;/display-name&gt;
</span><span class='line'>  &lt;filter&gt;
</span><span class='line'>          &lt;filter-name&gt;struts2&lt;/filter-name&gt;
</span><span class='line'>          &lt;filter-class&gt;org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter&lt;/filter-class&gt;
</span><span class='line'>  &lt;/filter&gt;
</span><span class='line'>  &lt;filter-mapping&gt;
</span><span class='line'>          &lt;filter-name&gt;struts2&lt;/filter-name&gt;
</span><span class='line'>          &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
</span><span class='line'>  &lt;/filter-mapping&gt;  
</span><span class='line'>&lt;/web-app&gt;</span></code></pre></td></tr></table></div></figure>


<h2>3. Add JARs to the project</h2>

<p>Add the following JARs from the web (or their latest equivalent) to the WEB-INF/lib folder under WebContent directory in the project.</p>

<ul>
<li>asm-3.3.jar (for bytecode manipulation framework support)</li>
<li>asm-commons-3.3.jar (for bytecode manipulation framework support)</li>
<li>commons-fileupload-1.3.jar (for file upload capability to your servlets and web applications support)</li>
<li>commons-io-2.0.1.jar (for library of utilities to assist with developing IO functionality)</li>
<li>commons-lang-2.4.jar (for manipulation of core classes by providing helper utilities)</li>
<li>commons-lang3-3.1.jar (for manipulation of core classes by providing helper utilities)</li>
<li>freemarker-2.3.19.jar (for UI tag templates support)</li>
<li>javassist-3.11.0.GA.jar (for JAVA programming ASSISTance support)</li>
<li>mysql-connector-java-5.1.26-bin.jar (for MYSQL data access support)</li>
<li>ognl-3.0.6.jar (for Object Graph Navigation Language (OGNL) support)</li>
<li>struts2-bootstrap-plugin-1.6.1.jar (for Bootstrap support)</li>
<li>struts2-convention-plugin-2.3.15.1.jar (for the zero configuration and naming convention support)</li>
<li>struts2-core-2.3.15.1.jar (for Struts Framework library support)</li>
<li>struts2-jquery-plugin-3.6.1.jar (for JQuery support)</li>
<li>xwork-core-2.3.15.1.jar (for XWork 2 library support)</li>
</ul>


<p>The sample lib folder structure is shown below with the necessary JARs added for the project.</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/strutsliblayout.png" title="Struts Library Layout" alt="Struts Library Layout" /></p>

<h2>4. Create JSP Files for Student Signup/Login</h2>

<p>Create a folder named &ldquo;content&rdquo; under WEB-INF (This is where the jsp files will be created).</p>

<p>Create a file signup.jsp to include a form to get the input details like UserName, Password, FirstName, LastName, DateOfBirth and EmailAddress of the student. A snapshot of the signup page is as follows:</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/struts-signup.png" title="Struts Signup Layout" alt="Struts Signup Layout" /></p>

<p>Next, create a file login.jsp to include a form with UserName and Password. A snapshot of the login page is as follows:</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/login.png" title="Struts Login Layout" alt="Struts Login Layout" /></p>

<p>The main actions for this application are as follows:</p>

<ul>
<li>Signup (To Insert the Student Signup details into the Database)</li>
<li>Login (To Verify the Student Login details from the Database)</li>
</ul>


<p>In order to display a success (result) page after the login action is complete, create a login-success.jsp page to indicate the login success (The page name will follow the semantics: &lt;action name&gt;-&lt;result name&gt;.jsp). Similarly, to indicate a login failure (result), create a page login-failure.jsp (login is the action and failure is the result). Also create a signup-failure.jsp page to indicate the signup failure, possibly due to an already existing username (signup is the action and failure is the result). These are just pages used to display the contents - no processing logic involved.</p>

<p>This application uses twitter bootstrap <a href="http://getbootstrap.com/">http://getbootstrap.com/</a> and <a href="http://bootswatch.com/united/">http://bootswatch.com/united/</a> as style sheets.</p>

<p>The Struts 2 UI component tags are used to create the page elements like the form, textfield, password and hidden fields. The Struts Bootstrap tags are used for the Twitter Bootstrap integration. The Struts jQuery tags are used to include the AJAX functionality of submitting the form outside from the modal window and to use the UI widgets like the datepicker.</p>

<p>A reference link to the files under WebContent folder of this application can be found at <a href="https://github.com/elizabetht/StudentEnrollmentWithStruts/tree/master/WebContent">https://github.com/elizabetht/StudentEnrollmentWithStruts/tree/master/WebContent</a></p>

<h2>5. Create packages</h2>

<p>Create packages each for the Struts Actions(equivalent to Controller), Service, Repository and Model classes under the src folder.
Also create package for the utilities class under the src folder.</p>

<p>A sample snapshot of the project after the package creation is as shown below:</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/struts-package.png" title="Struts Package Layout" alt="Struts Package Layout" /></p>

<h2>6. Create class for Model Tier</h2>

<p>Create a POJO class named Student.java inside the package com.github.elizabetht.model to include the details of the Student model entity.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public class Student {
</span><span class='line'>  private String userName;
</span><span class='line'>  private String firstName;
</span><span class='line'>  private String lastName;
</span><span class='line'>  private String password;
</span><span class='line'>  private String emailAddress;
</span><span class='line'>  private Date dateOfBirth;
</span><span class='line'>
</span><span class='line'>  public String getUserName() {
</span><span class='line'>      return userName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public void setUserName(String userName) {
</span><span class='line'>      this.userName = userName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public String getFirstName() {
</span><span class='line'>      return firstName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public void setFirstName(String firstName) {
</span><span class='line'>      this.firstName = firstName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public String getLastName() {
</span><span class='line'>      return lastName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public void setLastName(String lastName) {
</span><span class='line'>      this.lastName = lastName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public String getPassword() {
</span><span class='line'>      return password;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public void setPassword(String password) {
</span><span class='line'>      this.password = password;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public String getEmailAddress() {
</span><span class='line'>      return emailAddress;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public void setEmailAddress(String emailAddress) {
</span><span class='line'>      this.emailAddress = emailAddress;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public Date getDateOfBirth() {
</span><span class='line'>      return dateOfBirth;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public void setDateOfBirth(Date dateOfBirth) {
</span><span class='line'>      this.dateOfBirth = dateOfBirth;
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>7. Create db.properties file</h2>

<p>Create a file named db.properties under the src folder, where the properties of the MYSQL DB like url, username and password can be specified. Replace &lt;include connection url&gt; with the actual connection url for connecting to the MYSQL DB. Likewise, replace &lt;include username&gt; and &lt;include password&gt; with the actual username and password values.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>dbDriver=com.mysql.jdbc.Driver
</span><span class='line'>connectionUrl=jdbc:mysql://&lt;include connection url&gt;:3306/studentEnrollment
</span><span class='line'>userName=&lt;include username&gt;
</span><span class='line'>password=&lt;include password&gt;</span></code></pre></td></tr></table></div></figure>


<h2>8. Create utility class </h2>

<p>Create a POJO class named DbUtil.java under the package com.github.elizabetht.util to include a helper class functionality that would load the db.properties file and get the database connection.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public class DbUtil {
</span><span class='line'>  private static Connection dbConnection = null;
</span><span class='line'>
</span><span class='line'>  public static Connection getConnection() {
</span><span class='line'>      if (dbConnection != null) {
</span><span class='line'>          return dbConnection;
</span><span class='line'>      } else {
</span><span class='line'>          try {
</span><span class='line'>              InputStream inputStream = DbUtil.class.getClassLoader()
</span><span class='line'>                      .getResourceAsStream("db.properties");
</span><span class='line'>              Properties properties = new Properties();
</span><span class='line'>              if (properties != null) {
</span><span class='line'>                  properties.load(inputStream);
</span><span class='line'>
</span><span class='line'>                  String dbDriver = properties.getProperty("dbDriver");
</span><span class='line'>                  String connectionUrl = properties
</span><span class='line'>                          .getProperty("connectionUrl");
</span><span class='line'>                  String userName = properties.getProperty("userName");
</span><span class='line'>                  String password = properties.getProperty("password");
</span><span class='line'>
</span><span class='line'>                  Class.forName(dbDriver).newInstance();
</span><span class='line'>                  dbConnection = DriverManager.getConnection(connectionUrl,
</span><span class='line'>                          userName, password);
</span><span class='line'>              }
</span><span class='line'>          } catch (Exception e) {
</span><span class='line'>              e.printStackTrace();
</span><span class='line'>          }
</span><span class='line'>          return dbConnection;
</span><span class='line'>      }
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>9. Create class for Repository tier</h2>

<p>Create a Repository tier POJO class named StudentRepository.java under the package com.github.elizabetht.repository to support the database operations of saving the student details, verifying the student login details and checking if the username exists when a save is attempted.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public class StudentRepository {
</span><span class='line'>  private Connection dbConnection;
</span><span class='line'>
</span><span class='line'>  public StudentRepository() {
</span><span class='line'>      dbConnection = DbUtil.getConnection();
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public void save(String userName, String password, String firstName,
</span><span class='line'>          String lastName, String dateOfBirth, String emailAddress) {
</span><span class='line'>      if (dbConnection != null) {
</span><span class='line'>          try {
</span><span class='line'>              PreparedStatement prepStatement = dbConnection
</span><span class='line'>                      .prepareStatement("insert into student(userName, password, firstName, lastName, dateOfBirth, emailAddress) values (?, ?, ?, ?, ?, ?)");
</span><span class='line'>              prepStatement.setString(1, userName);
</span><span class='line'>              prepStatement.setString(2, password);
</span><span class='line'>              prepStatement.setString(3, firstName);
</span><span class='line'>              prepStatement.setString(4, lastName);               
</span><span class='line'>              
</span><span class='line'>              prepStatement.setDate(5, new java.sql.Date(new SimpleDateFormat("MM/dd/yyyy")
</span><span class='line'>              .parse(dateOfBirth.substring(0, 10)).getTime()));
</span><span class='line'>
</span><span class='line'>              prepStatement.setString(6, emailAddress);
</span><span class='line'>
</span><span class='line'>              prepStatement.executeUpdate();
</span><span class='line'>          } catch (SQLException e) {
</span><span class='line'>              e.printStackTrace();
</span><span class='line'>          } catch (ParseException e) {                
</span><span class='line'>              e.printStackTrace();
</span><span class='line'>          }
</span><span class='line'>      }
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public boolean findByUserName(String userName) {
</span><span class='line'>      if (dbConnection != null) {
</span><span class='line'>          try {
</span><span class='line'>              PreparedStatement prepStatement = dbConnection
</span><span class='line'>                      .prepareStatement("select count(*) from student where userName = ?");
</span><span class='line'>              prepStatement.setString(1, userName);
</span><span class='line'>
</span><span class='line'>              ResultSet result = prepStatement.executeQuery();
</span><span class='line'>              if (result != null) {
</span><span class='line'>                  while (result.next()) {
</span><span class='line'>                      if (result.getInt(1) == 1) {
</span><span class='line'>                          return true;
</span><span class='line'>                      }
</span><span class='line'>                  }
</span><span class='line'>              }
</span><span class='line'>          } catch (Exception e) {
</span><span class='line'>              e.printStackTrace();
</span><span class='line'>          }
</span><span class='line'>      }
</span><span class='line'>      return false;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public boolean findByLogin(String userName, String password) {
</span><span class='line'>      if (dbConnection != null) {
</span><span class='line'>          try {
</span><span class='line'>              PreparedStatement prepStatement = dbConnection
</span><span class='line'>                      .prepareStatement("select password from student where userName = ?");
</span><span class='line'>              prepStatement.setString(1, userName);
</span><span class='line'>
</span><span class='line'>              ResultSet result = prepStatement.executeQuery();
</span><span class='line'>              if (result != null) {
</span><span class='line'>                  while (result.next()) {
</span><span class='line'>                      if (result.getString(1).equals(password)) {
</span><span class='line'>                          return true;
</span><span class='line'>                      }
</span><span class='line'>                  }
</span><span class='line'>              }
</span><span class='line'>          } catch (Exception e) {
</span><span class='line'>              e.printStackTrace();
</span><span class='line'>          }
</span><span class='line'>      }
</span><span class='line'>      return false;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>10. Create class for Service Tier</h2>

<p>Create a Controller tier POJO class named StudentService.java inside the package com.github.elizabetht.service. This layer acts as a median between the Controller and Repository tier classes.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public class StudentService {
</span><span class='line'>
</span><span class='line'>  private StudentRepository studentRepository;
</span><span class='line'>
</span><span class='line'>  public StudentService() {
</span><span class='line'>      studentRepository = new StudentRepository();
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public String save(String userName, String password,
</span><span class='line'>          String firstName, String lastName, String dateOfBirth,
</span><span class='line'>          String emailAddress) {
</span><span class='line'>      if (studentRepository != null) {
</span><span class='line'>          if (studentRepository.findByUserName(userName)) {
</span><span class='line'>              return "SignupFailure-UserNameExists";
</span><span class='line'>          }
</span><span class='line'>          studentRepository.save(userName, password, firstName, lastName,
</span><span class='line'>                  dateOfBirth, emailAddress);
</span><span class='line'>          return "SignupSuccess";
</span><span class='line'>      } else {
</span><span class='line'>          return "SignupFailure";
</span><span class='line'>      }
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public String findByLogin(String userName, String password) {
</span><span class='line'>      String result = "LoginFailure";
</span><span class='line'>      if (studentRepository != null) {
</span><span class='line'>          boolean status = studentRepository.findByLogin(userName, password);
</span><span class='line'>          if (status) {
</span><span class='line'>              result = "LoginSuccess";
</span><span class='line'>          }
</span><span class='line'>      }
</span><span class='line'>      return result;
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>11. Create Action classes for Controller tier</h2>

<p>Create a Controller tier POJO class named StudentController.java inside the package com.github.elizabetht.controller. This is where the routing logic of the application goes - whether a signup or login action is called. For simplicity sake, two separate action classes are created for each of the operation.</p>

<p>Each of the Action class has to implement the execute() method. Based on the String result returned from the execute() method of the action class, the appropriate view page is rendered.</p>

<p>In most cases, the action class is extended from the general ActionSupport class, which has a lot of easy to use convenient features. So, extend the ActionSupport class in the Action class, unless you have a reason not to!</p>

<p>The following snippet shows the SignupAction class.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>@SuppressWarnings("serial")
</span><span class='line'>public class SignupAction extends ActionSupport {
</span><span class='line'>
</span><span class='line'>  private String pageName;
</span><span class='line'>  private String userName;
</span><span class='line'>  private String password;
</span><span class='line'>  private String firstName;
</span><span class='line'>  private String lastName;
</span><span class='line'>  private String dateOfBirth;
</span><span class='line'>  private String emailAddress;
</span><span class='line'>
</span><span class='line'>  @Action("signup-input")
</span><span class='line'>  public String input() throws Exception {
</span><span class='line'>      return "signup";
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @Override
</span><span class='line'>  @Action(value = "signup", results = { @Result(name = "login-input", location = "login-input", type = "redirect") })
</span><span class='line'>  public String execute() throws Exception {
</span><span class='line'>      String result = "";
</span><span class='line'>      StudentService studentService = new StudentService();
</span><span class='line'>
</span><span class='line'>      if (pageName != null && studentService != null) {
</span><span class='line'>          if (pageName.equals("signup")) {
</span><span class='line'>              result = studentService.save(userName, password, firstName,
</span><span class='line'>                      lastName, dateOfBirth, emailAddress);
</span><span class='line'>              if (result.equals("SignupSuccess")) {
</span><span class='line'>                  return "login-input";
</span><span class='line'>              } else {
</span><span class='line'>                  return "failure";
</span><span class='line'>              }
</span><span class='line'>          }
</span><span class='line'>      }
</span><span class='line'>      return SUCCESS;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public String getPageName() {
</span><span class='line'>      return pageName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public void setPageName(String pageName) {
</span><span class='line'>      this.pageName = pageName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public String getUserName() {
</span><span class='line'>      return userName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @RequiredStringValidator(type = ValidatorType.FIELD, message = "UserName is a required field")
</span><span class='line'>  @StringLengthFieldValidator(type = ValidatorType.FIELD, maxLength = "12", minLength = "6", message = "UserName must be of length between 6 and 12")
</span><span class='line'>  public void setUserName(String userName) {
</span><span class='line'>      this.userName = userName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public String getPassword() {
</span><span class='line'>      return password;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @RequiredStringValidator(type = ValidatorType.FIELD, message = "Password is a required field")
</span><span class='line'>  @StringLengthFieldValidator(type = ValidatorType.FIELD, maxLength = "12", minLength = "6", message = "Password must be of length between 6 and 12")
</span><span class='line'>  public void setPassword(String password) {
</span><span class='line'>      this.password = password;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public String getFirstName() {
</span><span class='line'>      return firstName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @RequiredStringValidator(type = ValidatorType.FIELD, message = "FirstName is a required field")
</span><span class='line'>  public void setFirstName(String firstName) {
</span><span class='line'>      this.firstName = firstName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public String getLastName() {
</span><span class='line'>      return lastName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @RequiredStringValidator(type = ValidatorType.FIELD, message = "LastName is a required field")
</span><span class='line'>  public void setLastName(String lastName) {
</span><span class='line'>      this.lastName = lastName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public String getEmailAddress() {
</span><span class='line'>      return emailAddress;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @RequiredStringValidator(type = ValidatorType.FIELD, message = "EmailAddress is a required field")
</span><span class='line'>  @EmailValidator(type = ValidatorType.FIELD, message = "Email Address must be valid")
</span><span class='line'>  public void setEmailAddress(String emailAddress) {
</span><span class='line'>      this.emailAddress = emailAddress;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public String getDateOfBirth() {
</span><span class='line'>      return dateOfBirth;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @RequiredStringValidator(type = ValidatorType.FIELD, message = "DateOfBirth is a required field")
</span><span class='line'>  public void setDateOfBirth(String dateOfBirth) {
</span><span class='line'>      this.dateOfBirth = dateOfBirth;
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Similar to the SignupAction class, the LoginAction class also implements the execute() method as shown below</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>@SuppressWarnings("serial")
</span><span class='line'>public class LoginAction extends ActionSupport {
</span><span class='line'>
</span><span class='line'>  private String pageName;
</span><span class='line'>  private String userName;
</span><span class='line'>  private String password;
</span><span class='line'>
</span><span class='line'>  @Action("login-input")
</span><span class='line'>  public String input() throws Exception {
</span><span class='line'>      return "login";
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @Action("login")
</span><span class='line'>  public String execute() throws Exception {
</span><span class='line'>      String result = "";
</span><span class='line'>      StudentService studentService = new StudentService();
</span><span class='line'>
</span><span class='line'>      if (pageName != null && studentService != null) {
</span><span class='line'>          if (pageName.equals("login")) {
</span><span class='line'>              result = studentService.findByLogin(userName, password);
</span><span class='line'>              if (result.equals("LoginFailure")) {
</span><span class='line'>                  return "failure";
</span><span class='line'>              } else {
</span><span class='line'>                  return "success";
</span><span class='line'>              }
</span><span class='line'>          }
</span><span class='line'>      }
</span><span class='line'>      return SUCCESS;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public String getPageName() {
</span><span class='line'>      return pageName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public void setPageName(String pageName) {
</span><span class='line'>      this.pageName = pageName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public String getUserName() {
</span><span class='line'>      return userName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @RequiredStringValidator(type = ValidatorType.FIELD, message = "UserName is a required field")
</span><span class='line'>  @StringLengthFieldValidator(type = ValidatorType.FIELD, maxLength = "12", minLength = "6", message = "UserName must be of length between 6 and 12")
</span><span class='line'>  public void setUserName(String userName) {
</span><span class='line'>      this.userName = userName;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public String getPassword() {
</span><span class='line'>      return password;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @RequiredStringValidator(type = ValidatorType.FIELD, message = "Password is a required field")
</span><span class='line'>  @StringLengthFieldValidator(type = ValidatorType.FIELD, maxLength = "12", minLength = "6", message = "Password must be of length between 6 and 12")
</span><span class='line'>  public void setPassword(String password) {
</span><span class='line'>      this.password = password;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>The @Action annotation is used to specify the incoming requested URL and results to be rendered. For results other than SUCCESS (or the equivalent success string), the resulting view will be rendered based on the value of the result. For instance, in SignupAction class, if &ldquo;failure&rdquo; string is returned from the execute() method, the result will be appended to the @Action value (which is &ldquo;signup&rdquo;, in this case) and the signup-failure.jsp page will be rendered. Similarly, in LoginAction class, if &ldquo;failure&rdquo; string is returned from the execute() method, the login-failure.jsp page will be rendered.</p>

<p>If SUCCESS (or the equivalent success string) is returned from the execute() method, the actual value of action will be the resulting view, unless there are no results specified using the @Result annotation. For instance, in LoginAction class, there are no @Result annotations used and hence, login-success.jsp will be rendered when execute() method returns a SUCCESS string.</p>

<p>But if there are results specified with @Result annotation as in SignupAction class, the name and location given by the results array will determine the view rendered - in this case, login-input action will be rendered (which is in-turn, an action specified by the LoginAction class).</p>

<h2>12. Add Validators to the Form Fields</h2>

<p>As shown in the above snippets of SignupAction and LoginAction classes, add the following required validators to the setter methods for the fields.</p>

<p>@RequiredStringValidator is used to check that a String field is not empty.</p>

<p>@StringLengthFieldValidator is used to check that a String field is of the right length. It assumes that the field is a String. If neither minLength nor maxLength is set, nothing will be done.</p>

<p>@EmailValidator is used to check that a field is a valid e-mail address if it contains a non-empty String.</p>

<h2>13. Create the DB Schema in a MYSQL DB</h2>

<p>Connect to the MySQL DB which is to be used for this application and create a new DB Schema named studentEnrollment using the MySQL Workbench.
This is necessary as the DB Schema name of studentEnrollment is specified in the db.properties file.</p>

<p>Once the studentEnrollment DB Schema is created, create a table named student inside the DB Schema using the CREATE TABLE statement as follows:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>CREATE TABLE `student` (
</span><span class='line'>  `id` bigint(20) NOT NULL AUTO_INCREMENT,
</span><span class='line'>  `dateOfBirth` datetime NOT NULL,
</span><span class='line'>  `emailAddress` varchar(255) NOT NULL,
</span><span class='line'>  `firstName` varchar(255) NOT NULL,
</span><span class='line'>  `lastName` varchar(255) NOT NULL,
</span><span class='line'>  `password` varchar(8) NOT NULL,
</span><span class='line'>  `userName` varchar(20) NOT NULL,
</span><span class='line'>  PRIMARY KEY (`id`)
</span><span class='line'>) ENGINE=InnoDB AUTO_INCREMENT=43 DEFAULT CHARSET=latin1;</span></code></pre></td></tr></table></div></figure>


<h2>14. Deploying the Application on Tomcat Server</h2>

<p>Once the above steps are complete and the project is successfully built, the Java web application is ready to deployed on the Tomcat Server 7.</p>

<p>The Java web application can be deployed locally by right clicking on the project and choosing the &ldquo;Run As->Run on Server&rdquo; option.</p>

<p>The same can be deployed remotely on any native server that supports Tomcat by copying the WAR file (Right click on the project and choose Export as WAR File option) to /var/lib/tomcat7 folder (or appropriate tomcat directory) and restarting the tomcat server.</p>

<h2>15. Clone or Download code</h2>

<p>If using git, clone a copy of this project here: <a href="https://github.com/elizabetht/StudentEnrollmentWithStruts.git">https://github.com/elizabetht/StudentEnrollmentWithStruts.git</a></p>

<p>In case of not using git, download the project as ZIP or tar.gz file here: <a href="https://github.com/elizabetht/StudentEnrollmentWithStruts/releases/tag/1.4">https://github.com/elizabetht/StudentEnrollmentWithStruts/releases/tag/1.4</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Building Java Web Application Using Hibernate With Spring]]></title>
    <link href="http://blog.meygam.com//blog/2013/11/21/student-enrollment-using-hibernate-with-spring/"/>
    <updated>2013-11-21T09:41:30-06:00</updated>
    <id>http://blog.meygam.com//blog/2013/11/21/student-enrollment-using-hibernate-with-spring</id>
    <content type="html"><![CDATA[<p>This post will show how to create a Student Enrollment Application using MYSQL DB with Hibernate ORM in a Spring environment. This is a simple application that aims to collect the input details from the user during signup, save the details in the MYSQL DB and authenticate the same during login.</p>

<!-- more -->


<h2>1. Create Java Web Application Project using Maven Template</h2>

<p>To begin with, in the IDE, create a Java Maven project with the template of maven-archetype-webapp (Filter the catalog based on the string &ldquo;webapp&rdquo;) by providing appropriate values for GroupId and Artifact Id for the project. The sample web application directory structure is shown below with a standard deployment descriptor web.xml and Maven pom.xml</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/springlayout.png" title="Spring Hibernate Project Layout" alt="Hibernate Spring Maven Project Layout" /></p>

<h2>2. Update pom.xml</h2>

<p>To make the above Maven Java Web Application project support the Hibernate ORM in Spring framework, add the following dependencies to the existing pom.xml</p>

<ul>
<li>jstl, spring-webmvc and servlet-api (for Spring support)</li>
<li>mysql-connector-java (for MYSQL support)</li>
<li>spring-jdbc (for data access with JDBC Spring)</li>
<li>spring-orm (for ORM data access with Spring)</li>
<li>spring-data-jpa (for JPA support)</li>
<li>hibernate-validator and hibernate-entitymanager (for Hibernate Support)</li>
<li>jta (for transaction support)</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;3.2.4.RELEASE&lt;/version&gt;
</span><span class='line'>    &lt;/dependency&gt;
</span><span class='line'>    &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;2.5&lt;/version&gt;
</span><span class='line'>      &lt;scope&gt;provided&lt;/scope&gt;
</span><span class='line'>    &lt;/dependency&gt;
</span><span class='line'>    &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;jstl&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;1.2&lt;/version&gt;
</span><span class='line'>    &lt;/dependency&gt;
</span><span class='line'>    &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;mysql&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;5.1.21&lt;/version&gt;
</span><span class='line'>    &lt;/dependency&gt;
</span><span class='line'>    &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.hibernate&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;4.2.0.Final&lt;/version&gt;
</span><span class='line'>    &lt;/dependency&gt;
</span><span class='line'>    &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.hibernate&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;hibernate-entitymanager&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;4.1.9.Final&lt;/version&gt;
</span><span class='line'>    &lt;/dependency&gt;
</span><span class='line'>    &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;javax.transaction&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;jta&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;1.1&lt;/version&gt;
</span><span class='line'>    &lt;/dependency&gt;
</span><span class='line'>    &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;3.2.0.RELEASE&lt;/version&gt;
</span><span class='line'>    &lt;/dependency&gt;
</span><span class='line'>    &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;spring-orm&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;3.2.0.RELEASE&lt;/version&gt;
</span><span class='line'>    &lt;/dependency&gt;
</span><span class='line'>    &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.springframework.data&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;spring-data-jpa&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;1.3.0.RELEASE&lt;/version&gt;
</span><span class='line'>      &lt;exclusions&gt;
</span><span class='line'>          &lt;exclusion&gt;
</span><span class='line'>              &lt;groupId&gt;org.springframework&lt;/groupId&gt;
</span><span class='line'>              &lt;artifactId&gt;spring-aop&lt;/artifactId&gt;
</span><span class='line'>          &lt;/exclusion&gt;
</span><span class='line'>      &lt;/exclusions&gt;
</span><span class='line'>    &lt;/dependency&gt;</span></code></pre></td></tr></table></div></figure>


<h2>3. Modify web.xml</h2>

<p>Modify the contents of the web.xml to include the following:</p>

<ul>
<li>A servlet and specify the location of the configuration file for the same. In this sample, a configuration file named springConfig.xml is created under WEB-INF/config folder in the project layout.</li>
<li>A servlet-mapping to map the servlet created in the above step that should be invoked when the client specifies the url matching the url pattern.</li>
<li>A ContextLoaderListener to integrate spring with the web application and provide the contextConfigLocation where the context files for JPA.</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
</span><span class='line'>&lt;web-app version="2.5"
</span><span class='line'>xmlns="http://java.sun.com/xml/ns/javaee"
</span><span class='line'>xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
</span><span class='line'>xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"&gt;
</span><span class='line'>
</span><span class='line'>&lt;servlet&gt;
</span><span class='line'>  &lt;servlet-name&gt;studentHibernateServlet&lt;/servlet-name&gt;
</span><span class='line'>  &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;
</span><span class='line'>  &lt;init-param&gt;
</span><span class='line'>      &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
</span><span class='line'>      &lt;param-value&gt;/WEB-INF/config/servletConfig.xml&lt;/param-value&gt;
</span><span class='line'>  &lt;/init-param&gt;
</span><span class='line'>&lt;/servlet&gt;
</span><span class='line'>
</span><span class='line'>&lt;servlet-mapping&gt;
</span><span class='line'>  &lt;servlet-name&gt;studentHibernateServlet&lt;/servlet-name&gt;
</span><span class='line'>  &lt;url-pattern&gt;*.html&lt;/url-pattern&gt;
</span><span class='line'>&lt;/servlet-mapping&gt;
</span><span class='line'>
</span><span class='line'>&lt;context-param&gt;
</span><span class='line'>  &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
</span><span class='line'>  &lt;param-value&gt;classpath:/jpaContext.xml&lt;/param-value&gt;
</span><span class='line'>&lt;/context-param&gt;
</span><span class='line'>
</span><span class='line'>&lt;listener&gt;
</span><span class='line'>  &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;
</span><span class='line'>&lt;/listener&gt;
</span><span class='line'>
</span><span class='line'>  &lt;display-name&gt;Archetype Created Web Application&lt;/display-name&gt;
</span><span class='line'>&lt;/web-app&gt;
</span></code></pre></td></tr></table></div></figure>


<h2>4. Create the Spring Configuration File</h2>

<p>Create a Spring Bean Configuration file under the folder WEB-INF/config. If a STS(Spring Tool Suite) is the IDE, go ahead and enable the context and mvc namespaces. The servletConfig.xml will be as shown below</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
</span><span class='line'>&lt;beans xmlns="http://www.springframework.org/schema/beans"
</span><span class='line'>  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
</span><span class='line'>  xmlns:context="http://www.springframework.org/schema/context"
</span><span class='line'>  xmlns:mvc="http://www.springframework.org/schema/mvc"
</span><span class='line'>  xsi:schemaLocation="http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.2.xsd
</span><span class='line'>      http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
</span><span class='line'>      http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.2.xsd"&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;/beans&gt;</span></code></pre></td></tr></table></div></figure>


<p>After enabling the required namespaces, include the following (in between the &lt;beans&gt; and &lt;/beans&gt; tags) to indicate that the application is annotation driven and base package for the context component scan.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;mvc:annotation-driven /&gt;
</span><span class='line'>
</span><span class='line'>&lt;context:component-scan base-package="com.github.elizabetht" /&gt;</span></code></pre></td></tr></table></div></figure>


<p>Include the bean InternalResourceViewResolver of Spring to locate the jsp files</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;bean class="org.springframework.web.servlet.view.InternalResourceViewResolver"&gt;
</span><span class='line'>  &lt;property name="prefix" value="/WEB-INF/jsp/" /&gt;
</span><span class='line'>  &lt;property name="suffix" value=".jsp" /&gt;
</span><span class='line'>&lt;/bean&gt;</span></code></pre></td></tr></table></div></figure>


<p>Include the bean for specifying a properties file (more on this later) which is to be used to store custom messages or properties. The following configuration allows to create a properties file named messages.properties under the src/main/resources folder in the project.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;bean id="messageSource" class="org.springframework.context.support.ResourceBundleMessageSource"&gt;
</span><span class='line'>  &lt;property name="basename" value="messages" /&gt;
</span><span class='line'>&lt;/bean&gt;</span></code></pre></td></tr></table></div></figure>


<h2>5. Create persistence.xml</h2>

<p>Create a file named persistence.xml under the folder src/main/resources/META-INF folder in the project to define the persistence unit required by JPA. Add the following to the persistence.xml to define a persistence unit named punit.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;persistence xmlns="http://java.sun.com/xml/ns/persistence"
</span><span class='line'>  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
</span><span class='line'>  xsi:schemaLocation="{http://java.sun.com/xml/ns/persistence} {http://java.sun.com/xml/ns/persistence_2_0.xsd}"
</span><span class='line'>  version="2.0"&gt;
</span><span class='line'>  
</span><span class='line'>  &lt;persistence-unit name="punit"&gt;
</span><span class='line'>  &lt;/persistence-unit&gt;
</span><span class='line'>  
</span><span class='line'>&lt;/persistence&gt;</span></code></pre></td></tr></table></div></figure>


<h2>6. Create jpaContext.xml</h2>

<p>As defined in the web.xml, create a file named jpaContext.xml under the folder src/main/resources folder in the project to define JPA and Hibernate related configurations. Note that any file created under src/main/resources folder in a maven project will be automagically added by Maven to the classpath. If STS(Spring Tool Suite) is the IDE, go ahead and enable the context, jpa and tx namespaces. The jpaContext.xml will be as shown below</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
</span><span class='line'>&lt;beans xmlns="http://www.springframework.org/schema/beans"
</span><span class='line'>  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
</span><span class='line'>  xmlns:tx="http://www.springframework.org/schema/tx"
</span><span class='line'>  xmlns:context="http://www.springframework.org/schema/context"
</span><span class='line'>  xmlns:jpa="http://www.springframework.org/schema/data/jpa"
</span><span class='line'>  xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
</span><span class='line'>      http://www.springframework.org/schema/data/jpa http://www.springframework.org/schema/data/jpa/spring-jpa-1.3.xsd
</span><span class='line'>      http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.2.xsd
</span><span class='line'>      http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.2.xsd"&gt;
</span><span class='line'>      
</span><span class='line'>&lt;beans&gt;</span></code></pre></td></tr></table></div></figure>


<p>After enabling the required namespaces, include the following (in between the &lt;beans&gt; and &lt;/beans&gt; tags) to indicate that the application is annotation driven and base package for the jpa repositories scan.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;context:annotation-config /&gt;
</span><span class='line'>  
</span><span class='line'>&lt;jpa:repositories base-package="com.github.elizabetht.repository" /&gt;</span></code></pre></td></tr></table></div></figure>


<p>Next, include the bean PersistenceAnnotationBeanPostProcessor. This is necessary to process the Persistence Unit, Persistence Context annotations and for injecting JPA related resources.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;bean class="org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor" /&gt;</span></code></pre></td></tr></table></div></figure>


<p>Include the bean for EntityManagerFactory which lists the various JPA related properties/resources.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean"&gt;
</span><span class='line'>      &lt;property name="persistenceUnitName" value="punit" /&gt;
</span><span class='line'>      &lt;property name="dataSource" ref="dataSource" /&gt;
</span><span class='line'>      &lt;property name="jpaVendorAdapter"&gt;
</span><span class='line'>          &lt;bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter"&gt;
</span><span class='line'>              &lt;property name="showSql" value="true" /&gt;
</span><span class='line'>          &lt;/bean&gt;
</span><span class='line'>      &lt;/property&gt;
</span><span class='line'>      &lt;property name="jpaPropertyMap"&gt;
</span><span class='line'>          &lt;map&gt;
</span><span class='line'>              &lt;entry key="hibernate.dialect" value="org.hibernate.dialect.MySQL5InnoDBDialect" /&gt;
</span><span class='line'>              &lt;entry key="hibernate.hbm2ddl.auto" value="validate" /&gt;
</span><span class='line'>              &lt;entry key="hibernate.format_sql" value="true" /&gt;
</span><span class='line'>          &lt;/map&gt;
</span><span class='line'>      &lt;/property&gt;
</span><span class='line'>  &lt;/bean&gt;</span></code></pre></td></tr></table></div></figure>


<p>Include the bean for data source, where the properties of the MYSQL DB like url, username and password can be specified. Replace &lt;include connection url&gt; with the actual connection url for connecting to the MYSQL DB. Likewise, replace &lt;include username&gt; and &lt;include password&gt; with the actual username and password values.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource"&gt;
</span><span class='line'>      &lt;property name="driverClassName" value="com.mysql.jdbc.Driver" /&gt;
</span><span class='line'>      &lt;property name="url" value="jdbc:mysql//&lt;include connection url&gt;:3306/studentEnrollment?autoReconnect=true&amp;createDatabaseIfNotExist=true&amp;" /&gt;
</span><span class='line'>      &lt;property name="username" value="&lt;include username&gt;" /&gt;
</span><span class='line'>      &lt;property name="password" value="&lt;include password&gt;" /&gt;
</span><span class='line'>&lt;/bean&gt;</span></code></pre></td></tr></table></div></figure>


<p>Include the bean for transaction manager for scoping/controlling the transactions.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager"&gt;
</span><span class='line'>      &lt;property name="entityManagerFactory" ref="entityManagerFactory" /&gt;
</span><span class='line'>&lt;/bean&gt;
</span><span class='line'>  
</span><span class='line'>&lt;tx:annotation-driven transaction-manager="transactionManager" /&gt;</span></code></pre></td></tr></table></div></figure>


<p>Thus ends the long configuration in jpaContext.xml</p>

<h2>7. Create JSP Files for Student Signup/Login</h2>

<p>Create a folder named &ldquo;jsp&rdquo; under WEB-INF (This is where the jsp files will be created as indicated in the servletConfig.xml for the InternalResourceViewResolver bean).</p>

<p>Create a file signup.jsp to include a form to get the input details like UserName, Password, FirstName, LastName, DateOfBirth and EmailAddress of the student. A snapshot of the signup page is as follows:</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/signup.png" title="Spring Hibernate Signup Layout" alt="Spring Hibernate Signup Layout" /></p>

<p>Next, create a file login.jsp to include a form with UserName and Password. A snapshot of the login page is as follows:</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/login.png" title="Spring Hibernate Login Layout" alt="Spring Hibernate Login Layout" /></p>

<p>Also create success.jsp to indicate the login success and failure.jsp to indicate login failure (These are just pages used to display the contents - no processing logic involved).</p>

<p>This application uses twitter bootstrap <a href="http://getbootstrap.com/">http://getbootstrap.com/</a> and <a href="http://bootswatch.com/united/">http://bootswatch.com/united/</a> as style sheets. It also uses a datepicker stylesheet as well to pop up a calendar for the DateOfBirth field in the Student Signup page (<a href="http://www.eyecon.ro/bootstrap-datepicker/">http://www.eyecon.ro/bootstrap-datepicker/</a>).</p>

<p>A reference link to the files under webapp folder of this application can be found at <a href="https://github.com/elizabetht/StudentEnrollmentWithSpring/tree/master/src/main/webapp">https://github.com/elizabetht/StudentEnrollmentWithSpring/tree/master/src/main/webapp</a></p>

<h2>8. Create packages for Controller, Model, Repository and Service tier classes</h2>

<p>Create packages each for the Spring Controller, Model, Repository and Service classes under the src/main/java folder.</p>

<p>A sample snapshot of the project after the package creation is as shown below:</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/spring-hibernate-package.png" title="Spring Hibernate Package Layout" alt="Spring Hibernate Package Layout" /></p>

<h2>9. Create classes for Model Tier</h2>

<p>Create a POJO class named Student.java inside the package com.github.elizabetht.model to include the details of the Student model entity during signup. Create another POJO class named StudentLogin.java inside the same package com.github.elizabetht.model to include the Student Login details.</p>

<p>A reference link to the files for the Model classes can be found at <a href="https://github.com/elizabetht/StudentEnrollmentWithSpring/tree/master/src/main/java/com/github/elizabetht/model">https://github.com/elizabetht/StudentEnrollmentWithSpring/tree/master/src/main/java/com/github/elizabetht/model</a></p>

<h2>10. Create class for Repository Tier</h2>

<p>Create an interface class named StudentRepository.java inside the package com.github.elizabetht.repository to support the repository tier database operations.</p>

<p>There are two interface methods needed for the application&rsquo;s purpose.</p>

<ul>
<li>To Insert the Student Signup details into the Database</li>
<li>To Verify the Student Login details from the Database</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>@Repository("studentRepository")
</span><span class='line'>public interface StudentRepository extends JpaRepository&lt;Student, Long&gt; {
</span><span class='line'>  
</span><span class='line'>  @Query("select s from Student s where s.userName = :userName")
</span><span class='line'>  Student findByUserName(@Param("userName") String userName);
</span><span class='line'>  
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>The save() method is supported by the Hibernate implementation and hence no separate SQL statements are required for the data insert.</p>

<h2>11. Create classes for Service Tier</h2>

<p>Create an interface class named StudentService.java inside the package com.github.elizabetht.service to support the service tier operations.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public interface StudentService {
</span><span class='line'>  Student save(Student student);
</span><span class='line'>  boolean findByLogin(String userName, String password);
</span><span class='line'>  boolean findByUserName(String userName);
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Create a service tier implementation class (a POJO indeed) named StudentServiceImpl.java inside the package com.github.elizabetht.service. This is where the application logic goes - either to save the student details into the database or to verify the student (already saved) details from the database.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>@Service("studentService")
</span><span class='line'>public class StudentServiceImpl implements StudentService {
</span><span class='line'>
</span><span class='line'>  @Autowired
</span><span class='line'>  private StudentRepository studentRepository;
</span><span class='line'>  
</span><span class='line'>  @Transactional
</span><span class='line'>  public Student save(Student student) {
</span><span class='line'>      return studentRepository.save(student);
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public boolean findByLogin(String userName, String password) {  
</span><span class='line'>      Student stud = studentRepository.findByUserName(userName);
</span><span class='line'>      
</span><span class='line'>      if(stud != null && stud.getPassword().equals(password)) {
</span><span class='line'>          return true;
</span><span class='line'>      } 
</span><span class='line'>      
</span><span class='line'>      return false;       
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public boolean findByUserName(String userName) {
</span><span class='line'>      Student stud = studentRepository.findByUserName(userName);
</span><span class='line'>      
</span><span class='line'>      if(stud != null) {
</span><span class='line'>          return true;
</span><span class='line'>      }
</span><span class='line'>      
</span><span class='line'>      return false;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>12. Create class for Controller Tier</h2>

<p>Create a Controller tier POJO class named StudentController.java inside the package com.github.elizabetht.controller. This is where the routing logic of the application goes - whether a signup or login action is called.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>@Controller
</span><span class='line'>@SessionAttributes("student")
</span><span class='line'>public class StudentController {
</span><span class='line'>  
</span><span class='line'>  @Autowired
</span><span class='line'>  private StudentService studentService;
</span><span class='line'>      
</span><span class='line'>  @RequestMapping(value="/signup", method=RequestMethod.GET)
</span><span class='line'>  public String signup(Model model) {
</span><span class='line'>      Student student = new Student();        
</span><span class='line'>      model.addAttribute("student", student);     
</span><span class='line'>      return "signup";
</span><span class='line'>  }
</span><span class='line'>  
</span><span class='line'>  @RequestMapping(value="/signup", method=RequestMethod.POST)
</span><span class='line'>  public String signup(@Valid @ModelAttribute("student") Student student, BindingResult result, Model model) {        
</span><span class='line'>      if(result.hasErrors()) {
</span><span class='line'>          return "signup";
</span><span class='line'>      } else if(studentService.findByUserName(student.getUserName())) {
</span><span class='line'>          model.addAttribute("message", "User Name exists. Try another user name");
</span><span class='line'>          return "signup";
</span><span class='line'>      } else {
</span><span class='line'>          studentService.save(student);
</span><span class='line'>          model.addAttribute("message", "Saved student details");
</span><span class='line'>          return "redirect:login.html";
</span><span class='line'>      }
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  @RequestMapping(value="/login", method=RequestMethod.GET)
</span><span class='line'>  public String login(Model model) {          
</span><span class='line'>      StudentLogin studentLogin = new StudentLogin();     
</span><span class='line'>      model.addAttribute("studentLogin", studentLogin);
</span><span class='line'>      return "login";
</span><span class='line'>  }
</span><span class='line'>  
</span><span class='line'>  @RequestMapping(value="/login", method=RequestMethod.POST)
</span><span class='line'>  public String login(@Valid @ModelAttribute("studentLogin") StudentLogin studentLogin, BindingResult result) {
</span><span class='line'>      if (result.hasErrors()) {
</span><span class='line'>          return "login";
</span><span class='line'>      } else {
</span><span class='line'>          boolean found = studentService.findByLogin(studentLogin.getUserName(), studentLogin.getPassword());
</span><span class='line'>          if (found) {                
</span><span class='line'>              return "success";
</span><span class='line'>          } else {                
</span><span class='line'>              return "failure";
</span><span class='line'>          }
</span><span class='line'>      }
</span><span class='line'>      
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>13. Create messages.properties file</h2>

<p>As seen above, the @Valid annotation is used to validate the input parameters of the form reaching the method and the result of the validation is stored in BindingResult object. In order to validate specific fields, (refer the classes created for the Model tier - <a href="https://github.com/elizabetht/StudentEnrollmentWithSpring/tree/master/src/main/java/com/github/elizabetht/model">https://github.com/elizabetht/StudentEnrollmentWithSpring/tree/master/src/main/java/com/github/elizabetht/model</a>), use annotations like @NotEmpty, @Size, @Email and @NotNull from the various validations available from the Hibernate Validator.</p>

<p>The Custom messages that should be displayed when any of the above mentioned validators fail is specified in the messages.properties file. Create a file named messages.properties under src/main/resources folder and include the following</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>NotEmpty=Field cannot be blank
</span><span class='line'>NotNull=Field cannot be blank
</span><span class='line'>
</span><span class='line'>Email=Email Address not valid/well-formed
</span><span class='line'>Past=Date of Birth must be in the past 
</span><span class='line'>
</span><span class='line'>Size={0} must be between {2} and {1} characters long
</span><span class='line'>typeMismatch=Invalid format</span></code></pre></td></tr></table></div></figure>


<h2>14. Create the DB Schema in a MYSQL DB</h2>

<p>Connect to the MySQL DB which is to be used for this application and create a new DB Schema named studentEnrollment using the MySQL Workbench.
This is necessary as the DB Schema name of studentEnrollment is specified in the dataSource bean in jpaContext.xml</p>

<p>Once the studentEnrollment DB Schema is created, create a table named student inside the DB Schema using the CREATE TABLE statement as follows:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>CREATE TABLE `student` (
</span><span class='line'>  `id` bigint(20) NOT NULL AUTO_INCREMENT,
</span><span class='line'>  `dateOfBirth` datetime NOT NULL,
</span><span class='line'>  `emailAddress` varchar(255) NOT NULL,
</span><span class='line'>  `firstName` varchar(255) NOT NULL,
</span><span class='line'>  `lastName` varchar(255) NOT NULL,
</span><span class='line'>  `password` varchar(8) NOT NULL,
</span><span class='line'>  `userName` varchar(20) NOT NULL,
</span><span class='line'>  PRIMARY KEY (`id`)
</span><span class='line'>) ENGINE=InnoDB AUTO_INCREMENT=43 DEFAULT CHARSET=latin1;</span></code></pre></td></tr></table></div></figure>


<h2>15. Deploying the Application on Tomcat Server</h2>

<p>Once the above steps are complete and the project is successfully built, the Java web application is ready to deployed on the Tomcat Server 7.</p>

<p>The Java web application can be deployed locally by right clicking on the project and choosing the &ldquo;Run As->Run on Server&rdquo; option.</p>

<p>The same can be deployed remotely on any native server that supports Tomcat by copying the WAR file (Right click on the project and choose Export as WAR File option) to /var/lib/tomcat7 folder (or appropriate tomcat directory) and restarting the tomcat server.</p>

<h2>16. Clone or Download code</h2>

<p>If using git, clone a copy of this project here: <a href="https://github.com/elizabetht/StudentEnrollmentWithSpring.git">https://github.com/elizabetht/StudentEnrollmentWithSpring.git</a></p>

<p>In case of not using git, download the project as ZIP or tar.gz file here: <a href="https://github.com/elizabetht/StudentEnrollmentWithSpring/releases/tag/1.6">https://github.com/elizabetht/StudentEnrollmentWithSpring/releases/tag/1.6</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Building Java Web Application Using MyBatis With Spring]]></title>
    <link href="http://blog.meygam.com//blog/2013/11/21/student-enrollment-using-mybatis-with-spring/"/>
    <updated>2013-11-21T09:41:09-06:00</updated>
    <id>http://blog.meygam.com//blog/2013/11/21/student-enrollment-using-mybatis-with-spring</id>
    <content type="html"><![CDATA[<p>This post will show how to create a Student Enrollment Application using MYSQL DB with MyBatis framework in a Spring environment. This is a simple application that aims to collect the input details from the user during signup, save the details in the MYSQL DB and authenticate the same during login.</p>

<!-- more -->


<h2>1. Create Java Web Application Project using Maven Template</h2>

<p>To begin with, in the IDE, create a Java Maven project with the template of maven-archetype-webapp (Filter the catalog based on the string &ldquo;webapp&rdquo;) by providing appropriate values for GroupId and Artifact Id for the project. The sample web application directory structure is shown below with a standard deployment descriptor web.xml and Maven pom.xml</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/mybatislayout.png" title="MyBatis Project Layout" alt="MyBatis Maven Project Layout" /></p>

<h2>2. Update pom.xml</h2>

<p>To make the above Maven Java Web Application project support the MyBatis framework, add the following dependencies to the existing pom.xml</p>

<ul>
<li>mybatis (for MyBatis support)</li>
<li>mybatis-spring (for MyBatis-Spring integration support)</li>
<li>jstl, spring-webmvc, servlet-api and spring-context-support (for Spring support)</li>
<li>spring-test (may be optional, needed if Spring-test support is needed)</li>
<li>mysql-connector-java (for MYSQL support)</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;3.1.1&lt;/version&gt;
</span><span class='line'>    &lt;/dependency&gt;
</span><span class='line'>    &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;1.1.1&lt;/version&gt;
</span><span class='line'>    &lt;/dependency&gt;
</span><span class='line'>    &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;spring-context-support&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;3.1.1.RELEASE&lt;/version&gt;
</span><span class='line'>    &lt;/dependency&gt;
</span><span class='line'>    &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;spring-test&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;3.1.1.RELEASE&lt;/version&gt;
</span><span class='line'>      &lt;scope&gt;test&lt;/scope&gt;
</span><span class='line'>    &lt;/dependency&gt;
</span><span class='line'>    &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;mysql&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;5.1.21&lt;/version&gt;
</span><span class='line'>    &lt;/dependency&gt;
</span><span class='line'>    &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;jstl&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;1.2&lt;/version&gt;
</span><span class='line'>    &lt;/dependency&gt;
</span><span class='line'>    &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;org.springframework&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;3.2.4.RELEASE&lt;/version&gt;
</span><span class='line'>    &lt;/dependency&gt;
</span><span class='line'>    &lt;dependency&gt;
</span><span class='line'>      &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;2.5&lt;/version&gt;
</span><span class='line'>    &lt;/dependency&gt;</span></code></pre></td></tr></table></div></figure>


<h2>3. Modify web.xml</h2>

<p>Modify the contents of the web.xml to include the following:</p>

<ul>
<li>A servlet and specify the location of the configuration file for the same. In this sample, a configuration file named springConfig.xml is created under WEB-INF/config folder in the project layout.</li>
<li>A servlet-mapping to map the servlet created in the above step that should be invoked when the client specifies the url matching the url pattern.</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
</span><span class='line'>&lt;web-app version="2.5"
</span><span class='line'>xmlns="http://java.sun.com/xml/ns/javaee"
</span><span class='line'>xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
</span><span class='line'>xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"&gt;
</span><span class='line'>
</span><span class='line'>&lt;servlet&gt;
</span><span class='line'>  &lt;servlet-name&gt;myBatisServlet&lt;/servlet-name&gt;
</span><span class='line'>  &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;
</span><span class='line'>  &lt;init-param&gt;
</span><span class='line'>      &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
</span><span class='line'>      &lt;param-value&gt;/WEB-INF/config/springConfig.xml&lt;/param-value&gt;
</span><span class='line'>  &lt;/init-param&gt;
</span><span class='line'>&lt;/servlet&gt;
</span><span class='line'>
</span><span class='line'>&lt;servlet-mapping&gt;
</span><span class='line'>  &lt;servlet-name&gt;myBatisServlet&lt;/servlet-name&gt;
</span><span class='line'>  &lt;url-pattern&gt;*.html&lt;/url-pattern&gt;
</span><span class='line'>&lt;/servlet-mapping&gt;
</span><span class='line'>
</span><span class='line'>  &lt;display-name&gt;Archetype Created Web Application&lt;/display-name&gt;
</span><span class='line'>&lt;/web-app&gt;</span></code></pre></td></tr></table></div></figure>


<h2>4. Create the Spring Configuration File</h2>

<p>Create a Spring Bean Configuration file under the folder WEB-INF/config. If STS(Spring Tool Suite) is the IDE, go ahead and enable the context, mvc and tx namespaces. The springConfig.xml will be as shown below</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
</span><span class='line'>&lt;beans xmlns="http://www.springframework.org/schema/beans"
</span><span class='line'>  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
</span><span class='line'>  xmlns:context="http://www.springframework.org/schema/context"
</span><span class='line'>  xmlns:mvc="http://www.springframework.org/schema/mvc"
</span><span class='line'>  xmlns:tx="http://www.springframework.org/schema/tx"
</span><span class='line'>  xsi:schemaLocation="http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.2.xsd
</span><span class='line'>      http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
</span><span class='line'>      http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.1.xsd
</span><span class='line'>      http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd"&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;/beans&gt;</span></code></pre></td></tr></table></div></figure>


<p>After enabling the required namespaces, include the following (in between the &lt;beans&gt; and &lt;/beans&gt; tags) to indicate that the application is annotation driven and base package for the context component scan.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;mvc:annotation-driven /&gt;
</span><span class='line'>
</span><span class='line'>&lt;context:component-scan base-package="com.github.elizabetht" /&gt;</span></code></pre></td></tr></table></div></figure>


<p>Include the bean InternalResourceViewResolver of Spring to locate the jsp files</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;bean class="org.springframework.web.servlet.view.InternalResourceViewResolver"&gt;
</span><span class='line'>  &lt;property name="prefix" value="/WEB-INF/jsp/" /&gt;
</span><span class='line'>  &lt;property name="suffix" value=".jsp" /&gt;
</span><span class='line'>&lt;/bean&gt;</span></code></pre></td></tr></table></div></figure>


<p>Include the bean for data source, where the properties of the MYSQL DB like url, username and password can be specified. Replace &lt;include connection url&gt; with the actual connection url for connecting to the MYSQL DB. Likewise, replace &lt;include username&gt; and &lt;include password&gt; with the actual username and password values.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource"&gt;
</span><span class='line'>  &lt;property name="driverClassName" value="com.mysql.jdbc.Driver" /&gt;
</span><span class='line'>  &lt;property name="url" value="jdbc:mysql//&lt;include connection url&gt;:3306/studentEnrollment?autoReconnect=true&amp;createDatabaseIfNotExist=true&amp;" /&gt;
</span><span class='line'>  &lt;property name="username" value="&lt;include username&gt;" /&gt;
</span><span class='line'>  &lt;property name="password" value="&lt;include password&gt;" /&gt;
</span><span class='line'>&lt;/bean&gt;</span></code></pre></td></tr></table></div></figure>


<p>Include the bean for transaction manager for scoping/controlling the transactions, that takes the data source defined above as reference (dependent)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;tx:annotation-driven transaction-manager="transactionManager" /&gt;
</span><span class='line'>&lt;bean id="transactionManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager"&gt;
</span><span class='line'>  &lt;property name="dataSource" ref="dataSource" /&gt;
</span><span class='line'>&lt;/bean&gt;</span></code></pre></td></tr></table></div></figure>


<p>Coming to the MyBatis specific configurations, include the bean for sqlSessionFactory which is the central configuration in a MyBatis application. This bean takes in three properties
- dataSource (already configured above)&nbsp;
- typeAliasesPackage (location where the model classes of this application resides)&nbsp;
- mapperLocations (location where the mapper xml files for the model resides - this is not needed here as annotation based configurations are used instead)&nbsp;</p>

<p>More details of this can be read at <a href="http://mybatis.github.io/mybatis-3/">http://mybatis.github.io/mybatis-3/</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;bean id="sqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean"&gt;
</span><span class='line'>  &lt;property name="dataSource" ref="dataSource" /&gt;
</span><span class='line'>  &lt;property name="typeAliasesPackage" value="com.github.elizabetht.model"/&gt;
</span><span class='line'>  &lt;property name="mapperLocations" value="classpath*:com/github/elizabetht/mappers/*.xml" /&gt;
</span><span class='line'>&lt;/bean&gt;</span></code></pre></td></tr></table></div></figure>


<p>Include the bean for sqlSession</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;bean id="sqlSession" class="org.mybatis.spring.SqlSessionTemplate"&gt;
</span><span class='line'>  &lt;constructor-arg index="0" ref="sqlSessionFactory" /&gt;
</span><span class='line'>&lt;/bean&gt;</span></code></pre></td></tr></table></div></figure>


<p>Next and finally, include the bean for MapperScannerConfigurer</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;bean class="org.mybatis.spring.mapper.MapperScannerConfigurer"&gt;
</span><span class='line'>  &lt;property name="basePackage" value="com.github.elizabetht.mappers" /&gt;
</span><span class='line'>&lt;/bean&gt;</span></code></pre></td></tr></table></div></figure>


<h2>5. Create JSP Files for Student Signup/Login</h2>

<p>Create a folder named &ldquo;jsp&rdquo; under WEB-INF (This is where the jsp files will be created as indicated in the springConfig.xml for the InternalResourceViewResolver bean).</p>

<p>Create a file signup.jsp to include a form to get the input details like UserName, Password, FirstName, LastName, DateOfBirth and EmailAddress of the student. A snapshot of the signup page is as follows:</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/signup.png" title="MyBatis Signup Layout" alt="MyBatis Signup Layout" /></p>

<p>Next, create a file login.jsp to include a form with UserName and Password. A snapshot of the login page is as follows:</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/login.png" title="MyBatis Login Layout" alt="MyBatis Login Layout" /></p>

<p>Also create success.jsp to indicate the login success and failure.jsp to indicate login failure (These are just pages used to display the contents - no processing logic involved).</p>

<p>This application uses twitter bootstrap <a href="http://getbootstrap.com/">http://getbootstrap.com/</a> and <a href="http://bootswatch.com/united/">http://bootswatch.com/united/</a> as style sheets. It also uses a datepicker stylesheet as well to pop up a calendar for the DateOfBirth field in the Student Signup page (<a href="http://www.eyecon.ro/bootstrap-datepicker/">http://www.eyecon.ro/bootstrap-datepicker/</a>).</p>

<p>A reference link to the files under webapp folder of this application can be found at <a href="https://github.com/elizabetht/StudentEnrollmentWithMyBatis/tree/master/src/main/webapp">https://github.com/elizabetht/StudentEnrollmentWithMyBatis/tree/master/src/main/webapp</a></p>

<h2>6. Create packages for Controller, Model, Service and Mappers</h2>

<p>Create packages each for the Spring Controller, Model and Service classes under the src/main/java folder. Also create a package for the MyBatis Mapper class under the same src/main/java folder.</p>

<p>A sample snapshot of the project after the package creation is as shown below:</p>

<p><img src="http://blog.meygam.com//assets/images/elizabetht/mybatis-package.png" title="MyBatis Package Layout" alt="MyBatis Package Layout" /></p>

<h2>7. Create classes for Model Tier</h2>

<p>Create a POJO class named Student.java inside the package com.github.elizabetht.model to include the details of the Student model entity during signup. Create another POJO class named StudentLogin.java inside the same package com.github.elizabetht.model to include the Student Login details.</p>

<p>A reference link to the files for the Model classes can be found at <a href="https://github.com/elizabetht/StudentEnrollmentWithMyBatis/tree/master/src/main/java/com/github/elizabetht/model">https://github.com/elizabetht/StudentEnrollmentWithMyBatis/tree/master/src/main/java/com/github/elizabetht/model</a></p>

<h2>8. Create classes for MyBatis Mapper</h2>

<p>A Mapper in MyBatis framework is similar to the Repository tier in a Spring environment. Crude SQL queries takes its place here.
Create an interface class named StudentMapper.java inside the package com.github.elizabetht.mapper to support the database operations.</p>

<p>There are two interface methods needed for the application&rsquo;s purpose.</p>

<ul>
<li>To Insert the Student Signup details into the Database</li>
<li>To Verify the Student Login details from the Database</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public interface StudentMapper {
</span><span class='line'>  @Insert("INSERT INTO student(userName, password, firstName,"
</span><span class='line'>          + "lastName, dateOfBirth, emailAddress) VALUES"
</span><span class='line'>          + "(#{userName},#{password}, #{firstName}, #{lastName},"
</span><span class='line'>          + "#{dateOfBirth}, #{emailAddress})")
</span><span class='line'>  @Options(useGeneratedKeys=true, keyProperty="id", flushCache=true, keyColumn="id")
</span><span class='line'>  public void insertStudent(Student student);
</span><span class='line'>      
</span><span class='line'>  @Select("SELECT USERNAME as userName, PASSWORD as password, "
</span><span class='line'>          + "FIRSTNAME as firstName, LASTNAME as lastName, "
</span><span class='line'>          + "DATEOFBIRTH as dateOfBirth, EMAILADDRESS as emailAddress "
</span><span class='line'>          + "FROM student WHERE userName = #{userName}")
</span><span class='line'>  public Student getStudentByUserName(String userName);
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>9. Create classes for Service Tier</h2>

<p>Create an interface class named StudentService.java inside the package com.github.elizabetht.service to support the service tier operations.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public interface StudentService {
</span><span class='line'>  void insertStudent(Student student);
</span><span class='line'>  boolean getStudentByLogin(String userName, String password);
</span><span class='line'>  boolean getStudentByUserName(String userName);
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Create a service tier implementation class (a POJO indeed) named StudentServiceImpl.java inside the package com.github.elizabetht.service. This is where the application logic goes - either to save the student details into the database or to verify the student (already saved) details from the database.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>@Service("studentService")
</span><span class='line'>public class StudentServiceImpl implements StudentService {
</span><span class='line'>
</span><span class='line'>  @Autowired
</span><span class='line'>  private StudentMapper studentMapper;
</span><span class='line'>  
</span><span class='line'>  @Transactional
</span><span class='line'>  public void insertStudent(Student student) {        
</span><span class='line'>      studentMapper.insertStudent(student);
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public boolean getStudentByLogin(String userName, String password) {        
</span><span class='line'>      Student student = studentMapper.getStudentByUserName(userName);
</span><span class='line'>      
</span><span class='line'>      if(student != null && student.getPassword().equals(password)) {
</span><span class='line'>          return true;
</span><span class='line'>      }
</span><span class='line'>      
</span><span class='line'>      return false;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  public boolean getStudentByUserName(String userName) {
</span><span class='line'>      Student student = studentMapper.getStudentByUserName(userName);
</span><span class='line'>      
</span><span class='line'>      if(student != null) {
</span><span class='line'>          return true;
</span><span class='line'>      }
</span><span class='line'>      
</span><span class='line'>      return false;
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>




<blockquote><p>When using MyBatis with Spring, a mapper can be directly injected into the service tier. This is probably the strongest point of the Spring integration of MyBatis. This is the only tool that I am aware that lets to build the application with no imports to it.</p><footer><strong>@EduardoMacarron</strong> <cite><a href='https://twitter.com/EduardoMacarron'>twitter.com/EduardoMacarron/&hellip;</a></cite></footer></blockquote>


<h2>10. Create class for Controller Tier</h2>

<p>Create a Controller tier POJO class named StudentController.java inside the package com.github.elizabetht.controller. This is where the routing logic of the application goes - whether a signup or login action is called.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>@Controller
</span><span class='line'>@SessionAttributes("student")
</span><span class='line'>public class StudentController {
</span><span class='line'>  
</span><span class='line'>  @Autowired
</span><span class='line'>  private StudentService studentService;
</span><span class='line'>  
</span><span class='line'>  @RequestMapping(value="/signup", method=RequestMethod.GET)
</span><span class='line'>  public String signup(Model model) {
</span><span class='line'>      Student student = new Student();
</span><span class='line'>      model.addAttribute("student", student);
</span><span class='line'>      return "signup";
</span><span class='line'>  }
</span><span class='line'>  
</span><span class='line'>  @RequestMapping(value="/signup", method=RequestMethod.POST)
</span><span class='line'>  public String signup(@ModelAttribute("student") Student student, Model model) {
</span><span class='line'>      if(studentService.getStudentByUserName(student.getUserName())) {
</span><span class='line'>          model.addAttribute("message", "User Name exists. Try another user name");
</span><span class='line'>          return "signup";
</span><span class='line'>      } else {
</span><span class='line'>          studentService.insertStudent(student);
</span><span class='line'>          model.addAttribute("message", "Saved student details");
</span><span class='line'>          return "redirect:login.html";
</span><span class='line'>      }
</span><span class='line'>  }
</span><span class='line'>  
</span><span class='line'>  @RequestMapping(value="/login", method=RequestMethod.GET)
</span><span class='line'>  public String login(Model model) {
</span><span class='line'>      StudentLogin studentLogin = new StudentLogin();
</span><span class='line'>      model.addAttribute("studentLogin", studentLogin);
</span><span class='line'>      return "login";
</span><span class='line'>  }
</span><span class='line'>  
</span><span class='line'>  @RequestMapping(value="/login", method=RequestMethod.POST)
</span><span class='line'>  public String login(@ModelAttribute("studentLogin") StudentLogin studentLogin) {
</span><span class='line'>      boolean found = studentService.getStudentByLogin(studentLogin.getUserName(), studentLogin.getPassword());
</span><span class='line'>      if (found) {                
</span><span class='line'>          return "success";
</span><span class='line'>      } else {                
</span><span class='line'>          return "failure";
</span><span class='line'>      }
</span><span class='line'>  }
</span><span class='line'>}
</span></code></pre></td></tr></table></div></figure>


<h2>11. Create the DB Schema in a MYSQL DB</h2>

<p>Connect to the MySQL DB which is to be used for this application and create a new DB Schema named studentEnrollment using the MySQL Workbench.
This is necessary as the DB Schema name of studentEnrollment is specified in the dataSource bean in springConfig.xml</p>

<p>Once the studentEnrollment DB Schema is created, create a table named student inside the DB Schema using the CREATE TABLE statement as follows:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>CREATE TABLE `student` (
</span><span class='line'>  `id` bigint(20) NOT NULL AUTO_INCREMENT,
</span><span class='line'>  `dateOfBirth` datetime NOT NULL,
</span><span class='line'>  `emailAddress` varchar(255) NOT NULL,
</span><span class='line'>  `firstName` varchar(255) NOT NULL,
</span><span class='line'>  `lastName` varchar(255) NOT NULL,
</span><span class='line'>  `password` varchar(8) NOT NULL,
</span><span class='line'>  `userName` varchar(20) NOT NULL,
</span><span class='line'>  PRIMARY KEY (`id`)
</span><span class='line'>) ENGINE=InnoDB AUTO_INCREMENT=43 DEFAULT CHARSET=latin1;</span></code></pre></td></tr></table></div></figure>


<h2>12. Deploying the Application on Tomcat Server</h2>

<p>Once the above steps are complete and the project is successfully built, the Java web application is ready to deployed on the Tomcat Server 7.</p>

<p>The Java web application can be deployed locally by right clicking on the project and choosing the &ldquo;Run As->Run on Server&rdquo; option.</p>

<p>The same can be deployed remotely on any native server that supports Tomcat by copying the WAR file (Right click on the project and choose Export as WAR File option) to /var/lib/tomcat7 folder (or appropriate tomcat directory) and restarting the tomcat server.</p>

<h2>13. Clone or Download code</h2>

<p>If using git, clone a copy of this project here: <a href="https://github.com/elizabetht/StudentEnrollmentWithMyBatis.git">https://github.com/elizabetht/StudentEnrollmentWithMyBatis.git</a></p>

<p>In case of not using git, download the project as ZIP or tar.gz file here: <a href="https://github.com/elizabetht/StudentEnrollmentWithMyBatis/releases/tag/1.7">https://github.com/elizabetht/StudentEnrollmentWithMyBatis/releases/tag/1.7</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Spring Cache Abstraction Using Ehcache]]></title>
    <link href="http://blog.meygam.com//blog/2013/09/10/spring-cache-abstraction-using-ehcache/"/>
    <updated>2013-09-10T00:00:00-05:00</updated>
    <id>http://blog.meygam.com//blog/2013/09/10/spring-cache-abstraction-using-ehcache</id>
    <content type="html"><![CDATA[<p>In this article, we will see how to use EhCahce with Spring Cache abstraction. Refer <a href="http://ehcache.org/documentation/recipes/spring-annotations">http://ehcache.org/documentation/recipes/spring-annotations</a> for using EhCache’s own annotations. The advantage of using it with Spring Cache abstraction is that it&rsquo;s easy to change the underlying storage. Say in future if we want to change it to Memcached, then it is just a configuration change and not a code change.</p>

<!-- more -->


<p>Let’s look at the Spring configuration steps and common issues that one encounters while using Spring Cache.</p>

<ul>
<li>Add the Ehcache dependency to the project</li>
</ul>


<div><script src='https://gist.github.com/6613368.js'></script>
<noscript><pre><code>&lt;dependency&gt;
    &lt;groupId&gt;net.sf.ehcache&lt;/groupId&gt;
    &lt;artifactId&gt;ehcache-core&lt;/artifactId&gt;
    &lt;version&gt;2.3.1&lt;/version&gt;
&lt;/dependency&gt;</code></pre></noscript></div>


<p>Note: Without adding the dependency you might see the error</p>

<pre><code>org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping#0': Invocation of init method failed; nested exception is java.lang.NoClassDefFoundError: Lnet/sf/ehcache/CacheManager;
</code></pre>

<ul>
<li>Include the cache namespace and schema location in the Spring Configuration file.</li>
</ul>


<div><script src='https://gist.github.com/6613426.js'></script>
<noscript><pre><code>&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
      xmlns:cache=&quot;http://www.springframework.org/schema/cache&quot;
        xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans   http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/cache http://www.springframework.org/schema/cache/spring-cache.xsd&quot;&gt;
&lt;/beans&gt;</code></pre></noscript></div>


<ul>
<li>Configure the application to use annotation driven</li>
</ul>


<div><script src='https://gist.github.com/6613497.js'></script>
<noscript><pre><code>&lt;cache:annotation-driven cache-manager=&quot;cacheManager&quot;/&gt;</code></pre></noscript></div>


<ul>
<li>Define the cacheManager bean</li>
</ul>


<div><script src='https://gist.github.com/6613514.js'></script>
<noscript><pre><code>&lt;bean id=&quot;cacheManager&quot; class=&quot;org.springframework.cache.ehcache.EhCacheCacheManager&quot;&gt;
  &lt;property name=&quot;cacheManager&quot; ref=&quot;ehcache&quot;/&gt;
&lt;/bean&gt;

&lt;!-- Ehcache library setup --&gt;
&lt;bean id=&quot;ehcache&quot; class=&quot;org.springframework.cache.ehcache.EhCacheManagerFactoryBean&quot;&gt;
  &lt;property name=&quot;configLocation&quot; value=&quot;classpath:ehcache.xml&quot;/&gt;
&lt;/bean&gt;</code></pre></noscript></div>


<ul>
<li>Configure the ehcache.xml
Defined the caches in the ehcache configuration XML. Below is the sample ehcache xml file to define the caches.</li>
</ul>


<div><script src='https://gist.github.com/6613543.js'></script>
<noscript><pre><code>&lt;ehcache  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
      xsi:noNamespaceSchemaLocation=&quot;http://ehcache.org/ehcache.xsd&quot; updateCheck=&quot;false&quot; maxBytesLocalHeap=&quot;1g&quot; 
      maxBytesLocalOffHeap=&quot;4g&quot; maxBytesLocalDisk=&quot;100g&quot; &gt;

        &lt;defaultCache maxElementsInMemory=&quot;5&quot; eternal=&quot;false&quot;
      timeToIdleSeconds=&quot;20&quot; timeToLiveSeconds=&quot;20&quot;
      overflowToDisk=&quot;false&quot; diskPersistent=&quot;false&quot;
      memoryStoreEvictionPolicy=&quot;LRU&quot;/&gt;  
            
        &lt;cache name=&quot;longCache&quot; timeToLiveSeconds=&quot;10000&quot;/&gt;
&lt;/ehcache&gt;</code></pre></noscript></div>


<p>Note: Without defaultCache defined, below error will be thrown</p>

<pre><code>Cannot resolve reference to bean 'cacheManager' while setting bean property 'cacheManager'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'cacheManager' defined in ServletContext resource [/WEB-INF/servlet-config.xml]: Cannot resolve reference to bean 'ehcache' while setting bean property 'cacheManager'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'ehcache' defined in ServletContext resource [/WEB-INF/servlet-config.xml]: Invocation of init method failed; nested exception is net.sf.ehcache.CacheException: Illegal configuration. No default cache is configured.
</code></pre>

<ul>
<li>Add the @Cacheable annotation to the code</li>
</ul>


<div><script src='https://gist.github.com/6613568.js'></script>
<noscript><pre><code>import org.springframework.cache.annotation.Cacheable;
.
.

@Cacheable(&quot;longCache&quot;)
  public List&lt;Product&gt; getAllProducts(final int pageNumber) {
        System.out.println(&quot;Inside DAO so cache did not get used&quot;);
        // TODO Auto-generated method stub
        Query query = getEntityManager().createQuery(&quot;SELECT p FROM Product p&quot;);
        return query.setFirstResult(pageNumber * PAGE_SIZE)
                .setMaxResults(PAGE_SIZE).getResultList();
    }
</code></pre></noscript></div>


<h4>Common issues one might face in using the Spring Cache abstraction</h4>

<ul>
<li>Cache key collision:
The default key generator is a simple one and it is easy to get key collisions using this. Refer the DefaultKeyGenerator.java code to see how it works. Also when you have an array as a parameter, the default key generator produces different key for each execution.</li>
</ul>


<p>It’s better to use your own key generator. Below is the sample one I used</p>

<div><script src='https://gist.github.com/6613617.js'></script>
<noscript><pre><code>import org.apache.commons.lang3.builder.HashCodeBuilder;
import org.springframework.cache.interceptor.KeyGenerator;

public class CacheKeyGenerator implements KeyGenerator {
    @Override
    public Object generate(Object o, Method method, Object... objects) {
        HashCodeBuilder hashCodeBuilder = new HashCodeBuilder();
        hashCodeBuilder.append(method.getName());
        for (Object object : objects) {
            hashCodeBuilder.append(object);
        }
        return hashCodeBuilder.toHashCode();
    }
}</code></pre></noscript></div>


<p>And you can set this as your default key generator in the Spring configuration file like below.</p>

<div><script src='https://gist.github.com/6613634.js'></script>
<noscript><pre><code>&lt;cache:annotation-driven cache-manager=&quot;cacheManager&quot; key-generator=&quot;cacheKeyGenerator&quot;/&gt;

&lt;bean id=&quot;cacheKeyGenerator&quot; class=&quot;com.meygam.cache.CacheKeyGenerator&quot;/&gt;</code></pre></noscript></div>


<ul>
<li>Application context is loaded more than once:</li>
</ul>


<p>Sometimes due to misconfiguration the application context gets loaded twice and due to that you might get the error. Make sure you name the cacheManager in the ehcache.xml and you are not loading the application context twice.</p>

<pre><code>Another unnamed CacheManager already exists in the same VM. 
Please provide unique names for each CacheManager in the config or do one of following:
1. Use one of the CacheManager.create() static factory methods to reuse same CacheManager with same name or create one if necessary
2. Shutdown the earlier cacheManager before creating new one with same name.
The source of the existing CacheManager is: InputStreamConfigurationSource [stream=sun.net.www.protocol.jar.JarURLConnection$JarURLInputStream@47f3ed6]
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Overview of Microstrategy Features]]></title>
    <link href="http://blog.meygam.com//blog/2013/06/20/overview-of-microstrategy-features/"/>
    <updated>2013-06-20T00:00:00-05:00</updated>
    <id>http://blog.meygam.com//blog/2013/06/20/overview-of-microstrategy-features</id>
    <content type="html"><![CDATA[<p>In my previous blog <a href="http://blog.meygam.com//microstrategy-9-installation-on-a-new-windows-2008-server/">Microstrategy 9 Installation on a new Windows 2008 server</a> we looked at installing the MSTR. Here let&rsquo;s look at the features we installed. Below is the list of all the features from MSTR.</p>

<!-- more -->


<p><img src="http://blog.meygam.com//assets/images/2014/Mar/062313_1702_overviewofm1-1.png" alt="" /></p>

<p>The below picture will give us the overview of how all these features are related.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/062313_1702_overviewofm2-1.png" alt="" /></p>

<p>Let&rsquo;s look at each one of them in detail</p>

<h4>Microstrategy Intelligence Server</h4>

<p>Microstrategy Intelligence Server is the architectural foundation for the Microstrategy platform. This communicates to the various data sources, and runs the reports and distributes to MSTR Desktop and Web users. Intelligence server ensures the scalability and fault tolerance required for analysis of terabyte databases and millions of users.</p>

<p>Below are the sub-features installed as part of MSTR Intelligence server. We will cover these features in detail when we explore the Intelligence server in detail.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/062313_1702_overviewofm3-1.png" alt="" /></p>

<h4>Microstrategy Web universal</h4>

<p>MSTR Web enables the users to create and/or run the reports in web.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/062313_1702_overviewofm4-1.png" alt="" /></p>

<p>Below are the sub-features installed as part of MSTR Web Universal.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/062313_1702_overviewofm5-1.png" alt="" /></p>

<h4>Microstrategy Office</h4>

<p>MSTR Office is a plugin for Microsoft Office and lets the user to run reports from Office tools. I could not show the screen shot for this product, I didn&rsquo;t install this feature as I don&rsquo;t have the MS Office in my VM.</p>

<p>Below are the sub-features installed as part of MSTR Office.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/062313_1702_overviewofm6.png" alt="" /></p>

<h4>Microstrategy Mobile</h4>

<p>MSTR Mobile enables the users to view the reports from mobile devices.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/062313_1702_overviewofm7.png" alt="" /></p>

<p>Below are the sub-features installed as part of MSTR Mobile.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/062313_1702_overviewofm8.png" alt="" /></p>

<h4>Microstrategy Desktop Products</h4>

<p>MSTR Desktop allows the user to create and/or run the reports in the Desktop.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/062313_1702_overviewofm9.png" alt="" /></p>

<p>MSTR Architect helps to map the data model to the business model.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/062313_1702_overviewofm10.png" alt="" /></p>

<p>Below are the sub-features installed as part of MSTR Desktop.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/062313_1702_overviewofm11.png" alt="" /></p>

<h4>Microstrategy Object Manager</h4>

<p>MSTR Object Manager is used to migrate MSTR objects from one environment to another.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/062313_1702_overviewofm12.png" alt="" /></p>

<h4>Microstrategy Command Manager</h4>

<p>Command Manager is used to create scripts to automate common administrative tasks.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/062313_1702_overviewofm13.png" alt="" /></p>

<h4>Microstrategy Enterprise Manager</h4>

<p>MSTR Enterprise Manager provides the usage details of the MSTR Intelligence Server. The core of Enterprise Manager is nothing but a MSTR project with set of predefined reports, and the metrics and attributes to create your own reports. You can run reports that help you to:</p>

<ul>
<li>Allocate system resources based on data warehouse usage trends</li>
<li>Research efficient aggregation, partitioning, and indexing strategies</li>
<li>Profile users based on their system resource usage</li>
<li>Determine the optimal time to run scheduled jobs, load data, or perform routine system and database maintenance</li>
<li>Determine the most popular reports so you can schedule and cache them, thus increasing their response time and reducing the load on the system</li>
<li>Identify unused objects from your metadata repository so they can be deleted later</li>
<li>Identify peak usage times and patterns and, if necessary, change your Intelligence Server configuration to respond appropriately</li>
<li>Determine whether you need to add more threads to the database connection threads if queue times are long</li>
<li>Find which tables are the most used, and create indexes to improve performance</li>
</ul>


<h4>Microstrategy Integrity Manager</h4>

<p>MSTR Integrity Manager is used to automate the report testing.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/062313_1702_overviewofm14.jpg" alt="" /></p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/mstr_integrity_manager.png" alt="" /></p>

<h4>Microstrategy System Manager</h4>

<p>Microstrategy System Manager helps to automate the configuration of MSTR products in larger environments.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/062313_1702_overviewofm15.png" alt="" /></p>

<h4>Microstrategy SDK</h4>

<p>MSTR SDK enables the developers to extend and integrate MSTR platform through a set of APIs that exposes all platform functionality. It helps to embed intelligence in any custom application.</p>

<h4>Microstrategy Narrowcast Sever</h4>

<p>MSTR Narrowcast server delivers the report in mail/phone based on the schedules.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/062313_1702_overviewofm16.png" alt="" /></p>

<p>Below are the sub-features installed as part of MSTR Narrowcast Server.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/062313_1702_overviewofm17.png" alt="" /></p>

<h4>Other Components</h4>

<p>This installs the drivers to access Cubes from Analysis Servers and Sequelink ODBC Socket server to talk to multiple data sources.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/062313_1702_overviewofm18-1.png" alt="" /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Microstrategy 9 Installation on a New Windows 2008 Server]]></title>
    <link href="http://blog.meygam.com//blog/2013/06/16/microstrategy-9-installation-on-a-new-windows-2008-server/"/>
    <updated>2013-06-16T00:00:00-05:00</updated>
    <id>http://blog.meygam.com//blog/2013/06/16/microstrategy-9-installation-on-a-new-windows-2008-server</id>
    <content type="html"><![CDATA[<p>Since my customer has decided to go with the Microstrategy(MSTR) as analytics and reporting tool, I got curious about this tool and wanted to know more on its capabilities. I got an opportunity to go for a free training from MSTR, and I got the evaluation CD &amp; a nice notebook J. I thought I will install it and explore it for 30 days… Lets see how far I go!</p>

<!-- more -->


<p>The installation of actual MSTR seems to be simple, but setting up the windows server for the installtion took more time. It would have been simpler if MSTR gave the VM with MSTR services installed in it. Anyways lets assume we have the Windows Server 2008 ready and let see how to install the MSTR. The prerequites are mentioned in the MSTR website <a href="http://www.microstrategy.com/evaluation-edition">http://www.microstrategy.com/evaluation-edition</a></p>

<h3>System Requirements</h3>

<ul>
<li>x86 or x64 compatible CPU</li>
<li>4 GB RAM</li>
<li>Minimum storage space required: Three times the amount of RAM available to Intelligence Server. For example, an Intelligence Server that is provided 4 GB of RAM requires 12 GB of hard drive space.</li>
<li>Windows 2003 Standard Edition SP2 (on x86 or x64) ,Windows 2003 Enterprise Edition SP2 (on x86 or x64) ,Windows 2003 Standard Edition R2 SP2 (on x86 or x64) ,Windows 2003 Enterprise Edition R2 SP2 (on x86 or x64) ,Windows Vista Business Edition SP2 (on x86 or x64), Windows Vista Enterprise Edition SP2 (on x86 or x64) ,Windows 7 Professional Edition SP1(on x86 or x64), Windows 7 Enterprise Edition SP1 (on x86 or x64) ,Windows 8 all editions (on x86 or x64) ,Windows 2008 Standard Edition SP2 on x64 ,Windows 2008 Enterprise Edition SP2 on x64 ,Windows 2008 Standard Edition R2 SP1 on x64 ,Windows 2008 Enterprise Edition R2 SP1 on x64 ,Windows Server 2012 Standard (on x64)</li>
<li>Microsoft Internet Information Services (IIS) * version 6.x, 7.0.x, 7.5.x, or 8.x.</li>
<li>Microsoft .NET Framework 4.0 or 4.5. This must be installed prior to installing MicroStrategy.</li>
<li>Microsoft Internet Explorer version 7.x, 8.x, 9.x, or 10.x.</li>
<li>Adobe® Reader® version 9.x, 10.x or 11.x.</li>
<li>Adobe® Flash® Player version 10.1.x, 10.3.x, or 11.x.</li>
<li>16-bit color display or higher</li>
<li>Windows fonts display set to small fonts (96 dpi)</li>
</ul>


<p>Insert the DVD and double click on the DVD, it will open the below window, click on &ldquo;Begin Microstrategy Platform Installation&rdquo;.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/061713_0449_microstrate1.png" alt="" /></p>

<p>Select the language and click &ldquo;Ok&rdquo;</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/061713_0449_microstrate2.png" alt="" /></p>

<p>Click &ldquo;Next&rdquo;</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/061713_0449_microstrate3.png" alt="" /></p>

<p>Accept the license agreements and click &ldquo;Next&rdquo;</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/061713_0449_microstrate4.png" alt="" /></p>

<p>The license kay can be obtained form <a href="http://www.microstrategy.com/LicenseKey.">http://www.microstrategy.com/LicenseKey.</a> Promo code is required to get the license key. I got one with the evaluation DVD pack. License ley will be sent to your registered email address. Yes, you will have to register to get the license key.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/061713_0449_microstrate5.png" alt="" /></p>

<p>Change the installation folders if needed. I prefer it to have the default installation path.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/061713_0449_microstrate6.png" alt="" /></p>

<p>Select the features you want to install. Since I am evaluating I installed all the features except the &ldquo;Microstrategy office&rdquo; as it required MS Office to be installed in the server, and I don&rsquo;t have one on my server.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/061713_0449_microstrate7.png" alt="" /></p>

<p>After this I got an error saying &ldquo;Adobe Acrobat Reader 7 or greater&rdquo; is needed. I downloaded and installed the acrobat reader. Then I got the below errors</p>

<pre><code>MicroStrategy Common Files requirements:MISSING: Microsoft .Net Framework v4.0
MicroStrategy Desktop Products requirements:MISSING: Microsoft .Net Framework v4.0
MicroStrategy Object Manager requirements:
OK
MicroStrategy Command Manager requirements:
OK
MicroStrategy Enterprise Manager requirements:
OK
MicroStrategy Intelligence Server requirements:
OK
MicroStrategy Web Universal requirements:
MISSING: Microsoft Internet Information Server Version 5.0 or greater.
MISSING: Microsoft .Net Framework v4.0
MicroStrategy Web Services requirements:
MISSING: Microsoft Internet Information Server Version 5.0 or greater.
MISSING: Microsoft .Net Framework v4.0
MicroStrategy Mobile Server (ASP .NET) requirements:
MISSING: Microsoft Internet Information Server Version 5.0 or greater.
MISSING: Microsoft .Net Framework v4.0
MicroStrategy SDK requirements:
OK
MicroStrategy Integrity Manager requirements:
OK
MicroStrategy Office requirements:
MISSING: Microsoft .Net Framework v4.0
MISSING: Microsoft Office XP or higher.
MISSING: Windows Installer 4.5 or higher.
(Windows Installer 4.5 redistributables can be found in
..\Utilities\3rdParty\WindowsInstaller45 folder
on the MicroStrategy product installation media.)
SequeLink ODBC Socket Server requirements:
OK
MicroStrategy Narrowcast Administrator requirements:
OK
MicroStrategy Delivery Engine requirements:
OK
MicroStrategy Subscription Portal requirements:
MISSING: Microsoft Internet Information Server Version 5.0 or greater.
MicroStrategy Tutorial - Reporting requirements:
OK
MicroStrategy Analytics Modules requirements:
OK
MicroStrategy MDX Cube Provider requirements:
MISSING: Microsoft Internet Information Server Version 5.0 or greater.
MISSING: Microsoft .Net Framework v4.0
</code></pre>

<p>I got below message after installing Microsoft .Net 4.0 and IIS.</p>

<pre><code>MicroStrategy Mobile Server (ASP .NET) requirements:
MISSING Web Server feature: Security\Windows Authentication
MISSING Web Server feature: Application Development\ASP
</code></pre>

<p>I had to enable the ASP &amp; Windows Authentication services for the IIS as shown below.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/061713_0449_microstrate8.png" alt="" /></p>

<p>Since it&rsquo;s the new server, I didn&rsquo;t get a chance to enable the ASP and ASP.Net extensions in the IIS. Good that MSTR installation recognizes that and showed me the below pop up.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/061713_0449_microstrate9.png" alt="" /></p>

<p>Leave the default and click &ldquo;Next&rdquo;</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/061713_0449_microstrate10.png" alt="" /></p>

<p> This is to just an information that you will get the activation key in the mail.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/061713_0449_microstrate11.png" alt="" /></p>

<p>Enter the instance name, location, use and click &ldquo;Next&rdquo;</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/061713_0449_microstrate12.png" alt="" /></p>

<p>Enter your information and click &ldquo;Next&rdquo;.. In case if you select &ldquo;I am not an employee…&rdquo; option then it will prompt you an one more window where it will ask you to entert one of the Employee&rsquo;s information associated with this project.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/061713_0449_microstrate13.png" alt="" /></p>

<p>The installation will start now. It took me hours to finish the installation as my VM&rsquo;s processor and memory are under the required specifications.  Select to get the activation code in email. You need to activate the software within 7 days from the installation.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/061713_0449_microstrate14.png" alt="" /></p>

<p>The installed components and it details are listed once the installation is complete.</p>

<pre><code>Component Install:
- MicroStrategy Desktop Analyst
- MicroStrategy Desktop Designer
- MicroStrategy Architect
- MicroStrategy Server Administrator
- MicroStrategy Object Manager
- MicroStrategy Command Manager
- MicroStrategy Enterprise Manager
- MicroStrategy System Manager
- MicroStrategy Intelligence Server
- MicroStrategy Report Services
- MicroStrategy OLAP Services
- MicroStrategy Distribution Services
- MicroStrategy Transaction Services
- MicroStrategy Web Universal - MicroStrategy Web Server (ASP .NET)
- MicroStrategy Web Universal - MicroStrategy Web Server (JSP)
- MicroStrategy Web Universal Analyst
- MicroStrategy Web Universal Professional
- MicroStrategy Web Universal Reporter
- MicroStrategy Mobile - BlackBerry® Device Client Application
- MicroStrategy Mobile - MicroStrategy Mobile Server (ASP .NET)
- MicroStrategy Mobile - MicroStrategy Mobile Server (JSP)
- MicroStrategy Portlets
- MicroStrategy GIS Connectors
- MicroStrategy SDK
- MicroStrategy Integrity Manager
- MicroStrategy Tutorial - Reporting
- MicroStrategy Analytics Modules
- MicroStrategy Narrowcast Administrator
- MicroStrategy Delivery Engine
- MicroStrategy Subscription Portal
- MicroStrategy Tutorial - Delivery
- SequeLink ODBC Socket Server
- MicroStrategy MDX Cube Provider
Target Directories:
- MicroStrategy Desktop Products: C:\Program Files\MicroStrategy\Desktop
- MicroStrategy Object Manager: C:\Program Files\MicroStrategy\Object Manager
- MicroStrategy Command Manager: C:\Program Files\MicroStrategy\Command Manager
- MicroStrategy Enterprise Manager: C:\Program Files\MicroStrategy\Enterprise Manager
- MicroStrategy System Manager: C:\Program Files\MicroStrategy\System Manager
- MicroStrategy Intelligence Server: C:\Program Files\MicroStrategy\Intelligence Server
- MicroStrategy Web Universal - MicroStrategy Web Server (ASP .NET): C:\Program Files\MicroStrategy\Web ASPx
- MicroStrategy Web Universal - MicroStrategy Web Server (JSP): C:\Program Files\MicroStrategy\Web JSP
- MicroStrategy Mobile - BlackBerry® Device Client Application: C:\Program Files\MicroStrategy\Mobile Clients
- MicroStrategy Mobile Server - MicroStrategy Mobile Server (ASP .NET): C:\Program Files\MicroStrategy\Mobile Server ASPx
- MicroStrategy Mobile Server - MicroStrategy Mobile Server (JSP): C:\Program Files\MicroStrategy\Mobile Server JSP
- MicroStrategy SDK: C:\Program Files\MicroStrategy\SDK
- MicroStrategy Portlets: C:\Program Files\MicroStrategy\Portlets
- MicroStrategy GIS Connectors: C:\Program Files\MicroStrategy\GISConnectors
- MicroStrategy Integrity Manager: C:\Program Files\MicroStrategy\Integrity Manager
- MicroStrategy Tutorial - Reporting: C:\Program Files\MicroStrategy\Tutorial Reporting
- MicroStrategy Analytics Modules: C:\Program Files\MicroStrategy\Analytics Modules
- MicroStrategy Narrowcast Administrator: C:\Program Files\MicroStrategy\Narrowcast Server\Delivery Engine
- MicroStrategy Tutorial - Delivery: C:\Program Files\MicroStrategy\Narrowcast Server\Tutorial
- MicroStrategy Subscription Portal: C:\Program Files\MicroStrategy\Narrowcast Server\Subscription Portal
- MicroStrategy Health Center: C:\Program Files\Common Files\MicroStrategy\HealthCenter
- MicroStrategy MDX Cube Provider: C:\Program Files\MicroStrategy\MDX Cube Provider
- MicroStrategy Common Files: C:\Program Files\Common Files\MicroStrategy
Program Folder: MicroStrategy
Log file:
C:\Program Files\Common Files\MicroStrategy\install.log
MicroStrategy Web Server (ASP .NET) Virtual Directory: MicroStrategy
MicroStrategy Mobile Server (ASP .NET) Virtual Directory: MicroStrategyMobile
MicroStrategy Subscription Portal Virtual Directory: NarrowcastServer
MicroStrategy MDX Cube Provider Virtual Directory: MicroStrategyMDX
License Details:
Contract ID: 76053
License Key Group: 1
License Key Issue Date: 7/18/2012
GA installation
MicroStrategy Intelligence Server Module
Evaluation Version
Evaluation period: 1
Evaluation duration: 30 day(s)
License based on Named Users
Maximum number of Named Users allowed: 500
MicroStrategy Intelligence Server Universal Option
License based on Named Users
Maximum number of Named Users allowed: 500
MicroStrategy Narrowcast Server Option
License based on Named Users
Maximum number of Named Users allowed: 500
MicroStrategy Report Services Option
License based on Named Users
Maximum number of Named Users allowed: 500
MicroStrategy OLAP Services Option
License based on Named Users
Maximum number of Named Users allowed: 500
MicroStrategy Distribution Services Option
License based on Named Users
Maximum number of Named Users allowed: 500
MicroStrategy Transaction Services Option
License based on Named Users
Maximum number of Named Users allowed: 500
MicroStrategy Intelligence Server Clustering Option
License based on Named Users
Maximum number of Named Users allowed: 500
MicroStrategy Intelligence Server MultiSource Option
License based on Named Users
Maximum number of Named Users allowed: 500
Maximum number of Concurrent Users allowed: 50
MicroStrategy Web Reporter Module
Evaluation Version
Evaluation period: 1
Evaluation duration: 30 day(s)
License based on Named Users
Maximum number of Named Users allowed: 500
MicroStrategy Web Universal Option
License based on Named Users
Maximum number of Named Users allowed: 500
MicroStrategy Web Analyst Option
License based on Named Users
Maximum number of Named Users allowed: 500
MicroStrategy Web Professional Option
License based on Named Users
Maximum number of Named Users allowed: 500
MicroStrategy Desktop Products
Evaluation Version
Evaluation period: 1
Evaluation duration: 30 day(s)
MicroStrategy Desktop Analyst Module
Maximum number of Named Users allowed: 500
MicroStrategy Desktop Designer Option
Maximum number of Named Users allowed: 500
MicroStrategy Architect
Maximum number of Named Users allowed: 500
MicroStrategy Server Administrator
MicroStrategy Command Manager
Evaluation Version
Evaluation period: 1
Evaluation duration: 30 day(s)
License based on Named Users
Maximum number of Named Users allowed: 500
Maximum number of Managed Named Users allowed: 500
MicroStrategy Enterprise Manager
Evaluation Version
Evaluation period: 1
Evaluation duration: 30 day(s)
License based on Named Users
Maximum number of Named Users allowed: 500
Maximum number of Managed Named Users allowed: 500
MicroStrategy Object Manager
Evaluation Version
Evaluation period: 1
Evaluation duration: 30 day(s)
License based on Named Users
Maximum number of Named Users allowed: 500
Maximum number of Managed Named Users allowed: 500
MicroStrategy SDK
Production Version
MicroStrategy Analytics Modules
Evaluation Version
MicroStrategy Integrity Manager
Evaluation Version
Evaluation period: 1
Evaluation duration: 30 day(s)
Maximum number of Named Users allowed: 1
Maximum number of Managed Named Users allowed: 500
MicroStrategy Mobile
Evaluation Version
Evaluation period: 1
Evaluation duration: 30 day(s)
License based on Named Users
Maximum number of Named Users allowed: 500
MicroStrategy System Manager
Evaluation Version
Evaluation period: 1
Evaluation duration: 30 day(s)
License based on Named Users
Maximum number of Named Users allowed: 500
Maximum number of Managed Named Users allowed: 500
</code></pre>

<p>Restart the server to complete the installation</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/061713_0449_microstrate15.png" alt="" /></p>

<p>Activate the server using Start à Microstrategy à License Manager</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/061713_0449_microstrate16.png" alt="" /></p>

<p>Enter the activation key that you got in the mail.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/061713_0449_microstrate17.png" alt="" /></p>

<p>This completes the Microstrategy Server installation.</p>

<p><img src="http://blog.meygam.com//assets/images/2014/Mar/061713_0449_microstrate18.png" alt="" /></p>

<p>The installation should be easy if you have a good server to install it in. I had to struggle to get the VM ready and install MSTR on top of that. That too my VM was about micro in size. Took 3 hours to complete my installation. Better to use a larger VM for quicker installation.</p>
]]></content>
  </entry>
  
</feed>
